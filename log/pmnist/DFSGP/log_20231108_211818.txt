====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=10, gpm_thro=0.93, lr=0.01, lr_factor=2, lr_min=1e-05, lr_patience=6, mixup_alpha=20, mixup_weight=0.01, momentum=0.9, n_epochs=5, n_hidden=100, n_outputs=10, n_tasks=10, pc_valid=0.1, savename='./log/DFSGP/', scale_coff=10, seed=1)
====================================================================================================
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  0 (pmnist-0)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.188, acc= 94.5% | time=100334.4ms |
 Valid: loss=0.179, acc= 94.9% |
Epoch   2 | Train: loss=0.124, acc= 96.5% | time=98173.9ms |
 Valid: loss=0.127, acc= 96.4% |
Epoch   3 | Train: loss=0.095, acc= 97.5% | time=76049.3ms |
 Valid: loss=0.108, acc= 97.0% |
Epoch   4 | Train: loss=0.073, acc= 98.1% | time=69553.9ms |
 Valid: loss=0.088, acc= 97.4% |
Epoch   5 | Train: loss=0.062, acc= 98.4% | time=68737.8ms |
 Valid: loss=0.083, acc= 97.5% |
----------------------------------------
Test: loss=0.083 , acc= 97.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 62/784
Layer 2 : 61/100
Layer 3 : 52/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  1 (pmnist-1)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.133, acc= 96.3% | time=72762.5ms |
 Valid: loss=0.131, acc= 96.4% |
Epoch   2 | Train: loss=0.096, acc= 97.4% | time=81786.2ms |
 Valid: loss=0.103, acc= 96.9% |
Epoch   3 | Train: loss=0.077, acc= 97.9% | time=82053.0ms |
 Valid: loss=0.091, acc= 97.2% |
Epoch   4 | Train: loss=0.066, acc= 98.2% | time=89830.4ms |
 Valid: loss=0.083, acc= 97.5% |
Epoch   5 | Train: loss=0.056, acc= 98.5% | time=78899.4ms |
 Valid: loss=0.079, acc= 97.5% |
Test: loss=0.079 , acc= 97.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 123/784
Layer 2 : 85/100
Layer 3 : 72/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  2 (pmnist-2)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.147, acc= 96.1% | time=95376.7ms |
 Valid: loss=0.146, acc= 96.2% |
Epoch   2 | Train: loss=0.106, acc= 97.1% | time=108171.4ms |
 Valid: loss=0.113, acc= 97.0% |
Epoch   3 | Train: loss=0.088, acc= 97.7% | time=106252.8ms |
 Valid: loss=0.102, acc= 97.3% |
Epoch   4 | Train: loss=0.073, acc= 98.0% | time=81007.5ms |
 Valid: loss=0.092, acc= 97.6% |
Epoch   5 | Train: loss=0.065, acc= 98.2% | time=81623.3ms |
 Valid: loss=0.086, acc= 97.7% |
Test: loss=0.087 , acc= 97.4%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 179/784
Layer 2 : 94/100
Layer 3 : 81/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.4%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  3 (pmnist-3)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.155, acc= 95.6% | time=73822.7ms |
 Valid: loss=0.154, acc= 95.7% |
Epoch   2 | Train: loss=0.118, acc= 96.8% | time=69165.7ms |
 Valid: loss=0.126, acc= 96.4% |
Epoch   3 | Train: loss=0.097, acc= 97.3% | time=77658.3ms |
 Valid: loss=0.109, acc= 96.9% |
Epoch   4 | Train: loss=0.084, acc= 97.7% | time=78863.8ms |
 Valid: loss=0.099, acc= 97.2% |
Epoch   5 | Train: loss=0.077, acc= 98.0% | time=76336.2ms |
 Valid: loss=0.097, acc= 97.2% |
Test: loss=0.093 , acc= 97.2%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 229/784
Layer 2 : 97/100
Layer 3 : 85/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.4%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.6%  97.2%  97.1%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  4 (pmnist-4)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.167, acc= 95.2% | time=80170.8ms |
 Valid: loss=0.161, acc= 95.4% |
Epoch   2 | Train: loss=0.122, acc= 96.6% | time=98772.1ms |
 Valid: loss=0.125, acc= 96.4% |
Epoch   3 | Train: loss=0.101, acc= 97.2% | time=98052.7ms |
 Valid: loss=0.109, acc= 96.9% |
Epoch   4 | Train: loss=0.087, acc= 97.6% | time=105798.5ms |
 Valid: loss=0.098, acc= 97.3% |
Epoch   5 | Train: loss=0.078, acc= 98.0% | time=76844.9ms |
 Valid: loss=0.093, acc= 97.2% |
Test: loss=0.099 , acc= 96.9%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 275/784
Layer 2 : 98/100
Layer 3 : 88/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.4%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.6%  97.2%  97.1%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  96.9%  96.6%  97.0%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  5 (pmnist-5)
****************************************************************************************************
----------------------------------------
Task ID :5 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.188, acc= 94.7% | time=65584.2ms |
 Valid: loss=0.184, acc= 94.6% |
Epoch   2 | Train: loss=0.136, acc= 96.2% | time=64521.8ms |
 Valid: loss=0.141, acc= 96.1% |
Epoch   3 | Train: loss=0.113, acc= 97.0% | time=61396.4ms |
 Valid: loss=0.122, acc= 96.5% |
Epoch   4 | Train: loss=0.099, acc= 97.4% | time=59224.1ms |
 Valid: loss=0.112, acc= 96.7% |
Epoch   5 | Train: loss=0.089, acc= 97.7% | time=65075.8ms |
 Valid: loss=0.105, acc= 97.1% |
Test: loss=0.110 , acc= 96.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 319/784
Layer 2 : 99/100
Layer 3 : 89/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.4%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.6%  97.2%  97.1%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  96.9%  96.6%  97.0%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0%
 95.8%  96.7%  96.3%  96.7%  96.8%  96.6%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  6 (pmnist-6)
****************************************************************************************************
----------------------------------------
Task ID :6 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.199, acc= 94.2% | time=63784.2ms |
 Valid: loss=0.196, acc= 94.3% |
Epoch   2 | Train: loss=0.147, acc= 95.8% | time=62455.3ms |
 Valid: loss=0.154, acc= 95.4% |
Epoch   3 | Train: loss=0.125, acc= 96.5% | time=60832.3ms |
 Valid: loss=0.137, acc= 96.0% |
Epoch   4 | Train: loss=0.110, acc= 96.9% | time=100706.5ms |
 Valid: loss=0.127, acc= 96.2% |
Epoch   5 | Train: loss=0.100, acc= 97.3% | time=93189.3ms |
 Valid: loss=0.120, acc= 96.4% |
Test: loss=0.118 , acc= 96.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 359/784
Layer 2 : 99/100
Layer 3 : 90/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.4%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.6%  97.2%  97.1%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  96.9%  96.6%  97.0%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0%
 95.8%  96.7%  96.3%  96.7%  96.8%  96.6%   0.0%   0.0%   0.0%   0.0%
 95.5%  96.2%  96.1%  96.5%  96.3%  96.2%  96.6%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  7 (pmnist-7)
****************************************************************************************************
----------------------------------------
Task ID :7 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.220, acc= 93.5% | time=98417.4ms |
 Valid: loss=0.212, acc= 93.8% |
Epoch   2 | Train: loss=0.164, acc= 95.3% | time=83002.7ms |
 Valid: loss=0.165, acc= 95.1% |
Epoch   3 | Train: loss=0.138, acc= 96.0% | time=61578.5ms |
 Valid: loss=0.144, acc= 95.8% |
Epoch   4 | Train: loss=0.123, acc= 96.6% | time=62528.3ms |
 Valid: loss=0.134, acc= 96.0% |
Epoch   5 | Train: loss=0.112, acc= 96.9% | time=58854.4ms |
 Valid: loss=0.127, acc= 96.3% |
Test: loss=0.133 , acc= 96.0%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 395/784
Layer 2 : 100/100
Layer 3 : 91/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.4%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.6%  97.2%  97.1%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  96.9%  96.6%  97.0%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0%
 95.8%  96.7%  96.3%  96.7%  96.8%  96.6%   0.0%   0.0%   0.0%   0.0%
 95.5%  96.2%  96.1%  96.5%  96.3%  96.2%  96.6%   0.0%   0.0%   0.0%
 95.2%  95.9%  95.8%  95.8%  95.7%  95.8%  96.2%  96.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  8 (pmnist-8)
****************************************************************************************************
----------------------------------------
Task ID :8 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.245, acc= 92.8% | time=60781.7ms |
 Valid: loss=0.239, acc= 93.0% |
Epoch   2 | Train: loss=0.183, acc= 94.7% | time=59114.7ms |
 Valid: loss=0.185, acc= 94.7% |
Epoch   3 | Train: loss=0.153, acc= 95.6% | time=61170.0ms |
 Valid: loss=0.160, acc= 95.6% |
Epoch   4 | Train: loss=0.133, acc= 96.2% | time=63151.9ms |
 Valid: loss=0.143, acc= 96.0% |
Epoch   5 | Train: loss=0.120, acc= 96.6% | time=61090.7ms |
 Valid: loss=0.134, acc= 96.3% |
Test: loss=0.129 , acc= 96.0%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
Skip Updating GPM for layer: 3
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 429/784
Layer 2 : 100/100
Layer 3 : 91/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.4%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.6%  97.2%  97.1%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  96.9%  96.6%  97.0%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0%
 95.8%  96.7%  96.3%  96.7%  96.8%  96.6%   0.0%   0.0%   0.0%   0.0%
 95.5%  96.2%  96.1%  96.5%  96.3%  96.2%  96.6%   0.0%   0.0%   0.0%
 95.2%  95.9%  95.8%  95.8%  95.7%  95.8%  96.2%  96.0%   0.0%   0.0%
 94.6%  95.7%  95.4%  95.3%  95.1%  95.3%  95.7%  95.6%  96.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  9 (pmnist-9)
****************************************************************************************************
----------------------------------------
Task ID :9 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.264, acc= 92.3% | time=86648.5ms |
 Valid: loss=0.263, acc= 92.1% |
Epoch   2 | Train: loss=0.195, acc= 94.4% | time=96636.7ms |
 Valid: loss=0.198, acc= 94.0% |
Epoch   3 | Train: loss=0.163, acc= 95.3% | time=95419.4ms |
 Valid: loss=0.171, acc= 94.9% |
Epoch   4 | Train: loss=0.143, acc= 96.0% | time=88745.5ms |
 Valid: loss=0.155, acc= 95.4% |
Epoch   5 | Train: loss=0.130, acc= 96.3% | time=59087.3ms |
 Valid: loss=0.143, acc= 95.7% |
Test: loss=0.151 , acc= 95.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 458/784
Layer 2 : 100/100
Layer 3 : 92/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.4%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.6%  97.2%  97.1%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  96.9%  96.6%  97.0%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0%
 95.8%  96.7%  96.3%  96.7%  96.8%  96.6%   0.0%   0.0%   0.0%   0.0%
 95.5%  96.2%  96.1%  96.5%  96.3%  96.2%  96.6%   0.0%   0.0%   0.0%
 95.2%  95.9%  95.8%  95.8%  95.7%  95.8%  96.2%  96.0%   0.0%   0.0%
 94.6%  95.7%  95.4%  95.3%  95.1%  95.3%  95.7%  95.6%  96.0%   0.0%
 94.2%  95.1%  95.2%  94.6%  94.8%  95.0%  95.2%  95.0%  95.5%  95.6%
--------------------------------------------------
Final Avg Accuracy: 95.03%
Backward transfer: -1.94%
[Elapsed time = 4165079.3 ms]
--------------------------------------------------
====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=10, gpm_thro=0.93, lr=0.01, lr_factor=2, lr_min=1e-05, lr_patience=6, mixup_alpha=20, mixup_weight=0.01, momentum=0.9, n_epochs=5, n_hidden=100, n_outputs=10, n_tasks=10, pc_valid=0.1, savename='./log/DFSGP/', scale_coff=10, seed=2)
====================================================================================================
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  0 (pmnist-0)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.185, acc= 94.9% | time=62306.9ms |
 Valid: loss=0.177, acc= 95.1% |
Epoch   2 | Train: loss=0.124, acc= 96.7% | time=60520.6ms |
 Valid: loss=0.127, acc= 96.7% |
Epoch   3 | Train: loss=0.091, acc= 97.5% | time=62024.4ms |
 Valid: loss=0.104, acc= 97.1% |
Epoch   4 | Train: loss=0.075, acc= 98.0% | time=59543.8ms |
 Valid: loss=0.091, acc= 97.5% |
Epoch   5 | Train: loss=0.062, acc= 98.4% | time=58881.8ms |
 Valid: loss=0.083, acc= 97.8% |
----------------------------------------
Test: loss=0.082 , acc= 97.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 62/784
Layer 2 : 65/100
Layer 3 : 51/100
----------------------------------------
Accuracies =
 97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  1 (pmnist-1)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.142, acc= 96.2% | time=59696.4ms |
 Valid: loss=0.144, acc= 96.0% |
Epoch   2 | Train: loss=0.102, acc= 97.3% | time=65313.2ms |
 Valid: loss=0.112, acc= 96.7% |
Epoch   3 | Train: loss=0.081, acc= 97.8% | time=71119.6ms |
 Valid: loss=0.097, acc= 97.4% |
Epoch   4 | Train: loss=0.070, acc= 98.3% | time=83709.6ms |
 Valid: loss=0.092, acc= 97.5% |
Epoch   5 | Train: loss=0.060, acc= 98.4% | time=91745.2ms |
 Valid: loss=0.083, acc= 97.6% |
Test: loss=0.079 , acc= 97.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 122/784
Layer 2 : 86/100
Layer 3 : 70/100
----------------------------------------
Accuracies =
 97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  2 (pmnist-2)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.144, acc= 96.0% | time=96744.7ms |
 Valid: loss=0.139, acc= 96.3% |
Epoch   2 | Train: loss=0.106, acc= 97.2% | time=68262.7ms |
 Valid: loss=0.112, acc= 96.9% |
Epoch   3 | Train: loss=0.087, acc= 97.7% | time=57848.2ms |
 Valid: loss=0.098, acc= 97.2% |
Epoch   4 | Train: loss=0.075, acc= 98.0% | time=64933.3ms |
 Valid: loss=0.091, acc= 97.3% |
Epoch   5 | Train: loss=0.067, acc= 98.3% | time=59168.9ms |
 Valid: loss=0.085, acc= 97.5% |
Test: loss=0.084 , acc= 97.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 179/784
Layer 2 : 95/100
Layer 3 : 79/100
----------------------------------------
Accuracies =
 97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.5%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  3 (pmnist-3)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.151, acc= 95.7% | time=61759.3ms |
 Valid: loss=0.153, acc= 95.7% |
Epoch   2 | Train: loss=0.111, acc= 96.9% | time=63707.8ms |
 Valid: loss=0.121, acc= 96.6% |
Epoch   3 | Train: loss=0.095, acc= 97.5% | time=61720.5ms |
 Valid: loss=0.109, acc= 96.9% |
Epoch   4 | Train: loss=0.083, acc= 97.7% | time=64645.4ms |
 Valid: loss=0.100, acc= 97.2% |
Epoch   5 | Train: loss=0.075, acc= 98.0% | time=68060.9ms |
 Valid: loss=0.095, acc= 97.2% |
Test: loss=0.095 , acc= 97.3%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 231/784
Layer 2 : 98/100
Layer 3 : 82/100
----------------------------------------
Accuracies =
 97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.5%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.3%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  4 (pmnist-4)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.164, acc= 95.3% | time=107921.4ms |
 Valid: loss=0.162, acc= 95.4% |
Epoch   2 | Train: loss=0.125, acc= 96.4% | time=83926.4ms |
 Valid: loss=0.129, acc= 96.5% |
Epoch   3 | Train: loss=0.105, acc= 97.2% | time=86544.1ms |
 Valid: loss=0.115, acc= 96.8% |
Epoch   4 | Train: loss=0.092, acc= 97.5% | time=68135.5ms |
 Valid: loss=0.106, acc= 97.0% |
Epoch   5 | Train: loss=0.083, acc= 97.8% | time=62754.0ms |
 Valid: loss=0.100, acc= 97.0% |
Test: loss=0.100 , acc= 97.0%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 278/784
Layer 2 : 99/100
Layer 3 : 84/100
----------------------------------------
Accuracies =
 97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.5%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.3%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  97.1%  97.0%  96.9%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  5 (pmnist-5)
****************************************************************************************************
----------------------------------------
Task ID :5 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.186, acc= 94.8% | time=61483.7ms |
 Valid: loss=0.183, acc= 94.8% |
Epoch   2 | Train: loss=0.141, acc= 96.1% | time=61552.0ms |
 Valid: loss=0.145, acc= 95.9% |
Epoch   3 | Train: loss=0.117, acc= 96.8% | time=68930.7ms |
 Valid: loss=0.126, acc= 96.5% |
Epoch   4 | Train: loss=0.104, acc= 97.2% | time=59388.9ms |
 Valid: loss=0.117, acc= 96.8% |
Epoch   5 | Train: loss=0.094, acc= 97.4% | time=58582.8ms |
 Valid: loss=0.108, acc= 96.9% |
Test: loss=0.106 , acc= 96.9%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 320/784
Layer 2 : 99/100
Layer 3 : 86/100
----------------------------------------
Accuracies =
 97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.5%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.3%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  97.1%  97.0%  96.9%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.1%  96.9%  96.8%  96.7%  96.8%  96.9%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  6 (pmnist-6)
****************************************************************************************************
----------------------------------------
Task ID :6 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.213, acc= 94.0% | time=63931.0ms |
 Valid: loss=0.204, acc= 94.3% |
Epoch   2 | Train: loss=0.161, acc= 95.5% | time=66993.7ms |
 Valid: loss=0.160, acc= 95.6% |
Epoch   3 | Train: loss=0.137, acc= 96.2% | time=96465.6ms |
 Valid: loss=0.140, acc= 95.9% |
Epoch   4 | Train: loss=0.120, acc= 96.7% | time=90036.3ms |
 Valid: loss=0.128, acc= 96.4% |
Epoch   5 | Train: loss=0.112, acc= 97.0% | time=87910.0ms |
 Valid: loss=0.122, acc= 96.5% |
Test: loss=0.125 , acc= 96.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 359/784
Layer 2 : 100/100
Layer 3 : 87/100
----------------------------------------
Accuracies =
 97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.5%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.3%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  97.1%  97.0%  96.9%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.1%  96.9%  96.8%  96.7%  96.8%  96.9%   0.0%   0.0%   0.0%   0.0%
 95.4%  96.5%  96.6%  96.4%  96.4%  96.5%  96.6%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  7 (pmnist-7)
****************************************************************************************************
----------------------------------------
Task ID :7 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.249, acc= 92.8% | time=78738.5ms |
 Valid: loss=0.240, acc= 93.0% |
Epoch   2 | Train: loss=0.184, acc= 94.7% | time=66341.3ms |
 Valid: loss=0.183, acc= 94.9% |
Epoch   3 | Train: loss=0.154, acc= 95.7% | time=65853.7ms |
 Valid: loss=0.158, acc= 95.5% |
Epoch   4 | Train: loss=0.134, acc= 96.3% | time=67042.8ms |
 Valid: loss=0.142, acc= 95.9% |
Epoch   5 | Train: loss=0.121, acc= 96.7% | time=65093.3ms |
 Valid: loss=0.132, acc= 96.3% |
Test: loss=0.133 , acc= 96.0%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 397/784
Layer 2 : 100/100
Layer 3 : 88/100
----------------------------------------
Accuracies =
 97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.5%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.3%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  97.1%  97.0%  96.9%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.1%  96.9%  96.8%  96.7%  96.8%  96.9%   0.0%   0.0%   0.0%   0.0%
 95.4%  96.5%  96.6%  96.4%  96.4%  96.5%  96.6%   0.0%   0.0%   0.0%
 94.6%  95.9%  96.0%  96.0%  96.2%  96.0%  96.1%  96.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  8 (pmnist-8)
****************************************************************************************************
----------------------------------------
Task ID :8 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.233, acc= 93.1% | time=59957.0ms |
 Valid: loss=0.233, acc= 93.3% |
Epoch   2 | Train: loss=0.174, acc= 94.9% | time=62454.9ms |
 Valid: loss=0.182, acc= 94.8% |
Epoch   3 | Train: loss=0.148, acc= 95.8% | time=59159.6ms |
 Valid: loss=0.162, acc= 95.3% |
Epoch   4 | Train: loss=0.130, acc= 96.3% | time=59079.7ms |
 Valid: loss=0.145, acc= 96.0% |
Epoch   5 | Train: loss=0.118, acc= 96.7% | time=97863.2ms |
 Valid: loss=0.136, acc= 96.3% |
Test: loss=0.132 , acc= 96.1%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
Skip Updating GPM for layer: 3
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 430/784
Layer 2 : 100/100
Layer 3 : 88/100
----------------------------------------
Accuracies =
 97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.5%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.3%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  97.1%  97.0%  96.9%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.1%  96.9%  96.8%  96.7%  96.8%  96.9%   0.0%   0.0%   0.0%   0.0%
 95.4%  96.5%  96.6%  96.4%  96.4%  96.5%  96.6%   0.0%   0.0%   0.0%
 94.6%  95.9%  96.0%  96.0%  96.2%  96.0%  96.1%  96.0%   0.0%   0.0%
 93.8%  95.5%  95.7%  95.8%  95.7%  95.7%  95.8%  95.3%  96.1%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  9 (pmnist-9)
****************************************************************************************************
----------------------------------------
Task ID :9 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.257, acc= 92.4% | time=92077.2ms |
 Valid: loss=0.252, acc= 92.8% |
Epoch   2 | Train: loss=0.192, acc= 94.5% | time=77681.5ms |
 Valid: loss=0.195, acc= 94.8% |
Epoch   3 | Train: loss=0.161, acc= 95.4% | time=81531.9ms |
 Valid: loss=0.169, acc= 95.3% |
Epoch   4 | Train: loss=0.142, acc= 96.0% | time=59568.0ms |
 Valid: loss=0.153, acc= 95.7% |
Epoch   5 | Train: loss=0.130, acc= 96.3% | time=59540.7ms |
 Valid: loss=0.144, acc= 95.9% |
Test: loss=0.141 , acc= 95.9%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 460/784
Layer 2 : 100/100
Layer 3 : 89/100
----------------------------------------
Accuracies =
 97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.4%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.2%  97.5%  97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.3%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.5%  97.1%  97.0%  96.9%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.1%  96.9%  96.8%  96.7%  96.8%  96.9%   0.0%   0.0%   0.0%   0.0%
 95.4%  96.5%  96.6%  96.4%  96.4%  96.5%  96.6%   0.0%   0.0%   0.0%
 94.6%  95.9%  96.0%  96.0%  96.2%  96.0%  96.1%  96.0%   0.0%   0.0%
 93.8%  95.5%  95.7%  95.8%  95.7%  95.7%  95.8%  95.3%  96.1%   0.0%
 93.7%  95.0%  95.4%  95.2%  95.1%  95.3%  95.1%  94.8%  95.4%  95.9%
--------------------------------------------------
Final Avg Accuracy: 95.09%
Backward transfer: -1.97%
[Elapsed time = 3730763.0 ms]
--------------------------------------------------
====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=10, gpm_thro=0.93, lr=0.01, lr_factor=2, lr_min=1e-05, lr_patience=6, mixup_alpha=20, mixup_weight=0.01, momentum=0.9, n_epochs=5, n_hidden=100, n_outputs=10, n_tasks=10, pc_valid=0.1, savename='./log/DFSGP/', scale_coff=10, seed=3)
====================================================================================================
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  0 (pmnist-0)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.169, acc= 95.3% | time=58705.5ms |
 Valid: loss=0.164, acc= 95.6% |
Epoch   2 | Train: loss=0.119, acc= 96.8% | time=52484.9ms |
 Valid: loss=0.123, acc= 96.6% |
Epoch   3 | Train: loss=0.090, acc= 97.6% | time=49543.8ms |
 Valid: loss=0.102, acc= 97.1% |
Epoch   4 | Train: loss=0.073, acc= 98.1% | time=51153.1ms |
 Valid: loss=0.094, acc= 97.3% |
Epoch   5 | Train: loss=0.060, acc= 98.4% | time=52680.3ms |
 Valid: loss=0.082, acc= 97.7% |
----------------------------------------
Test: loss=0.080 , acc= 97.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 63/784
Layer 2 : 64/100
Layer 3 : 51/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  1 (pmnist-1)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.133, acc= 96.3% | time=56002.5ms |
 Valid: loss=0.136, acc= 96.2% |
Epoch   2 | Train: loss=0.095, acc= 97.4% | time=57922.5ms |
 Valid: loss=0.106, acc= 97.1% |
Epoch   3 | Train: loss=0.078, acc= 97.9% | time=56494.3ms |
 Valid: loss=0.095, acc= 97.3% |
Epoch   4 | Train: loss=0.065, acc= 98.3% | time=59411.4ms |
 Valid: loss=0.086, acc= 97.7% |
Epoch   5 | Train: loss=0.056, acc= 98.5% | time=65363.9ms |
 Valid: loss=0.081, acc= 97.9% |
Test: loss=0.078 , acc= 97.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 124/784
Layer 2 : 86/100
Layer 3 : 72/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.5%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  2 (pmnist-2)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.141, acc= 96.1% | time=52768.1ms |
 Valid: loss=0.143, acc= 96.0% |
Epoch   2 | Train: loss=0.104, acc= 97.2% | time=62140.5ms |
 Valid: loss=0.115, acc= 96.8% |
Epoch   3 | Train: loss=0.083, acc= 97.7% | time=59198.1ms |
 Valid: loss=0.098, acc= 97.2% |
Epoch   4 | Train: loss=0.072, acc= 98.1% | time=59952.7ms |
 Valid: loss=0.089, acc= 97.5% |
Epoch   5 | Train: loss=0.065, acc= 98.3% | time=55903.9ms |
 Valid: loss=0.086, acc= 97.5% |
Test: loss=0.085 , acc= 97.5%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 181/784
Layer 2 : 95/100
Layer 3 : 81/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.5%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.1%  97.5%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  3 (pmnist-3)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.150, acc= 95.8% | time=55199.6ms |
 Valid: loss=0.155, acc= 95.9% |
Epoch   2 | Train: loss=0.110, acc= 96.9% | time=56085.2ms |
 Valid: loss=0.121, acc= 96.5% |
Epoch   3 | Train: loss=0.093, acc= 97.5% | time=55040.5ms |
 Valid: loss=0.107, acc= 96.9% |
Epoch   4 | Train: loss=0.081, acc= 97.8% | time=57667.2ms |
 Valid: loss=0.099, acc= 97.2% |
Epoch   5 | Train: loss=0.072, acc= 98.1% | time=56379.7ms |
 Valid: loss=0.093, acc= 97.4% |
Test: loss=0.091 , acc= 97.2%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 234/784
Layer 2 : 98/100
Layer 3 : 85/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.5%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.1%  97.5%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.9%  97.4%  97.2%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  4 (pmnist-4)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.172, acc= 95.1% | time=55741.8ms |
 Valid: loss=0.170, acc= 95.1% |
Epoch   2 | Train: loss=0.130, acc= 96.4% | time=56097.9ms |
 Valid: loss=0.136, acc= 96.1% |
Epoch   3 | Train: loss=0.109, acc= 97.0% | time=56145.2ms |
 Valid: loss=0.122, acc= 96.6% |
Epoch   4 | Train: loss=0.097, acc= 97.3% | time=60869.8ms |
 Valid: loss=0.114, acc= 96.9% |
Epoch   5 | Train: loss=0.087, acc= 97.7% | time=59217.6ms |
 Valid: loss=0.107, acc= 97.0% |
Test: loss=0.106 , acc= 96.8%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 282/784
Layer 2 : 99/100
Layer 3 : 88/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.5%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.1%  97.5%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.9%  97.4%  97.2%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.2%  97.0%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  5 (pmnist-5)
****************************************************************************************************
----------------------------------------
Task ID :5 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.190, acc= 94.7% | time=59041.9ms |
 Valid: loss=0.188, acc= 95.1% |
Epoch   2 | Train: loss=0.138, acc= 96.2% | time=57959.0ms |
 Valid: loss=0.144, acc= 96.3% |
Epoch   3 | Train: loss=0.115, acc= 96.9% | time=54202.2ms |
 Valid: loss=0.126, acc= 96.8% |
Epoch   4 | Train: loss=0.100, acc= 97.2% | time=53116.1ms |
 Valid: loss=0.115, acc= 96.9% |
Epoch   5 | Train: loss=0.089, acc= 97.6% | time=55708.0ms |
 Valid: loss=0.109, acc= 97.0% |
Test: loss=0.105 , acc= 97.0%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 325/784
Layer 2 : 100/100
Layer 3 : 89/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.5%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.1%  97.5%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.9%  97.4%  97.2%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.2%  97.0%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.3%  96.9%  96.7%  96.6%  96.5%  97.0%   0.0%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  6 (pmnist-6)
****************************************************************************************************
----------------------------------------
Task ID :6 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.210, acc= 94.0% | time=53572.6ms |
 Valid: loss=0.208, acc= 94.3% |
Epoch   2 | Train: loss=0.158, acc= 95.6% | time=55901.7ms |
 Valid: loss=0.165, acc= 95.5% |
Epoch   3 | Train: loss=0.134, acc= 96.2% | time=60685.9ms |
 Valid: loss=0.144, acc= 96.2% |
Epoch   4 | Train: loss=0.118, acc= 96.7% | time=60025.6ms |
 Valid: loss=0.133, acc= 96.4% |
Epoch   5 | Train: loss=0.105, acc= 97.1% | time=55385.6ms |
 Valid: loss=0.122, acc= 96.7% |
Test: loss=0.121 , acc= 96.4%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 365/784
Layer 2 : 100/100
Layer 3 : 90/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.5%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.1%  97.5%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.9%  97.4%  97.2%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.2%  97.0%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.3%  96.9%  96.7%  96.6%  96.5%  97.0%   0.0%   0.0%   0.0%   0.0%
 95.8%  96.6%  96.6%  96.4%  95.9%  96.6%  96.4%   0.0%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  7 (pmnist-7)
****************************************************************************************************
----------------------------------------
Task ID :7 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.223, acc= 93.5% | time=62226.9ms |
 Valid: loss=0.209, acc= 94.0% |
Epoch   2 | Train: loss=0.166, acc= 95.3% | time=55464.2ms |
 Valid: loss=0.161, acc= 95.5% |
Epoch   3 | Train: loss=0.138, acc= 96.1% | time=57890.6ms |
 Valid: loss=0.140, acc= 96.2% |
Epoch   4 | Train: loss=0.121, acc= 96.5% | time=54313.4ms |
 Valid: loss=0.126, acc= 96.3% |
Epoch   5 | Train: loss=0.109, acc= 96.9% | time=55712.3ms |
 Valid: loss=0.119, acc= 96.6% |
Test: loss=0.122 , acc= 96.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 401/784
Layer 2 : 100/100
Layer 3 : 91/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.5%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.1%  97.5%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.9%  97.4%  97.2%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.2%  97.0%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.3%  96.9%  96.7%  96.6%  96.5%  97.0%   0.0%   0.0%   0.0%   0.0%
 95.8%  96.6%  96.6%  96.4%  95.9%  96.6%  96.4%   0.0%   0.0%   0.0%
 95.6%  96.3%  96.3%  96.1%  95.7%  96.3%  96.0%  96.6%   0.0%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  8 (pmnist-8)
****************************************************************************************************
----------------------------------------
Task ID :8 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.264, acc= 92.2% | time=56111.1ms |
 Valid: loss=0.251, acc= 92.9% |
Epoch   2 | Train: loss=0.200, acc= 94.2% | time=56776.0ms |
 Valid: loss=0.195, acc= 94.4% |
Epoch   3 | Train: loss=0.167, acc= 95.1% | time=57253.9ms |
 Valid: loss=0.168, acc= 95.2% |
Epoch   4 | Train: loss=0.147, acc= 95.7% | time=57703.8ms |
 Valid: loss=0.150, acc= 95.6% |
Epoch   5 | Train: loss=0.134, acc= 96.2% | time=57207.0ms |
 Valid: loss=0.139, acc= 96.0% |
Test: loss=0.147 , acc= 95.4%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 432/784
Layer 2 : 100/100
Layer 3 : 92/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.5%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.1%  97.5%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.9%  97.4%  97.2%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.2%  97.0%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.3%  96.9%  96.7%  96.6%  96.5%  97.0%   0.0%   0.0%   0.0%   0.0%
 95.8%  96.6%  96.6%  96.4%  95.9%  96.6%  96.4%   0.0%   0.0%   0.0%
 95.6%  96.3%  96.3%  96.1%  95.7%  96.3%  96.0%  96.6%   0.0%   0.0%
 94.8%  95.7%  95.9%  95.4%  95.6%  95.8%  95.3%  95.6%  95.4%   0.0%
threshold:[0.93 0.99 0.99]
****************************************************************************************************
Task  9 (pmnist-9)
****************************************************************************************************
----------------------------------------
Task ID :9 | Learning Rate : 0.01
----------------------------------------
Epoch   1 | Train: loss=0.269, acc= 92.1% | time=64932.8ms |
 Valid: loss=0.256, acc= 92.6% |
Epoch   2 | Train: loss=0.204, acc= 94.2% | time=62342.3ms |
 Valid: loss=0.198, acc= 94.7% |
Epoch   3 | Train: loss=0.173, acc= 95.0% | time=61119.2ms |
 Valid: loss=0.173, acc= 95.3% |
Epoch   4 | Train: loss=0.155, acc= 95.6% | time=58628.1ms |
 Valid: loss=0.159, acc= 95.7% |
Epoch   5 | Train: loss=0.142, acc= 96.0% | time=59876.3ms |
 Valid: loss=0.148, acc= 95.9% |
Test: loss=0.150 , acc= 95.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
Skip Updating GPM for layer: 3
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 462/784
Layer 2 : 100/100
Layer 3 : 92/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.5%  97.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 97.1%  97.5%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.9%  97.4%  97.2%  97.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.8%  97.2%  97.0%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0%
 96.3%  96.9%  96.7%  96.6%  96.5%  97.0%   0.0%   0.0%   0.0%   0.0%
 95.8%  96.6%  96.6%  96.4%  95.9%  96.6%  96.4%   0.0%   0.0%   0.0%
 95.6%  96.3%  96.3%  96.1%  95.7%  96.3%  96.0%  96.6%   0.0%   0.0%
 94.8%  95.7%  95.9%  95.4%  95.6%  95.8%  95.3%  95.6%  95.4%   0.0%
 94.1%  95.5%  95.5%  94.8%  94.8%  95.5%  94.8%  95.1%  95.0%  95.7%
--------------------------------------------------
Final Avg Accuracy: 95.09%
Backward transfer: -1.90%
[Elapsed time = 3000777.9 ms]
--------------------------------------------------
gpm_thro: 0.93
Accuracy: [95.025, 95.09299999999999, 95.09100000000001]
Backward transfer: [-1.9355555555555557, -1.9722222222222223, -1.9044444444444446]
Final Avg Accuracy: 95.07%, std: 0.03
Final Avg Backward transfer: -1.94%, std: 0.03
