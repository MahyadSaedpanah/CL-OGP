====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=64, gpm_thro=0.97, lr=0.01, lr_factor=2, lr_min=1e-05, lr_patience=6, mixup_alpha=20, mixup_weight=0.0001, momentum=0.9, n_epochs=200, pc_valid=0.05, savename='./log/DFTRGP/', seed=1)
====================================================================================================
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  0 (cifar100-0)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.01
----------------------------------------
Model parameters ---
(0, 'conv1.weight', torch.Size([64, 3, 4, 4]))
(5, 'conv2.weight', torch.Size([128, 64, 3, 3]))
(10, 'conv3.weight', torch.Size([256, 128, 2, 2]))
(15, 'fc1.weight', torch.Size([2048, 1024]))
(20, 'fc2.weight', torch.Size([2048, 2048]))
(25, 'fc3.0.weight', torch.Size([10, 2048]))
(26, 'fc3.1.weight', torch.Size([10, 2048]))
(27, 'fc3.2.weight', torch.Size([10, 2048]))
(28, 'fc3.3.weight', torch.Size([10, 2048]))
(29, 'fc3.4.weight', torch.Size([10, 2048]))
(30, 'fc3.5.weight', torch.Size([10, 2048]))
(31, 'fc3.6.weight', torch.Size([10, 2048]))
(32, 'fc3.7.weight', torch.Size([10, 2048]))
(33, 'fc3.8.weight', torch.Size([10, 2048]))
(34, 'fc3.9.weight', torch.Size([10, 2048]))
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
----------------------------------------
Test: loss=0.849 , acc= 76.2%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.844 , acc= 76.3%
Test: loss=0.883 , acc= 75.1%
Test: loss=0.862 , acc= 75.9%
Test: loss=0.859 , acc= 76.1%
Test: loss=0.847 , acc= 76.6%
Test: loss=0.853 , acc= 76.2%
Test: loss=0.871 , acc= 76.4%
Test: loss=0.853 , acc= 76.0%
Test: loss=0.877 , acc= 76.4%
Test: loss=0.867 , acc= 75.6%
Accuracies =
 76.1%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  1 (cifar100-1)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.6521566000775013, threshold for regime 1:0.3346281349658966
Task:0, layer:1, space shape:(576, 123)
Task:0, Layer:1, project_norm:1.1131948566328158, threshold for regime 1:0.5759822130203247
Task:0, layer:2, space shape:(512, 188)
Task:0, Layer:2, project_norm:1.3312897486594724, threshold for regime 1:0.6952221393585205
Task:0, layer:3, space shape:(1024, 78)
Task:0, Layer:3, project_norm:1.5702089071273804, threshold for regime 1:0.9795436859130859
Task:0, layer:4, space shape:(2048, 96)
Task:0, Layer:4, project_norm:2.0844948291778564, threshold for regime 1:1.3380945920944214
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
space1 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.994 , acc= 69.9%
Test: loss=1.002 , acc= 70.3%
Test: loss=1.026 , acc= 70.7%
Test: loss=0.992 , acc= 71.6%
Test: loss=0.998 , acc= 70.4%
Test: loss=0.994 , acc= 71.4%
Test: loss=0.995 , acc= 70.2%
Test: loss=0.990 , acc= 70.9%
Test: loss=0.995 , acc= 70.4%
Test: loss=0.992 , acc= 71.2%
Average acc= 70.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 8)
threshold for selecting:41146.013012936855
total ranking r = 10
the number of space for current task:10
the new increased space:1, the threshold for new space:8
Ui shape:(48, 10)
activation shape:(576, 14400)
space shape:(576, 123)
threshold for selecting:285507.57266786176
total ranking r = 156
the number of space for current task:156
the new increased space:32, the threshold for new space:123
Ui shape:(576, 156)
activation shape:(512, 2500)
space shape:(512, 188)
threshold for selecting:59755.45750426171
total ranking r = 250
the number of space for current task:250
the new increased space:63, the threshold for new space:188
Ui shape:(512, 250)
activation shape:(1024, 125)
space shape:(1024, 78)
threshold for selecting:27450.112781235017
total ranking r = 144
the number of space for current task:144
the new increased space:84, the threshold for new space:78
Ui shape:(1024, 144)
activation shape:(2048, 125)
space shape:(2048, 96)
threshold for selecting:46482.18489268073
total ranking r = 172
the number of space for current task:172
the new increased space:115, the threshold for new space:96
Ui shape:(2048, 172)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.810 , acc= 76.0%
Test: loss=0.833 , acc= 75.9%
Test: loss=0.793 , acc= 76.3%
Test: loss=0.830 , acc= 76.8%
Test: loss=0.841 , acc= 77.0%
Test: loss=0.830 , acc= 76.2%
Test: loss=0.853 , acc= 76.8%
Test: loss=0.840 , acc= 76.5%
Test: loss=0.827 , acc= 76.1%
Test: loss=0.846 , acc= 76.0%
current testing task:cifar100-1
Test: loss=0.968 , acc= 72.2%
Test: loss=0.961 , acc= 70.8%
Test: loss=0.989 , acc= 71.1%
Test: loss=0.996 , acc= 71.0%
Test: loss=0.990 , acc= 70.6%
Test: loss=0.984 , acc= 70.6%
Test: loss=0.972 , acc= 70.6%
Test: loss=0.975 , acc= 70.1%
Test: loss=0.988 , acc= 71.9%
Test: loss=0.988 , acc= 71.1%
Accuracies =
 76.1%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.4%  71.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  2 (cifar100-2)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.7627980754830272, threshold for regime 1:0.387318879365921
Task:0, layer:1, space shape:(576, 123)
Task:0, Layer:1, project_norm:1.1188472077662686, threshold for regime 1:0.5787912011146545
Task:0, layer:2, space shape:(512, 188)
Task:0, Layer:2, project_norm:1.336903322058984, threshold for regime 1:0.6954472064971924
Task:0, layer:3, space shape:(1024, 78)
Task:0, Layer:3, project_norm:1.5977404117584229, threshold for regime 1:0.9653501510620117
Task:0, layer:4, space shape:(2048, 96)
Task:0, Layer:4, project_norm:2.1924455165863037, threshold for regime 1:1.365502953529358
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 10)
Task:1, Layer:0, project_norm:0.765247448088618, threshold for regime 1:0.387318879365921
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.1309399107621279, threshold for regime 1:0.5787912011146545
Task:1, layer:2, space shape:(512, 250)
Task:1, Layer:2, project_norm:1.3542523781056757, threshold for regime 1:0.6954472064971924
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.6790275573730469, threshold for regime 1:0.9653501510620117
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.3047618865966797, threshold for regime 1:1.365502953529358
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[0 1]
Layer:1, selected task ID:[0 1]
Layer:2, selected task ID:[0 1]
Layer:3, selected task ID:[0 1]
Layer:4, selected task ID:[0 1]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.825 , acc= 75.0%
Test: loss=0.795 , acc= 74.5%
Test: loss=0.819 , acc= 75.5%
Test: loss=0.797 , acc= 75.3%
Test: loss=0.798 , acc= 75.5%
Test: loss=0.816 , acc= 74.8%
Test: loss=0.813 , acc= 74.9%
Test: loss=0.810 , acc= 74.2%
Test: loss=0.809 , acc= 74.0%
Test: loss=0.808 , acc= 75.0%
Average acc= 74.9%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 9)
threshold for selecting:25591.01016216418
total ranking r = 8
the number of space for current task:8
the new increased space:0, the threshold for new space:9
Ui shape:(48, 8)
activation shape:(576, 14400)
space shape:(576, 155)
threshold for selecting:225470.87538663507
total ranking r = 159
the number of space for current task:159
the new increased space:10, the threshold for new space:155
Ui shape:(576, 159)
activation shape:(512, 2500)
space shape:(512, 251)
threshold for selecting:42129.33617067754
total ranking r = 263
the number of space for current task:263
the new increased space:35, the threshold for new space:251
Ui shape:(512, 263)
activation shape:(1024, 125)
space shape:(1024, 162)
threshold for selecting:19259.98123634234
total ranking r = 204
the number of space for current task:204
the new increased space:92, the threshold for new space:162
Ui shape:(1024, 204)
activation shape:(2048, 125)
space shape:(2048, 211)
threshold for selecting:34493.22811023542
total ranking r = 253
the number of space for current task:253
the new increased space:117, the threshold for new space:211
Ui shape:(2048, 253)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.848 , acc= 77.0%
Test: loss=0.821 , acc= 76.4%
Test: loss=0.836 , acc= 77.0%
Test: loss=0.828 , acc= 76.7%
Test: loss=0.836 , acc= 76.5%
Test: loss=0.846 , acc= 75.9%
Test: loss=0.800 , acc= 77.3%
Test: loss=0.841 , acc= 76.9%
Test: loss=0.827 , acc= 76.3%
Test: loss=0.819 , acc= 76.2%
current testing task:cifar100-1
Test: loss=0.986 , acc= 70.8%
Test: loss=0.952 , acc= 71.1%
Test: loss=0.976 , acc= 70.6%
Test: loss=1.002 , acc= 70.4%
Test: loss=0.996 , acc= 70.7%
Test: loss=1.002 , acc= 70.7%
Test: loss=0.985 , acc= 71.0%
Test: loss=0.980 , acc= 72.0%
Test: loss=0.992 , acc= 71.0%
Test: loss=0.988 , acc= 70.8%
current testing task:cifar100-2
Test: loss=0.814 , acc= 74.5%
Test: loss=0.802 , acc= 75.3%
Test: loss=0.799 , acc= 74.7%
Test: loss=0.784 , acc= 75.8%
Test: loss=0.804 , acc= 75.3%
Test: loss=0.804 , acc= 75.3%
Test: loss=0.778 , acc= 76.3%
Test: loss=0.806 , acc= 75.0%
Test: loss=0.796 , acc= 75.5%
Test: loss=0.812 , acc= 75.0%
Accuracies =
 76.1%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.4%  71.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  70.9%  75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  3 (cifar100-3)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.8345146938251308, threshold for regime 1:0.423469215631485
Task:0, layer:1, space shape:(576, 123)
Task:0, Layer:1, project_norm:1.2380418262821196, threshold for regime 1:0.6395926475524902
Task:0, layer:2, space shape:(512, 188)
Task:0, Layer:2, project_norm:1.30078894861201, threshold for regime 1:0.6812689900398254
Task:0, layer:3, space shape:(1024, 78)
Task:0, Layer:3, project_norm:1.4703874588012695, threshold for regime 1:0.9220221042633057
Task:0, layer:4, space shape:(2048, 96)
Task:0, Layer:4, project_norm:1.8384140729904175, threshold for regime 1:1.2368495464324951
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 10)
Task:1, Layer:0, project_norm:0.8384319881405377, threshold for regime 1:0.423469215631485
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.2500256443611362, threshold for regime 1:0.6395926475524902
Task:1, layer:2, space shape:(512, 250)
Task:1, Layer:2, project_norm:1.3200536378088465, threshold for regime 1:0.6812689900398254
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.5660812854766846, threshold for regime 1:0.9220221042633057
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:1.9843844175338745, threshold for regime 1:1.2368495464324951
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.8345146938251308, threshold for regime 1:0.423469215631485
Task:2, layer:1, space shape:(576, 159)
Task:2, Layer:1, project_norm:1.2507772662732004, threshold for regime 1:0.6395926475524902
Task:2, layer:2, space shape:(512, 263)
Task:2, Layer:2, project_norm:1.3230330645187303, threshold for regime 1:0.6812689900398254
Task:2, layer:3, space shape:(1024, 204)
Task:2, Layer:3, project_norm:1.6085574626922607, threshold for regime 1:0.9220221042633057
Task:2, layer:4, space shape:(2048, 253)
Task:2, Layer:4, project_norm:2.059965133666992, threshold for regime 1:1.2368495464324951
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[2 1]
Layer:1, selected task ID:[1 2]
Layer:2, selected task ID:[1 2]
Layer:3, selected task ID:[1 2]
Layer:4, selected task ID:[1 2]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.854 , acc= 74.1%
Test: loss=0.816 , acc= 74.8%
Test: loss=0.822 , acc= 73.8%
Test: loss=0.810 , acc= 75.6%
Test: loss=0.820 , acc= 75.5%
Test: loss=0.825 , acc= 74.0%
Test: loss=0.851 , acc= 74.0%
Test: loss=0.837 , acc= 74.2%
Test: loss=0.818 , acc= 75.1%
Test: loss=0.838 , acc= 74.8%
Average acc= 74.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 9)
threshold for selecting:29542.375792458337
total ranking r = 9
the number of space for current task:9
the new increased space:0, the threshold for new space:9
Ui shape:(48, 9)
activation shape:(576, 14400)
space shape:(576, 165)
threshold for selecting:224086.8262770643
total ranking r = 167
the number of space for current task:167
the new increased space:8, the threshold for new space:165
Ui shape:(576, 167)
activation shape:(512, 2500)
space shape:(512, 286)
threshold for selecting:35610.49442915138
total ranking r = 275
the number of space for current task:275
the new increased space:27, the threshold for new space:286
Ui shape:(512, 275)
activation shape:(1024, 125)
space shape:(1024, 254)
threshold for selecting:15991.326724336483
total ranking r = 270
the number of space for current task:270
the new increased space:98, the threshold for new space:254
Ui shape:(1024, 270)
activation shape:(2048, 125)
space shape:(2048, 328)
threshold for selecting:30209.474999327445
total ranking r = 351
the number of space for current task:351
the new increased space:123, the threshold for new space:328
Ui shape:(2048, 351)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.825 , acc= 76.3%
Test: loss=0.825 , acc= 75.8%
Test: loss=0.807 , acc= 77.0%
Test: loss=0.808 , acc= 77.5%
Test: loss=0.808 , acc= 77.3%
Test: loss=0.830 , acc= 77.8%
Test: loss=0.839 , acc= 76.0%
Test: loss=0.804 , acc= 75.9%
Test: loss=0.824 , acc= 76.6%
Test: loss=0.818 , acc= 76.9%
current testing task:cifar100-1
Test: loss=0.972 , acc= 72.4%
Test: loss=1.002 , acc= 71.1%
Test: loss=0.981 , acc= 71.2%
Test: loss=0.990 , acc= 71.8%
Test: loss=0.983 , acc= 70.9%
Test: loss=0.970 , acc= 70.3%
Test: loss=0.988 , acc= 70.2%
Test: loss=0.965 , acc= 71.9%
Test: loss=1.003 , acc= 71.4%
Test: loss=1.001 , acc= 70.8%
current testing task:cifar100-2
Test: loss=0.787 , acc= 75.3%
Test: loss=0.801 , acc= 75.2%
Test: loss=0.788 , acc= 75.3%
Test: loss=0.797 , acc= 73.5%
Test: loss=0.784 , acc= 73.7%
Test: loss=0.785 , acc= 74.4%
Test: loss=0.811 , acc= 74.7%
Test: loss=0.831 , acc= 73.5%
Test: loss=0.789 , acc= 74.1%
Test: loss=0.780 , acc= 75.6%
current testing task:cifar100-3
Test: loss=0.843 , acc= 75.0%
Test: loss=0.834 , acc= 73.9%
Test: loss=0.845 , acc= 75.0%
Test: loss=0.847 , acc= 73.5%
Test: loss=0.824 , acc= 73.7%
Test: loss=0.831 , acc= 74.7%
Test: loss=0.834 , acc= 74.4%
Test: loss=0.866 , acc= 73.1%
Test: loss=0.844 , acc= 74.3%
Test: loss=0.831 , acc= 74.3%
Accuracies =
 76.1%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.4%  71.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  70.9%  75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.7%  71.2%  74.5%  74.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  4 (cifar100-4)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.6143219173095636, threshold for regime 1:0.3148944675922394
Task:0, layer:1, space shape:(576, 123)
Task:0, Layer:1, project_norm:1.144496155171559, threshold for regime 1:0.5972040295600891
Task:0, layer:2, space shape:(512, 188)
Task:0, Layer:2, project_norm:1.3293497263548884, threshold for regime 1:0.6967377066612244
Task:0, layer:3, space shape:(1024, 78)
Task:0, Layer:3, project_norm:1.515728235244751, threshold for regime 1:0.9514956474304199
Task:0, layer:4, space shape:(2048, 96)
Task:0, Layer:4, project_norm:1.9591267108917236, threshold for regime 1:1.2929607629776
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 10)
Task:1, Layer:0, project_norm:0.6185252743534274, threshold for regime 1:0.3148944675922394
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.1592070356749127, threshold for regime 1:0.5972040295600891
Task:1, layer:2, space shape:(512, 250)
Task:1, Layer:2, project_norm:1.3493752393115235, threshold for regime 1:0.6967377066612244
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.6166061162948608, threshold for regime 1:0.9514956474304199
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.0951273441314697, threshold for regime 1:1.2929607629776
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.6143219173095636, threshold for regime 1:0.3148944675922394
Task:2, layer:1, space shape:(576, 159)
Task:2, Layer:1, project_norm:1.1601076003786857, threshold for regime 1:0.5972040295600891
Task:2, layer:2, space shape:(512, 263)
Task:2, Layer:2, project_norm:1.3519321525875851, threshold for regime 1:0.6967377066612244
Task:2, layer:3, space shape:(1024, 204)
Task:2, Layer:3, project_norm:1.6556750535964966, threshold for regime 1:0.9514956474304199
Task:2, layer:4, space shape:(2048, 253)
Task:2, Layer:4, project_norm:2.167328357696533, threshold for regime 1:1.2929607629776
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.6169240578042456, threshold for regime 1:0.3148944675922394
Task:3, layer:1, space shape:(576, 167)
Task:3, Layer:1, project_norm:1.1625759777927884, threshold for regime 1:0.5972040295600891
Task:3, layer:2, space shape:(512, 275)
Task:3, Layer:2, project_norm:1.3547876295908468, threshold for regime 1:0.6967377066612244
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.6972016096115112, threshold for regime 1:0.9514956474304199
Task:3, layer:4, space shape:(2048, 351)
Task:3, Layer:4, project_norm:2.2326107025146484, threshold for regime 1:1.2929607629776
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[3 1]
Layer:1, selected task ID:[2 3]
Layer:2, selected task ID:[2 3]
Layer:3, selected task ID:[2 3]
Layer:4, selected task ID:[2 3]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.777 , acc= 79.2%
Test: loss=0.788 , acc= 78.3%
Test: loss=0.768 , acc= 78.4%
Test: loss=0.778 , acc= 78.0%
Test: loss=0.764 , acc= 78.0%
Test: loss=0.768 , acc= 77.6%
Test: loss=0.735 , acc= 79.1%
Test: loss=0.766 , acc= 78.2%
Test: loss=0.806 , acc= 77.1%
Test: loss=0.783 , acc= 78.8%
Average acc= 78.3%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 9)
threshold for selecting:33798.747677060455
total ranking r = 11
the number of space for current task:11
the new increased space:1, the threshold for new space:9
Ui shape:(48, 11)
activation shape:(576, 14400)
space shape:(576, 173)
threshold for selecting:250662.2730535896
total ranking r = 184
the number of space for current task:184
the new increased space:12, the threshold for new space:173
Ui shape:(576, 184)
activation shape:(512, 2500)
space shape:(512, 313)
threshold for selecting:32024.59594292989
total ranking r = 286
the number of space for current task:286
the new increased space:24, the threshold for new space:313
Ui shape:(512, 286)
activation shape:(1024, 125)
space shape:(1024, 352)
threshold for selecting:12427.01207983779
total ranking r = 335
the number of space for current task:335
the new increased space:96, the threshold for new space:352
Ui shape:(1024, 335)
activation shape:(2048, 125)
space shape:(2048, 451)
threshold for selecting:24683.78722856287
total ranking r = 447
the number of space for current task:447
the new increased space:123, the threshold for new space:451
Ui shape:(2048, 447)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.791 , acc= 77.1%
Test: loss=0.840 , acc= 76.1%
Test: loss=0.800 , acc= 77.5%
Test: loss=0.815 , acc= 76.6%
Test: loss=0.794 , acc= 76.6%
Test: loss=0.822 , acc= 77.0%
Test: loss=0.801 , acc= 76.9%
Test: loss=0.816 , acc= 77.8%
Test: loss=0.810 , acc= 77.5%
Test: loss=0.804 , acc= 77.0%
current testing task:cifar100-1
Test: loss=0.975 , acc= 71.4%
Test: loss=1.018 , acc= 69.7%
Test: loss=1.001 , acc= 70.1%
Test: loss=0.992 , acc= 71.5%
Test: loss=1.003 , acc= 69.8%
Test: loss=0.981 , acc= 71.2%
Test: loss=1.000 , acc= 71.6%
Test: loss=0.991 , acc= 70.5%
Test: loss=1.000 , acc= 71.3%
Test: loss=0.982 , acc= 72.9%
current testing task:cifar100-2
Test: loss=0.794 , acc= 75.2%
Test: loss=0.793 , acc= 74.1%
Test: loss=0.787 , acc= 75.0%
Test: loss=0.807 , acc= 74.5%
Test: loss=0.786 , acc= 75.5%
Test: loss=0.808 , acc= 75.1%
Test: loss=0.781 , acc= 76.1%
Test: loss=0.796 , acc= 75.0%
Test: loss=0.780 , acc= 75.1%
Test: loss=0.788 , acc= 74.9%
current testing task:cifar100-3
Test: loss=0.840 , acc= 75.6%
Test: loss=0.832 , acc= 74.9%
Test: loss=0.828 , acc= 75.8%
Test: loss=0.835 , acc= 73.9%
Test: loss=0.823 , acc= 75.2%
Test: loss=0.822 , acc= 75.4%
Test: loss=0.837 , acc= 74.9%
Test: loss=0.831 , acc= 75.2%
Test: loss=0.801 , acc= 76.2%
Test: loss=0.806 , acc= 76.0%
current testing task:cifar100-4
Test: loss=0.766 , acc= 78.4%
Test: loss=0.769 , acc= 79.0%
Test: loss=0.738 , acc= 79.0%
Test: loss=0.769 , acc= 77.9%
Test: loss=0.779 , acc= 76.6%
Test: loss=0.764 , acc= 78.5%
Test: loss=0.773 , acc= 78.5%
Test: loss=0.779 , acc= 78.9%
Test: loss=0.775 , acc= 78.5%
Test: loss=0.776 , acc= 78.2%
Accuracies =
 76.1%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.4%  71.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  70.9%  75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.7%  71.2%  74.5%  74.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.0%  71.0%  75.0%  75.3%  78.3%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  5 (cifar100-5)
****************************************************************************************************
----------------------------------------
Task ID :5 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.8951556019936527, threshold for regime 1:0.4526575803756714
Task:0, layer:1, space shape:(576, 123)
Task:0, Layer:1, project_norm:1.2039006305773683, threshold for regime 1:0.6240047216415405
Task:0, layer:2, space shape:(512, 188)
Task:0, Layer:2, project_norm:1.3777762300958498, threshold for regime 1:0.7182831168174744
Task:0, layer:3, space shape:(1024, 78)
Task:0, Layer:3, project_norm:1.6344441175460815, threshold for regime 1:0.9922518134117126
Task:0, layer:4, space shape:(2048, 96)
Task:0, Layer:4, project_norm:2.2192294597625732, threshold for regime 1:1.4064297676086426
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 10)
Task:1, Layer:0, project_norm:0.8987250112935351, threshold for regime 1:0.4526575803756714
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.2169157405905817, threshold for regime 1:0.6240047216415405
Task:1, layer:2, space shape:(512, 250)
Task:1, Layer:2, project_norm:1.3969336054024928, threshold for regime 1:0.7182831168174744
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.722612977027893, threshold for regime 1:0.9922518134117126
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.3403961658477783, threshold for regime 1:1.4064297676086426
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.8951556019936527, threshold for regime 1:0.4526575803756714
Task:2, layer:1, space shape:(576, 159)
Task:2, Layer:1, project_norm:1.2174092729166326, threshold for regime 1:0.6240047216415405
Task:2, layer:2, space shape:(512, 263)
Task:2, Layer:2, project_norm:1.399595252115867, threshold for regime 1:0.7182831168174744
Task:2, layer:3, space shape:(1024, 204)
Task:2, Layer:3, project_norm:1.7605704069137573, threshold for regime 1:0.9922518134117126
Task:2, layer:4, space shape:(2048, 253)
Task:2, Layer:4, project_norm:2.419764518737793, threshold for regime 1:1.4064297676086426
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.8963936971553804, threshold for regime 1:0.4526575803756714
Task:3, layer:1, space shape:(576, 167)
Task:3, Layer:1, project_norm:1.220039786230536, threshold for regime 1:0.6240047216415405
Task:3, layer:2, space shape:(512, 275)
Task:3, Layer:2, project_norm:1.4021641203736561, threshold for regime 1:0.7182831168174744
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.7968471050262451, threshold for regime 1:0.9922518134117126
Task:3, layer:4, space shape:(2048, 351)
Task:3, Layer:4, project_norm:2.482450246810913, threshold for regime 1:1.4064297676086426
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 11)
Task:4, Layer:0, project_norm:0.8989829773225375, threshold for regime 1:0.4526575803756714
Task:4, layer:1, space shape:(576, 184)
Task:4, Layer:1, project_norm:1.2244273866915465, threshold for regime 1:0.6240047216415405
Task:4, layer:2, space shape:(512, 286)
Task:4, Layer:2, project_norm:1.404431943193204, threshold for regime 1:0.7182831168174744
Task:4, layer:3, space shape:(1024, 335)
Task:4, Layer:3, project_norm:1.8266301155090332, threshold for regime 1:0.9922518134117126
Task:4, layer:4, space shape:(2048, 447)
Task:4, Layer:4, project_norm:2.5263490676879883, threshold for regime 1:1.4064297676086426
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[1 4]
Layer:1, selected task ID:[3 4]
Layer:2, selected task ID:[3 4]
Layer:3, selected task ID:[3 4]
Layer:4, selected task ID:[3 4]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.736 , acc= 75.8%
Test: loss=0.721 , acc= 77.1%
Test: loss=0.707 , acc= 77.9%
Test: loss=0.719 , acc= 77.9%
Test: loss=0.724 , acc= 75.5%
Test: loss=0.714 , acc= 76.8%
Test: loss=0.720 , acc= 76.3%
Test: loss=0.739 , acc= 76.1%
Test: loss=0.717 , acc= 76.8%
Test: loss=0.722 , acc= 77.2%
Average acc= 76.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:31712.901916981504
total ranking r = 10
the number of space for current task:10
the new increased space:0, the threshold for new space:10
Ui shape:(48, 10)
activation shape:(576, 14400)
space shape:(576, 185)
threshold for selecting:202218.0106616077
total ranking r = 182
the number of space for current task:182
the new increased space:6, the threshold for new space:185
Ui shape:(576, 182)
activation shape:(512, 2500)
space shape:(512, 337)
threshold for selecting:27206.487609385706
total ranking r = 291
the number of space for current task:291
the new increased space:16, the threshold for new space:337
Ui shape:(512, 291)
activation shape:(1024, 125)
space shape:(1024, 448)
threshold for selecting:10345.32432626473
total ranking r = 409
the number of space for current task:409
the new increased space:98, the threshold for new space:448
Ui shape:(1024, 409)
activation shape:(2048, 125)
space shape:(2048, 574)
threshold for selecting:22130.580130784074
total ranking r = 550
the number of space for current task:550
the new increased space:122, the threshold for new space:574
Ui shape:(2048, 550)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.827 , acc= 77.1%
Test: loss=0.769 , acc= 77.9%
Test: loss=0.802 , acc= 77.8%
Test: loss=0.831 , acc= 76.8%
Test: loss=0.769 , acc= 78.1%
Test: loss=0.810 , acc= 76.3%
Test: loss=0.832 , acc= 77.0%
Test: loss=0.819 , acc= 77.1%
Test: loss=0.833 , acc= 76.5%
Test: loss=0.803 , acc= 76.5%
current testing task:cifar100-1
Test: loss=1.019 , acc= 71.2%
Test: loss=0.995 , acc= 71.0%
Test: loss=0.963 , acc= 71.7%
Test: loss=0.979 , acc= 71.5%
Test: loss=0.989 , acc= 71.1%
Test: loss=0.995 , acc= 70.1%
Test: loss=0.998 , acc= 70.0%
Test: loss=1.014 , acc= 71.3%
Test: loss=1.000 , acc= 71.0%
Test: loss=0.988 , acc= 71.7%
current testing task:cifar100-2
Test: loss=0.837 , acc= 73.7%
Test: loss=0.807 , acc= 74.7%
Test: loss=0.808 , acc= 75.7%
Test: loss=0.776 , acc= 75.8%
Test: loss=0.794 , acc= 74.6%
Test: loss=0.789 , acc= 75.7%
Test: loss=0.787 , acc= 75.5%
Test: loss=0.812 , acc= 75.7%
Test: loss=0.796 , acc= 75.3%
Test: loss=0.810 , acc= 75.0%
current testing task:cifar100-3
Test: loss=0.849 , acc= 74.1%
Test: loss=0.824 , acc= 76.0%
Test: loss=0.827 , acc= 74.2%
Test: loss=0.836 , acc= 74.0%
Test: loss=0.839 , acc= 74.6%
Test: loss=0.840 , acc= 74.7%
Test: loss=0.822 , acc= 75.0%
Test: loss=0.837 , acc= 74.6%
Test: loss=0.826 , acc= 74.7%
Test: loss=0.813 , acc= 74.9%
current testing task:cifar100-4
Test: loss=0.773 , acc= 78.4%
Test: loss=0.755 , acc= 79.4%
Test: loss=0.765 , acc= 78.8%
Test: loss=0.763 , acc= 77.2%
Test: loss=0.763 , acc= 78.3%
Test: loss=0.786 , acc= 76.9%
Test: loss=0.780 , acc= 78.0%
Test: loss=0.761 , acc= 78.6%
Test: loss=0.764 , acc= 77.3%
Test: loss=0.781 , acc= 77.9%
current testing task:cifar100-5
Test: loss=0.741 , acc= 76.3%
Test: loss=0.735 , acc= 76.5%
Test: loss=0.714 , acc= 77.3%
Test: loss=0.713 , acc= 76.5%
Test: loss=0.712 , acc= 77.3%
Test: loss=0.692 , acc= 76.7%
Test: loss=0.715 , acc= 76.2%
Test: loss=0.736 , acc= 76.9%
Test: loss=0.703 , acc= 76.8%
Test: loss=0.718 , acc= 76.3%
Accuracies =
 76.1%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.4%  71.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  70.9%  75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.7%  71.2%  74.5%  74.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.0%  71.0%  75.0%  75.3%  78.3%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.1%  71.1%  75.2%  74.7%  78.1%  76.7%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  6 (cifar100-6)
****************************************************************************************************
----------------------------------------
Task ID :6 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.9844332623932104, threshold for regime 1:0.49566203355789185
Task:0, layer:1, space shape:(576, 123)
Task:0, Layer:1, project_norm:1.2527857775019136, threshold for regime 1:0.6486917734146118
Task:0, layer:2, space shape:(512, 188)
Task:0, Layer:2, project_norm:1.4287669973497825, threshold for regime 1:0.7431847453117371
Task:0, layer:3, space shape:(1024, 78)
Task:0, Layer:3, project_norm:1.7245515584945679, threshold for regime 1:1.0344330072402954
Task:0, layer:4, space shape:(2048, 96)
Task:0, Layer:4, project_norm:2.2791285514831543, threshold for regime 1:1.4359147548675537
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 10)
Task:1, Layer:0, project_norm:0.9864542827734828, threshold for regime 1:0.49566203355789185
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.2663078368153515, threshold for regime 1:0.6486917734146118
Task:1, layer:2, space shape:(512, 250)
Task:1, Layer:2, project_norm:1.4482192837480163, threshold for regime 1:0.7431847453117371
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.810561180114746, threshold for regime 1:1.0344330072402954
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.4186928272247314, threshold for regime 1:1.4359147548675537
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.9844332623932104, threshold for regime 1:0.49566203355789185
Task:2, layer:1, space shape:(576, 159)
Task:2, Layer:1, project_norm:1.2671213773101844, threshold for regime 1:0.6486917734146118
Task:2, layer:2, space shape:(512, 263)
Task:2, Layer:2, project_norm:1.4514096994486378, threshold for regime 1:0.7431847453117371
Task:2, layer:3, space shape:(1024, 204)
Task:2, Layer:3, project_norm:1.8527543544769287, threshold for regime 1:1.0344330072402954
Task:2, layer:4, space shape:(2048, 253)
Task:2, Layer:4, project_norm:2.48736834526062, threshold for regime 1:1.4359147548675537
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.9850613233924728, threshold for regime 1:0.49566203355789185
Task:3, layer:1, space shape:(576, 167)
Task:3, Layer:1, project_norm:1.270026899245221, threshold for regime 1:0.6486917734146118
Task:3, layer:2, space shape:(512, 275)
Task:3, Layer:2, project_norm:1.4539583676975822, threshold for regime 1:0.7431847453117371
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.8891270160675049, threshold for regime 1:1.0344330072402954
Task:3, layer:4, space shape:(2048, 351)
Task:3, Layer:4, project_norm:2.5533318519592285, threshold for regime 1:1.4359147548675537
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 11)
Task:4, Layer:0, project_norm:0.9869665653163483, threshold for regime 1:0.49566203355789185
Task:4, layer:1, space shape:(576, 184)
Task:4, Layer:1, project_norm:1.2756895265169033, threshold for regime 1:0.6486917734146118
Task:4, layer:2, space shape:(512, 286)
Task:4, Layer:2, project_norm:1.4561249881494291, threshold for regime 1:0.7431847453117371
Task:4, layer:3, space shape:(1024, 335)
Task:4, Layer:3, project_norm:1.918075442314148, threshold for regime 1:1.0344330072402954
Task:4, layer:4, space shape:(2048, 447)
Task:4, Layer:4, project_norm:2.6042048931121826, threshold for regime 1:1.4359147548675537
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 10)
Task:5, Layer:0, project_norm:0.986252852655617, threshold for regime 1:0.49566203355789185
Task:5, layer:1, space shape:(576, 182)
Task:5, Layer:1, project_norm:1.2754969452265492, threshold for regime 1:0.6486917734146118
Task:5, layer:2, space shape:(512, 291)
Task:5, Layer:2, project_norm:1.4574849746488336, threshold for regime 1:0.7431847453117371
Task:5, layer:3, space shape:(1024, 409)
Task:5, Layer:3, project_norm:1.9433671236038208, threshold for regime 1:1.0344330072402954
Task:5, layer:4, space shape:(2048, 550)
Task:5, Layer:4, project_norm:2.63737416267395, threshold for regime 1:1.4359147548675537
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[1 4]
Layer:1, selected task ID:[5 4]
Layer:2, selected task ID:[4 5]
Layer:3, selected task ID:[4 5]
Layer:4, selected task ID:[4 5]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.749 , acc= 77.5%
Test: loss=0.733 , acc= 78.2%
Test: loss=0.774 , acc= 77.6%
Test: loss=0.738 , acc= 77.4%
Test: loss=0.735 , acc= 78.0%
Test: loss=0.738 , acc= 78.2%
Test: loss=0.756 , acc= 76.6%
Test: loss=0.764 , acc= 76.0%
Test: loss=0.737 , acc= 77.1%
Test: loss=0.748 , acc= 77.6%
Average acc= 77.4%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:21724.097253963922
total ranking r = 9
the number of space for current task:9
the new increased space:0, the threshold for new space:10
Ui shape:(48, 9)
activation shape:(576, 14400)
space shape:(576, 191)
threshold for selecting:172089.48628205794
total ranking r = 178
the number of space for current task:178
the new increased space:4, the threshold for new space:191
Ui shape:(576, 178)
activation shape:(512, 2500)
space shape:(512, 353)
threshold for selecting:19796.778356279072
total ranking r = 282
the number of space for current task:282
the new increased space:9, the threshold for new space:353
Ui shape:(512, 282)
activation shape:(1024, 125)
space shape:(1024, 546)
threshold for selecting:7219.736447890813
total ranking r = 471
the number of space for current task:471
the new increased space:83, the threshold for new space:546
Ui shape:(1024, 471)
activation shape:(2048, 125)
space shape:(2048, 696)
threshold for selecting:17531.738297998905
total ranking r = 639
the number of space for current task:639
the new increased space:122, the threshold for new space:696
Ui shape:(2048, 639)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.817 , acc= 76.6%
Test: loss=0.822 , acc= 76.2%
Test: loss=0.814 , acc= 76.6%
Test: loss=0.821 , acc= 76.6%
Test: loss=0.806 , acc= 77.4%
Test: loss=0.815 , acc= 76.9%
Test: loss=0.815 , acc= 76.8%
Test: loss=0.807 , acc= 75.6%
Test: loss=0.823 , acc= 76.1%
Test: loss=0.808 , acc= 76.9%
current testing task:cifar100-1
Test: loss=1.014 , acc= 70.2%
Test: loss=0.977 , acc= 71.3%
Test: loss=1.022 , acc= 69.8%
Test: loss=0.978 , acc= 72.0%
Test: loss=0.990 , acc= 71.6%
Test: loss=0.991 , acc= 71.1%
Test: loss=0.966 , acc= 70.8%
Test: loss=1.005 , acc= 70.7%
Test: loss=0.972 , acc= 71.6%
Test: loss=0.983 , acc= 70.7%
current testing task:cifar100-2
Test: loss=0.795 , acc= 74.7%
Test: loss=0.805 , acc= 75.0%
Test: loss=0.766 , acc= 75.5%
Test: loss=0.796 , acc= 75.0%
Test: loss=0.795 , acc= 75.3%
Test: loss=0.779 , acc= 75.7%
Test: loss=0.785 , acc= 75.8%
Test: loss=0.768 , acc= 76.3%
Test: loss=0.781 , acc= 75.0%
Test: loss=0.773 , acc= 75.1%
current testing task:cifar100-3
Test: loss=0.827 , acc= 75.6%
Test: loss=0.830 , acc= 74.3%
Test: loss=0.831 , acc= 74.8%
Test: loss=0.850 , acc= 73.9%
Test: loss=0.858 , acc= 74.9%
Test: loss=0.834 , acc= 74.6%
Test: loss=0.827 , acc= 74.1%
Test: loss=0.853 , acc= 73.7%
Test: loss=0.840 , acc= 74.8%
Test: loss=0.840 , acc= 74.5%
current testing task:cifar100-4
Test: loss=0.764 , acc= 78.0%
Test: loss=0.732 , acc= 77.9%
Test: loss=0.783 , acc= 77.6%
Test: loss=0.772 , acc= 77.8%
Test: loss=0.733 , acc= 79.5%
Test: loss=0.780 , acc= 77.7%
Test: loss=0.759 , acc= 77.6%
Test: loss=0.767 , acc= 78.7%
Test: loss=0.755 , acc= 78.1%
Test: loss=0.754 , acc= 77.6%
current testing task:cifar100-5
Test: loss=0.703 , acc= 76.8%
Test: loss=0.709 , acc= 76.5%
Test: loss=0.710 , acc= 76.9%
Test: loss=0.726 , acc= 76.9%
Test: loss=0.699 , acc= 76.4%
Test: loss=0.721 , acc= 78.3%
Test: loss=0.708 , acc= 77.2%
Test: loss=0.707 , acc= 77.1%
Test: loss=0.707 , acc= 77.0%
Test: loss=0.709 , acc= 77.0%
current testing task:cifar100-6
Test: loss=0.749 , acc= 77.6%
Test: loss=0.770 , acc= 77.3%
Test: loss=0.752 , acc= 76.7%
Test: loss=0.768 , acc= 76.8%
Test: loss=0.762 , acc= 78.1%
Test: loss=0.766 , acc= 76.8%
Test: loss=0.779 , acc= 76.7%
Test: loss=0.783 , acc= 76.7%
Test: loss=0.738 , acc= 77.6%
Test: loss=0.760 , acc= 77.9%
Accuracies =
 76.1%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.4%  71.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  70.9%  75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.7%  71.2%  74.5%  74.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.0%  71.0%  75.0%  75.3%  78.3%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.1%  71.1%  75.2%  74.7%  78.1%  76.7%   0.0%   0.0%   0.0%   0.0%
 76.6%  71.0%  75.3%  74.5%  78.1%  77.0%  77.2%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  7 (cifar100-7)
****************************************************************************************************
----------------------------------------
Task ID :7 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.885486150478682, threshold for regime 1:0.44658589363098145
Task:0, layer:1, space shape:(576, 123)
Task:0, Layer:1, project_norm:1.23689169137334, threshold for regime 1:0.6415326595306396
Task:0, layer:2, space shape:(512, 188)
Task:0, Layer:2, project_norm:1.3989081470428473, threshold for regime 1:0.7289547324180603
Task:0, layer:3, space shape:(1024, 78)
Task:0, Layer:3, project_norm:1.6528730392456055, threshold for regime 1:1.0019515752792358
Task:0, layer:4, space shape:(2048, 96)
Task:0, Layer:4, project_norm:2.2530324459075928, threshold for regime 1:1.4225274324417114
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 10)
Task:1, Layer:0, project_norm:0.8871399028629772, threshold for regime 1:0.44658589363098145
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.2511848718047462, threshold for regime 1:0.6415326595306396
Task:1, layer:2, space shape:(512, 250)
Task:1, Layer:2, project_norm:1.4180531512489338, threshold for regime 1:0.7289547324180603
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.7471483945846558, threshold for regime 1:1.0019515752792358
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.3995015621185303, threshold for regime 1:1.4225274324417114
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.885486150478682, threshold for regime 1:0.44658589363098145
Task:2, layer:1, space shape:(576, 159)
Task:2, Layer:1, project_norm:1.252341724083127, threshold for regime 1:0.6415326595306396
Task:2, layer:2, space shape:(512, 263)
Task:2, Layer:2, project_norm:1.4210564389242173, threshold for regime 1:0.7289547324180603
Task:2, layer:3, space shape:(1024, 204)
Task:2, Layer:3, project_norm:1.7887595891952515, threshold for regime 1:1.0019515752792358
Task:2, layer:4, space shape:(2048, 253)
Task:2, Layer:4, project_norm:2.471972942352295, threshold for regime 1:1.4225274324417114
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.8867857857486863, threshold for regime 1:0.44658589363098145
Task:3, layer:1, space shape:(576, 167)
Task:3, Layer:1, project_norm:1.2547713104181462, threshold for regime 1:0.6415326595306396
Task:3, layer:2, space shape:(512, 275)
Task:3, Layer:2, project_norm:1.4236360254564893, threshold for regime 1:0.7289547324180603
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.8252875804901123, threshold for regime 1:1.0019515752792358
Task:3, layer:4, space shape:(2048, 351)
Task:3, Layer:4, project_norm:2.5306572914123535, threshold for regime 1:1.4225274324417114
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 11)
Task:4, Layer:0, project_norm:0.8884774228044751, threshold for regime 1:0.44658589363098145
Task:4, layer:1, space shape:(576, 184)
Task:4, Layer:1, project_norm:1.2593405443492398, threshold for regime 1:0.6415326595306396
Task:4, layer:2, space shape:(512, 286)
Task:4, Layer:2, project_norm:1.4258814316067014, threshold for regime 1:0.7289547324180603
Task:4, layer:3, space shape:(1024, 335)
Task:4, Layer:3, project_norm:1.8514152765274048, threshold for regime 1:1.0019515752792358
Task:4, layer:4, space shape:(2048, 447)
Task:4, Layer:4, project_norm:2.5769100189208984, threshold for regime 1:1.4225274324417114
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 10)
Task:5, Layer:0, project_norm:0.8873327205241656, threshold for regime 1:0.44658589363098145
Task:5, layer:1, space shape:(576, 182)
Task:5, Layer:1, project_norm:1.2587127098818809, threshold for regime 1:0.6415326595306396
Task:5, layer:2, space shape:(512, 291)
Task:5, Layer:2, project_norm:1.4269817674651804, threshold for regime 1:0.7289547324180603
Task:5, layer:3, space shape:(1024, 409)
Task:5, Layer:3, project_norm:1.8751164674758911, threshold for regime 1:1.0019515752792358
Task:5, layer:4, space shape:(2048, 550)
Task:5, Layer:4, project_norm:2.6097264289855957, threshold for regime 1:1.4225274324417114
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:6, layer:0, space shape:(48, 9)
Task:6, Layer:0, project_norm:0.8861027083182711, threshold for regime 1:0.44658589363098145
Task:6, layer:1, space shape:(576, 178)
Task:6, Layer:1, project_norm:1.2574309945146644, threshold for regime 1:0.6415326595306396
Task:6, layer:2, space shape:(512, 282)
Task:6, Layer:2, project_norm:1.425582572970753, threshold for regime 1:0.7289547324180603
Task:6, layer:3, space shape:(1024, 471)
Task:6, Layer:3, project_norm:1.8969981670379639, threshold for regime 1:1.0019515752792358
Task:6, layer:4, space shape:(2048, 639)
Task:6, Layer:4, project_norm:2.6396706104278564, threshold for regime 1:1.4225274324417114
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[5 4]
Layer:1, selected task ID:[5 4]
Layer:2, selected task ID:[4 5]
Layer:3, selected task ID:[5 6]
Layer:4, selected task ID:[5 6]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.801 , acc= 75.3%
Test: loss=0.797 , acc= 75.6%
Test: loss=0.826 , acc= 75.2%
Test: loss=0.817 , acc= 75.4%
Test: loss=0.812 , acc= 75.3%
Test: loss=0.818 , acc= 74.9%
Test: loss=0.803 , acc= 74.1%
Test: loss=0.810 , acc= 75.1%
Test: loss=0.797 , acc= 74.5%
Test: loss=0.807 , acc= 75.3%
Average acc= 75.1%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:19578.03376883855
total ranking r = 8
the number of space for current task:8
the new increased space:0, the threshold for new space:10
Ui shape:(48, 8)
activation shape:(576, 14400)
space shape:(576, 195)
threshold for selecting:193941.37323508624
total ranking r = 187
the number of space for current task:187
the new increased space:4, the threshold for new space:195
Ui shape:(576, 187)
activation shape:(512, 2500)
space shape:(512, 362)
threshold for selecting:20027.5799315872
total ranking r = 293
the number of space for current task:293
the new increased space:8, the threshold for new space:362
Ui shape:(512, 293)
activation shape:(1024, 125)
space shape:(1024, 629)
threshold for selecting:6110.598710575141
total ranking r = 540
the number of space for current task:540
the new increased space:80, the threshold for new space:629
Ui shape:(1024, 540)
activation shape:(2048, 125)
space shape:(2048, 818)
threshold for selecting:15887.004988735134
total ranking r = 755
the number of space for current task:755
the new increased space:122, the threshold for new space:818
Ui shape:(2048, 755)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.801 , acc= 76.7%
Test: loss=0.787 , acc= 76.7%
Test: loss=0.829 , acc= 77.5%
Test: loss=0.789 , acc= 77.3%
Test: loss=0.818 , acc= 77.3%
Test: loss=0.815 , acc= 76.8%
Test: loss=0.819 , acc= 77.6%
Test: loss=0.824 , acc= 75.7%
Test: loss=0.820 , acc= 77.2%
Test: loss=0.813 , acc= 76.9%
current testing task:cifar100-1
Test: loss=1.004 , acc= 71.0%
Test: loss=1.044 , acc= 69.6%
Test: loss=1.014 , acc= 70.6%
Test: loss=1.000 , acc= 71.3%
Test: loss=1.020 , acc= 70.5%
Test: loss=1.004 , acc= 70.7%
Test: loss=1.012 , acc= 70.7%
Test: loss=1.025 , acc= 70.0%
Test: loss=1.019 , acc= 69.6%
Test: loss=0.997 , acc= 70.6%
current testing task:cifar100-2
Test: loss=0.784 , acc= 76.1%
Test: loss=0.778 , acc= 76.7%
Test: loss=0.782 , acc= 75.8%
Test: loss=0.804 , acc= 75.1%
Test: loss=0.784 , acc= 75.4%
Test: loss=0.769 , acc= 76.2%
Test: loss=0.791 , acc= 75.6%
Test: loss=0.783 , acc= 75.4%
Test: loss=0.773 , acc= 76.3%
Test: loss=0.792 , acc= 75.7%
current testing task:cifar100-3
Test: loss=0.836 , acc= 73.9%
Test: loss=0.859 , acc= 73.9%
Test: loss=0.848 , acc= 74.6%
Test: loss=0.844 , acc= 73.8%
Test: loss=0.820 , acc= 74.2%
Test: loss=0.837 , acc= 73.9%
Test: loss=0.812 , acc= 74.6%
Test: loss=0.853 , acc= 73.8%
Test: loss=0.829 , acc= 75.0%
Test: loss=0.846 , acc= 74.6%
current testing task:cifar100-4
Test: loss=0.767 , acc= 79.0%
Test: loss=0.777 , acc= 78.3%
Test: loss=0.757 , acc= 78.9%
Test: loss=0.766 , acc= 78.8%
Test: loss=0.777 , acc= 77.8%
Test: loss=0.743 , acc= 77.8%
Test: loss=0.752 , acc= 78.7%
Test: loss=0.743 , acc= 78.0%
Test: loss=0.764 , acc= 77.3%
Test: loss=0.765 , acc= 78.3%
current testing task:cifar100-5
Test: loss=0.722 , acc= 77.7%
Test: loss=0.715 , acc= 76.3%
Test: loss=0.696 , acc= 77.6%
Test: loss=0.721 , acc= 77.5%
Test: loss=0.695 , acc= 77.7%
Test: loss=0.698 , acc= 76.8%
Test: loss=0.702 , acc= 77.3%
Test: loss=0.722 , acc= 75.2%
Test: loss=0.710 , acc= 75.6%
Test: loss=0.717 , acc= 76.1%
current testing task:cifar100-6
Test: loss=0.781 , acc= 76.5%
Test: loss=0.739 , acc= 78.2%
Test: loss=0.755 , acc= 76.2%
Test: loss=0.779 , acc= 77.1%
Test: loss=0.739 , acc= 77.2%
Test: loss=0.736 , acc= 77.6%
Test: loss=0.772 , acc= 76.9%
Test: loss=0.758 , acc= 77.0%
Test: loss=0.739 , acc= 77.3%
Test: loss=0.742 , acc= 77.3%
current testing task:cifar100-7
Test: loss=0.812 , acc= 75.1%
Test: loss=0.809 , acc= 75.1%
Test: loss=0.812 , acc= 75.5%
Test: loss=0.830 , acc= 75.6%
Test: loss=0.816 , acc= 74.6%
Test: loss=0.789 , acc= 76.1%
Test: loss=0.809 , acc= 75.5%
Test: loss=0.807 , acc= 76.0%
Test: loss=0.793 , acc= 74.8%
Test: loss=0.773 , acc= 75.7%
Accuracies =
 76.1%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.4%  71.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  70.9%  75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.7%  71.2%  74.5%  74.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.0%  71.0%  75.0%  75.3%  78.3%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.1%  71.1%  75.2%  74.7%  78.1%  76.7%   0.0%   0.0%   0.0%   0.0%
 76.6%  71.0%  75.3%  74.5%  78.1%  77.0%  77.2%   0.0%   0.0%   0.0%
 77.0%  70.5%  75.8%  74.2%  78.3%  76.8%  77.1%  75.4%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  8 (cifar100-8)
****************************************************************************************************
----------------------------------------
Task ID :8 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.7038021338791106, threshold for regime 1:0.360022634267807
Task:0, layer:1, space shape:(576, 123)
Task:0, Layer:1, project_norm:1.2012580659484542, threshold for regime 1:0.6324713230133057
Task:0, layer:2, space shape:(512, 188)
Task:0, Layer:2, project_norm:1.3348375821672143, threshold for regime 1:0.7031971216201782
Task:0, layer:3, space shape:(1024, 78)
Task:0, Layer:3, project_norm:1.6165207624435425, threshold for regime 1:0.9939225912094116
Task:0, layer:4, space shape:(2048, 96)
Task:0, Layer:4, project_norm:2.3034605979919434, threshold for regime 1:1.4415867328643799
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 10)
Task:1, Layer:0, project_norm:0.7086014155151162, threshold for regime 1:0.360022634267807
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.2211403956782156, threshold for regime 1:0.6324713230133057
Task:1, layer:2, space shape:(512, 250)
Task:1, Layer:2, project_norm:1.3573818376641344, threshold for regime 1:0.7031971216201782
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.707552194595337, threshold for regime 1:0.9939225912094116
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.4227092266082764, threshold for regime 1:1.4415867328643799
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.7038021338791106, threshold for regime 1:0.360022634267807
Task:2, layer:1, space shape:(576, 159)
Task:2, Layer:1, project_norm:1.2223426398724815, threshold for regime 1:0.6324713230133057
Task:2, layer:2, space shape:(512, 263)
Task:2, Layer:2, project_norm:1.3608741605454895, threshold for regime 1:0.7031971216201782
Task:2, layer:3, space shape:(1024, 204)
Task:2, Layer:3, project_norm:1.7517147064208984, threshold for regime 1:0.9939225912094116
Task:2, layer:4, space shape:(2048, 253)
Task:2, Layer:4, project_norm:2.4938879013061523, threshold for regime 1:1.4415867328643799
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.7055275037175381, threshold for regime 1:0.360022634267807
Task:3, layer:1, space shape:(576, 167)
Task:3, Layer:1, project_norm:1.2260721109807937, threshold for regime 1:0.6324713230133057
Task:3, layer:2, space shape:(512, 275)
Task:3, Layer:2, project_norm:1.3639861548593786, threshold for regime 1:0.7031971216201782
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.7896435260772705, threshold for regime 1:0.9939225912094116
Task:3, layer:4, space shape:(2048, 351)
Task:3, Layer:4, project_norm:2.555548667907715, threshold for regime 1:1.4415867328643799
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 11)
Task:4, Layer:0, project_norm:0.7097243300499708, threshold for regime 1:0.360022634267807
Task:4, layer:1, space shape:(576, 184)
Task:4, Layer:1, project_norm:1.2332042811849395, threshold for regime 1:0.6324713230133057
Task:4, layer:2, space shape:(512, 286)
Task:4, Layer:2, project_norm:1.3674656675826757, threshold for regime 1:0.7031971216201782
Task:4, layer:3, space shape:(1024, 335)
Task:4, Layer:3, project_norm:1.8198994398117065, threshold for regime 1:0.9939225912094116
Task:4, layer:4, space shape:(2048, 447)
Task:4, Layer:4, project_norm:2.5938878059387207, threshold for regime 1:1.4415867328643799
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 10)
Task:5, Layer:0, project_norm:0.7098980023049234, threshold for regime 1:0.360022634267807
Task:5, layer:1, space shape:(576, 182)
Task:5, Layer:1, project_norm:1.2329196622553242, threshold for regime 1:0.6324713230133057
Task:5, layer:2, space shape:(512, 291)
Task:5, Layer:2, project_norm:1.3688264217412542, threshold for regime 1:0.7031971216201782
Task:5, layer:3, space shape:(1024, 409)
Task:5, Layer:3, project_norm:1.8464425802230835, threshold for regime 1:0.9939225912094116
Task:5, layer:4, space shape:(2048, 550)
Task:5, Layer:4, project_norm:2.635891914367676, threshold for regime 1:1.4415867328643799
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:6, layer:0, space shape:(48, 9)
Task:6, Layer:0, project_norm:0.7077345365258481, threshold for regime 1:0.360022634267807
Task:6, layer:1, space shape:(576, 178)
Task:6, Layer:1, project_norm:1.2309875231957441, threshold for regime 1:0.6324713230133057
Task:6, layer:2, space shape:(512, 282)
Task:6, Layer:2, project_norm:1.3666008301253079, threshold for regime 1:0.7031971216201782
Task:6, layer:3, space shape:(1024, 471)
Task:6, Layer:3, project_norm:1.8669555187225342, threshold for regime 1:0.9939225912094116
Task:6, layer:4, space shape:(2048, 639)
Task:6, Layer:4, project_norm:2.6622369289398193, threshold for regime 1:1.4415867328643799
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:7, layer:0, space shape:(48, 8)
Task:7, Layer:0, project_norm:0.7038021338791106, threshold for regime 1:0.360022634267807
Task:7, layer:1, space shape:(576, 187)
Task:7, Layer:1, project_norm:1.2344333220281223, threshold for regime 1:0.6324713230133057
Task:7, layer:2, space shape:(512, 293)
Task:7, Layer:2, project_norm:1.369599822844655, threshold for regime 1:0.7031971216201782
Task:7, layer:3, space shape:(1024, 540)
Task:7, Layer:3, project_norm:1.8872102499008179, threshold for regime 1:0.9939225912094116
Task:7, layer:4, space shape:(2048, 755)
Task:7, Layer:4, project_norm:2.691894292831421, threshold for regime 1:1.4415867328643799
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[4 5]
Layer:1, selected task ID:[4 7]
Layer:2, selected task ID:[5 7]
Layer:3, selected task ID:[6 7]
Layer:4, selected task ID:[6 7]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.783 , acc= 77.4%
Test: loss=0.772 , acc= 76.6%
Test: loss=0.783 , acc= 78.0%
Test: loss=0.784 , acc= 77.5%
Test: loss=0.752 , acc= 78.0%
Test: loss=0.768 , acc= 77.2%
Test: loss=0.784 , acc= 77.9%
Test: loss=0.774 , acc= 77.8%
Test: loss=0.786 , acc= 76.2%
Test: loss=0.790 , acc= 77.2%
Average acc= 77.4%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:31923.954387492777
total ranking r = 11
the number of space for current task:11
the new increased space:1, the threshold for new space:10
Ui shape:(48, 11)
activation shape:(576, 14400)
space shape:(576, 199)
threshold for selecting:214545.64636722297
total ranking r = 200
the number of space for current task:200
the new increased space:5, the threshold for new space:199
Ui shape:(576, 200)
activation shape:(512, 2500)
space shape:(512, 370)
threshold for selecting:21988.54642271514
total ranking r = 309
the number of space for current task:309
the new increased space:9, the threshold for new space:370
Ui shape:(512, 309)
activation shape:(1024, 125)
space shape:(1024, 709)
threshold for selecting:5149.681863318256
total ranking r = 603
the number of space for current task:603
the new increased space:76, the threshold for new space:709
Ui shape:(1024, 603)
activation shape:(2048, 125)
space shape:(2048, 940)
threshold for selecting:14670.86086743098
total ranking r = 861
the number of space for current task:861
the new increased space:123, the threshold for new space:940
Ui shape:(2048, 861)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.811 , acc= 76.6%
Test: loss=0.804 , acc= 77.1%
Test: loss=0.781 , acc= 78.0%
Test: loss=0.821 , acc= 75.7%
Test: loss=0.802 , acc= 77.2%
Test: loss=0.812 , acc= 76.5%
Test: loss=0.823 , acc= 76.6%
Test: loss=0.808 , acc= 77.6%
Test: loss=0.826 , acc= 76.2%
Test: loss=0.801 , acc= 77.6%
current testing task:cifar100-1
Test: loss=0.983 , acc= 70.9%
Test: loss=0.992 , acc= 71.1%
Test: loss=1.018 , acc= 70.4%
Test: loss=0.990 , acc= 70.9%
Test: loss=0.979 , acc= 70.5%
Test: loss=1.009 , acc= 71.4%
Test: loss=0.999 , acc= 70.5%
Test: loss=1.038 , acc= 70.9%
Test: loss=0.984 , acc= 70.6%
Test: loss=0.986 , acc= 71.8%
current testing task:cifar100-2
Test: loss=0.796 , acc= 75.6%
Test: loss=0.794 , acc= 75.6%
Test: loss=0.796 , acc= 75.4%
Test: loss=0.782 , acc= 75.9%
Test: loss=0.794 , acc= 76.1%
Test: loss=0.788 , acc= 75.6%
Test: loss=0.785 , acc= 75.5%
Test: loss=0.806 , acc= 76.2%
Test: loss=0.776 , acc= 76.0%
Test: loss=0.784 , acc= 75.4%
current testing task:cifar100-3
Test: loss=0.850 , acc= 73.9%
Test: loss=0.819 , acc= 75.6%
Test: loss=0.812 , acc= 75.5%
Test: loss=0.825 , acc= 74.8%
Test: loss=0.842 , acc= 74.9%
Test: loss=0.811 , acc= 75.6%
Test: loss=0.852 , acc= 74.1%
Test: loss=0.831 , acc= 75.2%
Test: loss=0.840 , acc= 75.2%
Test: loss=0.826 , acc= 73.7%
current testing task:cifar100-4
Test: loss=0.753 , acc= 78.3%
Test: loss=0.776 , acc= 77.2%
Test: loss=0.766 , acc= 77.7%
Test: loss=0.746 , acc= 77.8%
Test: loss=0.746 , acc= 77.8%
Test: loss=0.728 , acc= 78.6%
Test: loss=0.768 , acc= 78.4%
Test: loss=0.745 , acc= 78.9%
Test: loss=0.771 , acc= 77.5%
Test: loss=0.733 , acc= 78.2%
current testing task:cifar100-5
Test: loss=0.690 , acc= 77.6%
Test: loss=0.697 , acc= 76.3%
Test: loss=0.721 , acc= 76.6%
Test: loss=0.705 , acc= 76.1%
Test: loss=0.708 , acc= 76.0%
Test: loss=0.723 , acc= 75.9%
Test: loss=0.728 , acc= 76.4%
Test: loss=0.714 , acc= 76.3%
Test: loss=0.693 , acc= 76.3%
Test: loss=0.703 , acc= 77.3%
current testing task:cifar100-6
Test: loss=0.721 , acc= 77.4%
Test: loss=0.770 , acc= 77.0%
Test: loss=0.730 , acc= 78.2%
Test: loss=0.759 , acc= 77.3%
Test: loss=0.767 , acc= 76.7%
Test: loss=0.738 , acc= 76.7%
Test: loss=0.775 , acc= 76.4%
Test: loss=0.765 , acc= 76.8%
Test: loss=0.750 , acc= 77.8%
Test: loss=0.745 , acc= 78.0%
current testing task:cifar100-7
Test: loss=0.830 , acc= 73.7%
Test: loss=0.822 , acc= 75.2%
Test: loss=0.795 , acc= 75.0%
Test: loss=0.830 , acc= 74.4%
Test: loss=0.794 , acc= 76.0%
Test: loss=0.794 , acc= 75.1%
Test: loss=0.814 , acc= 75.0%
Test: loss=0.771 , acc= 76.3%
Test: loss=0.783 , acc= 75.4%
Test: loss=0.797 , acc= 75.0%
current testing task:cifar100-8
Test: loss=0.789 , acc= 76.6%
Test: loss=0.784 , acc= 78.0%
Test: loss=0.791 , acc= 77.1%
Test: loss=0.771 , acc= 76.7%
Test: loss=0.796 , acc= 77.0%
Test: loss=0.784 , acc= 76.8%
Test: loss=0.793 , acc= 77.6%
Test: loss=0.783 , acc= 76.9%
Test: loss=0.789 , acc= 77.0%
Test: loss=0.778 , acc= 77.4%
Accuracies =
 76.1%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.4%  71.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  70.9%  75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.7%  71.2%  74.5%  74.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.0%  71.0%  75.0%  75.3%  78.3%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.1%  71.1%  75.2%  74.7%  78.1%  76.7%   0.0%   0.0%   0.0%   0.0%
 76.6%  71.0%  75.3%  74.5%  78.1%  77.0%  77.2%   0.0%   0.0%   0.0%
 77.0%  70.5%  75.8%  74.2%  78.3%  76.8%  77.1%  75.4%   0.0%   0.0%
 76.9%  70.9%  75.7%  74.9%  78.0%  76.5%  77.2%  75.1%  77.1%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  9 (cifar100-9)
****************************************************************************************************
----------------------------------------
Task ID :9 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.7432060659496612, threshold for regime 1:0.3758794069290161
Task:0, layer:1, space shape:(576, 123)
Task:0, Layer:1, project_norm:1.220968346102003, threshold for regime 1:0.6364935040473938
Task:0, layer:2, space shape:(512, 188)
Task:0, Layer:2, project_norm:1.3758680941877002, threshold for regime 1:0.7199464440345764
Task:0, layer:3, space shape:(1024, 78)
Task:0, Layer:3, project_norm:1.6680669784545898, threshold for regime 1:1.008716106414795
Task:0, layer:4, space shape:(2048, 96)
Task:0, Layer:4, project_norm:2.375197649002075, threshold for regime 1:1.461767554283142
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 10)
Task:1, Layer:0, project_norm:0.7451388255763395, threshold for regime 1:0.3758794069290161
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.237529249856101, threshold for regime 1:0.6364935040473938
Task:1, layer:2, space shape:(512, 250)
Task:1, Layer:2, project_norm:1.3968023805956766, threshold for regime 1:0.7199464440345764
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.754015326499939, threshold for regime 1:1.008716106414795
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.485245704650879, threshold for regime 1:1.461767554283142
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.7432060659496612, threshold for regime 1:0.3758794069290161
Task:2, layer:1, space shape:(576, 159)
Task:2, Layer:1, project_norm:1.2390183880751495, threshold for regime 1:0.6364935040473938
Task:2, layer:2, space shape:(512, 263)
Task:2, Layer:2, project_norm:1.4000497569285233, threshold for regime 1:0.7199464440345764
Task:2, layer:3, space shape:(1024, 204)
Task:2, Layer:3, project_norm:1.7956141233444214, threshold for regime 1:1.008716106414795
Task:2, layer:4, space shape:(2048, 253)
Task:2, Layer:4, project_norm:2.5583932399749756, threshold for regime 1:1.461767554283142
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.7444985406279864, threshold for regime 1:0.3758794069290161
Task:3, layer:1, space shape:(576, 167)
Task:3, Layer:1, project_norm:1.2415607454760007, threshold for regime 1:0.6364935040473938
Task:3, layer:2, space shape:(512, 275)
Task:3, Layer:2, project_norm:1.402855867715072, threshold for regime 1:0.7199464440345764
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.8336783647537231, threshold for regime 1:1.008716106414795
Task:3, layer:4, space shape:(2048, 351)
Task:3, Layer:4, project_norm:2.6207799911499023, threshold for regime 1:1.461767554283142
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 11)
Task:4, Layer:0, project_norm:0.745969948877979, threshold for regime 1:0.3758794069290161
Task:4, layer:1, space shape:(576, 184)
Task:4, Layer:1, project_norm:1.2472424535493611, threshold for regime 1:0.6364935040473938
Task:4, layer:2, space shape:(512, 286)
Task:4, Layer:2, project_norm:1.4055119033978667, threshold for regime 1:0.7199464440345764
Task:4, layer:3, space shape:(1024, 335)
Task:4, Layer:3, project_norm:1.8621904850006104, threshold for regime 1:1.008716106414795
Task:4, layer:4, space shape:(2048, 447)
Task:4, Layer:4, project_norm:2.6583023071289062, threshold for regime 1:1.461767554283142
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 10)
Task:5, Layer:0, project_norm:0.7453101689102866, threshold for regime 1:0.3758794069290161
Task:5, layer:1, space shape:(576, 182)
Task:5, Layer:1, project_norm:1.2471174667561615, threshold for regime 1:0.6364935040473938
Task:5, layer:2, space shape:(512, 291)
Task:5, Layer:2, project_norm:1.406656742685197, threshold for regime 1:0.7199464440345764
Task:5, layer:3, space shape:(1024, 409)
Task:5, Layer:3, project_norm:1.8886042833328247, threshold for regime 1:1.008716106414795
Task:5, layer:4, space shape:(2048, 550)
Task:5, Layer:4, project_norm:2.6981282234191895, threshold for regime 1:1.461767554283142
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:6, layer:0, space shape:(48, 9)
Task:6, Layer:0, project_norm:0.744353872707563, threshold for regime 1:0.3758794069290161
Task:6, layer:1, space shape:(576, 178)
Task:6, Layer:1, project_norm:1.245707760255154, threshold for regime 1:0.6364935040473938
Task:6, layer:2, space shape:(512, 282)
Task:6, Layer:2, project_norm:1.4049603766209726, threshold for regime 1:0.7199464440345764
Task:6, layer:3, space shape:(1024, 471)
Task:6, Layer:3, project_norm:1.9095088243484497, threshold for regime 1:1.008716106414795
Task:6, layer:4, space shape:(2048, 639)
Task:6, Layer:4, project_norm:2.7295382022857666, threshold for regime 1:1.461767554283142
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:7, layer:0, space shape:(48, 8)
Task:7, Layer:0, project_norm:0.7432060659496612, threshold for regime 1:0.3758794069290161
Task:7, layer:1, space shape:(576, 187)
Task:7, Layer:1, project_norm:1.2483905202744798, threshold for regime 1:0.6364935040473938
Task:7, layer:2, space shape:(512, 293)
Task:7, Layer:2, project_norm:1.4076162560620114, threshold for regime 1:0.7199464440345764
Task:7, layer:3, space shape:(1024, 540)
Task:7, Layer:3, project_norm:1.9273960590362549, threshold for regime 1:1.008716106414795
Task:7, layer:4, space shape:(2048, 755)
Task:7, Layer:4, project_norm:2.7559971809387207, threshold for regime 1:1.461767554283142
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:8, layer:0, space shape:(48, 11)
Task:8, Layer:0, project_norm:0.7462834768388429, threshold for regime 1:0.3758794069290161
Task:8, layer:1, space shape:(576, 200)
Task:8, Layer:1, project_norm:1.2515988678316399, threshold for regime 1:0.6364935040473938
Task:8, layer:2, space shape:(512, 309)
Task:8, Layer:2, project_norm:1.4113917915245051, threshold for regime 1:0.7199464440345764
Task:8, layer:3, space shape:(1024, 603)
Task:8, Layer:3, project_norm:1.9429494142532349, threshold for regime 1:1.008716106414795
Task:8, layer:4, space shape:(2048, 861)
Task:8, Layer:4, project_norm:2.777400016784668, threshold for regime 1:1.461767554283142
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[4 8]
Layer:1, selected task ID:[7 8]
Layer:2, selected task ID:[7 8]
Layer:3, selected task ID:[7 8]
Layer:4, selected task ID:[7 8]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.667 , acc= 79.4%
Test: loss=0.614 , acc= 80.1%
Test: loss=0.639 , acc= 80.4%
Test: loss=0.635 , acc= 80.8%
Test: loss=0.631 , acc= 79.8%
Test: loss=0.611 , acc= 81.6%
Test: loss=0.621 , acc= 80.4%
Test: loss=0.627 , acc= 79.7%
Test: loss=0.626 , acc= 80.6%
Test: loss=0.611 , acc= 80.5%
Average acc= 80.3%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 11)
threshold for selecting:17447.23499628091
total ranking r = 8
the number of space for current task:8
the new increased space:0, the threshold for new space:11
Ui shape:(48, 8)
activation shape:(576, 14400)
space shape:(576, 204)
threshold for selecting:183267.625777038
total ranking r = 194
the number of space for current task:194
the new increased space:1, the threshold for new space:204
Ui shape:(576, 194)
activation shape:(512, 2500)
space shape:(512, 379)
threshold for selecting:17854.080008911013
total ranking r = 301
the number of space for current task:301
the new increased space:5, the threshold for new space:379
Ui shape:(512, 301)
activation shape:(1024, 125)
space shape:(1024, 785)
threshold for selecting:3541.05898328271
total ranking r = 643
the number of space for current task:643
the new increased space:59, the threshold for new space:785
Ui shape:(1024, 643)
activation shape:(2048, 125)
space shape:(2048, 1063)
threshold for selecting:11643.006342169887
total ranking r = 951
the number of space for current task:951
the new increased space:120, the threshold for new space:1063
Ui shape:(2048, 951)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.820 , acc= 77.2%
Test: loss=0.788 , acc= 76.5%
Test: loss=0.789 , acc= 76.5%
Test: loss=0.801 , acc= 77.4%
Test: loss=0.783 , acc= 77.4%
Test: loss=0.809 , acc= 77.0%
Test: loss=0.819 , acc= 76.2%
Test: loss=0.803 , acc= 77.0%
Test: loss=0.794 , acc= 77.2%
Test: loss=0.790 , acc= 76.4%
current testing task:cifar100-1
Test: loss=0.985 , acc= 71.5%
Test: loss=1.012 , acc= 71.3%
Test: loss=1.000 , acc= 72.1%
Test: loss=0.983 , acc= 70.7%
Test: loss=1.009 , acc= 70.7%
Test: loss=1.009 , acc= 71.2%
Test: loss=1.000 , acc= 70.3%
Test: loss=0.991 , acc= 72.6%
Test: loss=1.007 , acc= 71.0%
Test: loss=1.005 , acc= 70.2%
current testing task:cifar100-2
Test: loss=0.798 , acc= 75.8%
Test: loss=0.805 , acc= 76.0%
Test: loss=0.774 , acc= 77.0%
Test: loss=0.790 , acc= 76.3%
Test: loss=0.789 , acc= 76.2%
Test: loss=0.770 , acc= 76.0%
Test: loss=0.787 , acc= 76.1%
Test: loss=0.786 , acc= 75.0%
Test: loss=0.779 , acc= 75.6%
Test: loss=0.763 , acc= 76.6%
current testing task:cifar100-3
Test: loss=0.850 , acc= 74.5%
Test: loss=0.841 , acc= 74.4%
Test: loss=0.862 , acc= 74.0%
Test: loss=0.838 , acc= 74.6%
Test: loss=0.810 , acc= 74.8%
Test: loss=0.827 , acc= 75.4%
Test: loss=0.814 , acc= 75.7%
Test: loss=0.821 , acc= 76.7%
Test: loss=0.829 , acc= 74.2%
Test: loss=0.829 , acc= 74.1%
current testing task:cifar100-4
Test: loss=0.744 , acc= 78.6%
Test: loss=0.772 , acc= 78.8%
Test: loss=0.764 , acc= 78.3%
Test: loss=0.747 , acc= 78.8%
Test: loss=0.765 , acc= 78.6%
Test: loss=0.761 , acc= 78.7%
Test: loss=0.778 , acc= 78.2%
Test: loss=0.770 , acc= 77.6%
Test: loss=0.739 , acc= 78.5%
Test: loss=0.748 , acc= 78.8%
current testing task:cifar100-5
Test: loss=0.698 , acc= 77.3%
Test: loss=0.707 , acc= 77.4%
Test: loss=0.696 , acc= 75.9%
Test: loss=0.718 , acc= 77.0%
Test: loss=0.721 , acc= 76.6%
Test: loss=0.713 , acc= 77.3%
Test: loss=0.719 , acc= 76.4%
Test: loss=0.696 , acc= 76.8%
Test: loss=0.681 , acc= 77.5%
Test: loss=0.714 , acc= 77.3%
current testing task:cifar100-6
Test: loss=0.757 , acc= 78.2%
Test: loss=0.756 , acc= 76.5%
Test: loss=0.736 , acc= 77.5%
Test: loss=0.749 , acc= 78.0%
Test: loss=0.740 , acc= 76.5%
Test: loss=0.733 , acc= 77.3%
Test: loss=0.752 , acc= 77.9%
Test: loss=0.764 , acc= 77.6%
Test: loss=0.740 , acc= 77.3%
Test: loss=0.749 , acc= 76.9%
current testing task:cifar100-7
Test: loss=0.793 , acc= 75.2%
Test: loss=0.813 , acc= 75.3%
Test: loss=0.816 , acc= 75.4%
Test: loss=0.810 , acc= 74.2%
Test: loss=0.803 , acc= 75.8%
Test: loss=0.831 , acc= 73.7%
Test: loss=0.794 , acc= 75.8%
Test: loss=0.821 , acc= 75.1%
Test: loss=0.804 , acc= 74.6%
Test: loss=0.824 , acc= 74.3%
current testing task:cifar100-8
Test: loss=0.787 , acc= 76.8%
Test: loss=0.774 , acc= 76.9%
Test: loss=0.789 , acc= 78.2%
Test: loss=0.752 , acc= 77.1%
Test: loss=0.811 , acc= 76.3%
Test: loss=0.791 , acc= 77.2%
Test: loss=0.752 , acc= 76.7%
Test: loss=0.771 , acc= 77.9%
Test: loss=0.777 , acc= 77.0%
Test: loss=0.794 , acc= 76.8%
current testing task:cifar100-9
Test: loss=0.640 , acc= 80.5%
Test: loss=0.648 , acc= 79.4%
Test: loss=0.635 , acc= 80.6%
Test: loss=0.626 , acc= 79.8%
Test: loss=0.630 , acc= 79.9%
Test: loss=0.626 , acc= 80.5%
Test: loss=0.614 , acc= 81.4%
Test: loss=0.643 , acc= 81.0%
Test: loss=0.627 , acc= 79.9%
Test: loss=0.612 , acc= 80.0%
Accuracies =
 76.1%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.4%  71.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  70.9%  75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.7%  71.2%  74.5%  74.2%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.0%  71.0%  75.0%  75.3%  78.3%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.1%  71.1%  75.2%  74.7%  78.1%  76.7%   0.0%   0.0%   0.0%   0.0%
 76.6%  71.0%  75.3%  74.5%  78.1%  77.0%  77.2%   0.0%   0.0%   0.0%
 77.0%  70.5%  75.8%  74.2%  78.3%  76.8%  77.1%  75.4%   0.0%   0.0%
 76.9%  70.9%  75.7%  74.9%  78.0%  76.5%  77.2%  75.1%  77.1%   0.0%
 76.9%  71.2%  76.1%  74.8%  78.5%  77.0%  77.4%  74.9%  77.1%  80.3%
--------------------------------------------------
Task Order : [0 1 2 3 4 5 6 7 8 9]
Final Avg Accuracy: 76.41%
Backward transfer:  0.28%
[Elapsed time = 4414590.8 ms]
--------------------------------------------------
====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=64, gpm_thro=0.97, lr=0.01, lr_factor=2, lr_min=1e-05, lr_patience=6, mixup_alpha=20, mixup_weight=0.0001, momentum=0.9, n_epochs=200, pc_valid=0.05, savename='./log/DFTRGP/', seed=2)
====================================================================================================
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  0 (cifar100-0)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.01
----------------------------------------
Model parameters ---
(0, 'conv1.weight', torch.Size([64, 3, 4, 4]))
(5, 'conv2.weight', torch.Size([128, 64, 3, 3]))
(10, 'conv3.weight', torch.Size([256, 128, 2, 2]))
(15, 'fc1.weight', torch.Size([2048, 1024]))
(20, 'fc2.weight', torch.Size([2048, 2048]))
(25, 'fc3.0.weight', torch.Size([10, 2048]))
(26, 'fc3.1.weight', torch.Size([10, 2048]))
(27, 'fc3.2.weight', torch.Size([10, 2048]))
(28, 'fc3.3.weight', torch.Size([10, 2048]))
(29, 'fc3.4.weight', torch.Size([10, 2048]))
(30, 'fc3.5.weight', torch.Size([10, 2048]))
(31, 'fc3.6.weight', torch.Size([10, 2048]))
(32, 'fc3.7.weight', torch.Size([10, 2048]))
(33, 'fc3.8.weight', torch.Size([10, 2048]))
(34, 'fc3.9.weight', torch.Size([10, 2048]))
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
----------------------------------------
Test: loss=0.853 , acc= 76.8%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.840 , acc= 76.3%
Test: loss=0.857 , acc= 76.0%
Test: loss=0.816 , acc= 76.8%
Test: loss=0.811 , acc= 77.3%
Test: loss=0.852 , acc= 76.6%
Test: loss=0.830 , acc= 77.7%
Test: loss=0.805 , acc= 76.4%
Test: loss=0.876 , acc= 75.2%
Test: loss=0.855 , acc= 74.8%
Test: loss=0.835 , acc= 76.1%
Accuracies =
 76.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  1 (cifar100-1)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 10)
Task:0, Layer:0, project_norm:0.6397462225988373, threshold for regime 1:0.32539841532707214
Task:0, layer:1, space shape:(576, 137)
Task:0, Layer:1, project_norm:1.1027603704158677, threshold for regime 1:0.567752480506897
Task:0, layer:2, space shape:(512, 195)
Task:0, Layer:2, project_norm:1.2837886103524168, threshold for regime 1:0.6704855561256409
Task:0, layer:3, space shape:(1024, 77)
Task:0, Layer:3, project_norm:1.5435363054275513, threshold for regime 1:0.9581751227378845
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.040696620941162, threshold for regime 1:1.310180425643921
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
space1 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.963 , acc= 69.1%
Test: loss=0.985 , acc= 69.2%
Test: loss=0.985 , acc= 70.5%
Test: loss=0.962 , acc= 70.3%
Test: loss=0.979 , acc= 70.3%
Test: loss=0.984 , acc= 69.0%
Test: loss=0.977 , acc= 69.3%
Test: loss=0.953 , acc= 70.6%
Test: loss=0.962 , acc= 69.8%
Test: loss=0.960 , acc= 70.8%
Average acc= 69.9%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:27382.26425717998
total ranking r = 8
the number of space for current task:8
the new increased space:0, the threshold for new space:10
Ui shape:(48, 8)
activation shape:(576, 14400)
space shape:(576, 137)
threshold for selecting:256996.74087801014
total ranking r = 156
the number of space for current task:156
the new increased space:18, the threshold for new space:137
Ui shape:(576, 156)
activation shape:(512, 2500)
space shape:(512, 195)
threshold for selecting:57217.07864473359
total ranking r = 249
the number of space for current task:249
the new increased space:59, the threshold for new space:195
Ui shape:(512, 249)
activation shape:(1024, 125)
space shape:(1024, 77)
threshold for selecting:27712.48991864943
total ranking r = 146
the number of space for current task:146
the new increased space:86, the threshold for new space:77
Ui shape:(1024, 146)
activation shape:(2048, 125)
space shape:(2048, 95)
threshold for selecting:46320.141526239226
total ranking r = 174
the number of space for current task:174
the new increased space:117, the threshold for new space:95
Ui shape:(2048, 174)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.852 , acc= 76.0%
Test: loss=0.823 , acc= 77.3%
Test: loss=0.846 , acc= 77.0%
Test: loss=0.863 , acc= 75.4%
Test: loss=0.865 , acc= 76.0%
Test: loss=0.845 , acc= 77.0%
Test: loss=0.851 , acc= 76.0%
Test: loss=0.854 , acc= 76.8%
Test: loss=0.826 , acc= 76.8%
Test: loss=0.822 , acc= 76.9%
current testing task:cifar100-1
Test: loss=0.982 , acc= 68.8%
Test: loss=0.970 , acc= 69.8%
Test: loss=0.986 , acc= 69.5%
Test: loss=0.955 , acc= 70.2%
Test: loss=0.949 , acc= 69.3%
Test: loss=0.997 , acc= 69.2%
Test: loss=0.964 , acc= 70.2%
Test: loss=0.972 , acc= 69.8%
Test: loss=0.983 , acc= 70.3%
Test: loss=0.970 , acc= 68.3%
Accuracies =
 76.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  2 (cifar100-2)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 10)
Task:0, Layer:0, project_norm:0.7752195689243992, threshold for regime 1:0.3917882442474365
Task:0, layer:1, space shape:(576, 137)
Task:0, Layer:1, project_norm:1.120832491063284, threshold for regime 1:0.5761963129043579
Task:0, layer:2, space shape:(512, 195)
Task:0, Layer:2, project_norm:1.3729444341937347, threshold for regime 1:0.7114517688751221
Task:0, layer:3, space shape:(1024, 77)
Task:0, Layer:3, project_norm:1.6254723072052002, threshold for regime 1:0.9855570793151855
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.197579860687256, threshold for regime 1:1.3807169198989868
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.7725066751241528, threshold for regime 1:0.3917882442474365
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.1258567490164477, threshold for regime 1:0.5761963129043579
Task:1, layer:2, space shape:(512, 249)
Task:1, Layer:2, project_norm:1.386761937107037, threshold for regime 1:0.7114517688751221
Task:1, layer:3, space shape:(1024, 146)
Task:1, Layer:3, project_norm:1.7117106914520264, threshold for regime 1:0.9855570793151855
Task:1, layer:4, space shape:(2048, 174)
Task:1, Layer:4, project_norm:2.308332920074463, threshold for regime 1:1.3807169198989868
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[1 0]
Layer:1, selected task ID:[0 1]
Layer:2, selected task ID:[0 1]
Layer:3, selected task ID:[0 1]
Layer:4, selected task ID:[0 1]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.802 , acc= 75.3%
Test: loss=0.803 , acc= 75.8%
Test: loss=0.811 , acc= 74.5%
Test: loss=0.782 , acc= 75.7%
Test: loss=0.795 , acc= 76.3%
Test: loss=0.797 , acc= 75.1%
Test: loss=0.786 , acc= 75.5%
Test: loss=0.778 , acc= 75.5%
Test: loss=0.793 , acc= 76.6%
Test: loss=0.788 , acc= 76.0%
Average acc= 75.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:19550.83466640197
total ranking r = 8
the number of space for current task:8
the new increased space:0, the threshold for new space:10
Ui shape:(48, 8)
activation shape:(576, 14400)
space shape:(576, 155)
threshold for selecting:221906.9487617481
total ranking r = 157
the number of space for current task:157
the new increased space:10, the threshold for new space:155
Ui shape:(576, 157)
activation shape:(512, 2500)
space shape:(512, 254)
threshold for selecting:39625.978679896216
total ranking r = 261
the number of space for current task:261
the new increased space:34, the threshold for new space:254
Ui shape:(512, 261)
activation shape:(1024, 125)
space shape:(1024, 163)
threshold for selecting:19948.980529401684
total ranking r = 202
the number of space for current task:202
the new increased space:92, the threshold for new space:163
Ui shape:(1024, 202)
activation shape:(2048, 125)
space shape:(2048, 212)
threshold for selecting:35983.009061917895
total ranking r = 257
the number of space for current task:257
the new increased space:121, the threshold for new space:212
Ui shape:(2048, 257)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.861 , acc= 76.1%
Test: loss=0.830 , acc= 77.0%
Test: loss=0.808 , acc= 77.2%
Test: loss=0.853 , acc= 76.7%
Test: loss=0.850 , acc= 76.2%
Test: loss=0.820 , acc= 77.1%
Test: loss=0.886 , acc= 75.5%
Test: loss=0.823 , acc= 77.2%
Test: loss=0.836 , acc= 76.2%
Test: loss=0.863 , acc= 75.9%
current testing task:cifar100-1
Test: loss=0.981 , acc= 69.2%
Test: loss=0.949 , acc= 69.9%
Test: loss=0.961 , acc= 69.7%
Test: loss=0.969 , acc= 69.8%
Test: loss=0.983 , acc= 67.7%
Test: loss=0.957 , acc= 69.9%
Test: loss=0.943 , acc= 70.3%
Test: loss=0.969 , acc= 68.8%
Test: loss=0.980 , acc= 69.2%
Test: loss=0.964 , acc= 69.2%
current testing task:cifar100-2
Test: loss=0.799 , acc= 76.3%
Test: loss=0.789 , acc= 75.6%
Test: loss=0.785 , acc= 75.8%
Test: loss=0.772 , acc= 75.9%
Test: loss=0.799 , acc= 75.4%
Test: loss=0.805 , acc= 75.7%
Test: loss=0.811 , acc= 75.2%
Test: loss=0.800 , acc= 74.9%
Test: loss=0.804 , acc= 75.0%
Test: loss=0.802 , acc= 75.8%
Accuracies =
 76.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.4%  75.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  3 (cifar100-3)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 10)
Task:0, Layer:0, project_norm:0.7968167903484398, threshold for regime 1:0.4023001492023468
Task:0, layer:1, space shape:(576, 137)
Task:0, Layer:1, project_norm:1.1889056085755696, threshold for regime 1:0.6124388575553894
Task:0, layer:2, space shape:(512, 195)
Task:0, Layer:2, project_norm:1.3612367904585814, threshold for regime 1:0.7098367214202881
Task:0, layer:3, space shape:(1024, 77)
Task:0, Layer:3, project_norm:1.6203473806381226, threshold for regime 1:0.9929682612419128
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.051543712615967, threshold for regime 1:1.327951431274414
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.7942007737110084, threshold for regime 1:0.4023001492023468
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.1948133773720262, threshold for regime 1:0.6124388575553894
Task:1, layer:2, space shape:(512, 249)
Task:1, Layer:2, project_norm:1.3776234130595768, threshold for regime 1:0.7098367214202881
Task:1, layer:3, space shape:(1024, 146)
Task:1, Layer:3, project_norm:1.7125638723373413, threshold for regime 1:0.9929682612419128
Task:1, layer:4, space shape:(2048, 174)
Task:1, Layer:4, project_norm:2.178126096725464, threshold for regime 1:1.327951431274414
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.7942007737110084, threshold for regime 1:0.4023001492023468
Task:2, layer:1, space shape:(576, 157)
Task:2, Layer:1, project_norm:1.1948039522281573, threshold for regime 1:0.6124388575553894
Task:2, layer:2, space shape:(512, 261)
Task:2, Layer:2, project_norm:1.3798526368097401, threshold for regime 1:0.7098367214202881
Task:2, layer:3, space shape:(1024, 202)
Task:2, Layer:3, project_norm:1.7537758350372314, threshold for regime 1:0.9929682612419128
Task:2, layer:4, space shape:(2048, 257)
Task:2, Layer:4, project_norm:2.251286029815674, threshold for regime 1:1.327951431274414
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[2 0]
Layer:1, selected task ID:[2 1]
Layer:2, selected task ID:[1 2]
Layer:3, selected task ID:[1 2]
Layer:4, selected task ID:[1 2]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.807 , acc= 75.3%
Test: loss=0.813 , acc= 74.0%
Test: loss=0.814 , acc= 74.6%
Test: loss=0.803 , acc= 75.2%
Test: loss=0.791 , acc= 76.0%
Test: loss=0.817 , acc= 74.6%
Test: loss=0.794 , acc= 75.7%
Test: loss=0.805 , acc= 75.0%
Test: loss=0.815 , acc= 74.1%
Test: loss=0.787 , acc= 73.8%
Average acc= 74.8%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:20791.81933341815
total ranking r = 9
the number of space for current task:9
the new increased space:0, the threshold for new space:10
Ui shape:(48, 9)
activation shape:(576, 14400)
space shape:(576, 165)
threshold for selecting:223038.3120804623
total ranking r = 172
the number of space for current task:172
the new increased space:10, the threshold for new space:165
Ui shape:(576, 172)
activation shape:(512, 2500)
space shape:(512, 288)
threshold for selecting:34105.63478675204
total ranking r = 276
the number of space for current task:276
the new increased space:28, the threshold for new space:288
Ui shape:(512, 276)
activation shape:(1024, 125)
space shape:(1024, 255)
threshold for selecting:15509.314885434287
total ranking r = 270
the number of space for current task:270
the new increased space:100, the threshold for new space:255
Ui shape:(1024, 270)
activation shape:(2048, 125)
space shape:(2048, 333)
threshold for selecting:30511.30871522799
total ranking r = 354
the number of space for current task:354
the new increased space:122, the threshold for new space:333
Ui shape:(2048, 354)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.825 , acc= 76.8%
Test: loss=0.849 , acc= 76.1%
Test: loss=0.839 , acc= 77.0%
Test: loss=0.828 , acc= 77.9%
Test: loss=0.840 , acc= 76.3%
Test: loss=0.846 , acc= 77.2%
Test: loss=0.834 , acc= 76.3%
Test: loss=0.828 , acc= 77.8%
Test: loss=0.849 , acc= 77.2%
Test: loss=0.828 , acc= 76.8%
current testing task:cifar100-1
Test: loss=0.957 , acc= 69.6%
Test: loss=0.948 , acc= 68.9%
Test: loss=0.969 , acc= 69.7%
Test: loss=0.948 , acc= 70.2%
Test: loss=0.962 , acc= 69.9%
Test: loss=0.959 , acc= 70.1%
Test: loss=0.970 , acc= 69.7%
Test: loss=0.964 , acc= 70.0%
Test: loss=0.938 , acc= 71.1%
Test: loss=0.961 , acc= 70.3%
current testing task:cifar100-2
Test: loss=0.800 , acc= 75.2%
Test: loss=0.775 , acc= 76.1%
Test: loss=0.761 , acc= 75.7%
Test: loss=0.791 , acc= 75.6%
Test: loss=0.788 , acc= 75.1%
Test: loss=0.773 , acc= 76.1%
Test: loss=0.771 , acc= 75.3%
Test: loss=0.797 , acc= 74.3%
Test: loss=0.786 , acc= 75.0%
Test: loss=0.787 , acc= 74.5%
current testing task:cifar100-3
Test: loss=0.817 , acc= 74.3%
Test: loss=0.775 , acc= 76.5%
Test: loss=0.800 , acc= 75.2%
Test: loss=0.782 , acc= 76.0%
Test: loss=0.809 , acc= 74.5%
Test: loss=0.794 , acc= 75.0%
Test: loss=0.784 , acc= 75.6%
Test: loss=0.775 , acc= 75.8%
Test: loss=0.799 , acc= 74.7%
Test: loss=0.791 , acc= 76.0%
Accuracies =
 76.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.4%  75.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.3%  75.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  4 (cifar100-4)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 10)
Task:0, Layer:0, project_norm:0.8993790818006447, threshold for regime 1:0.4536600708961487
Task:0, layer:1, space shape:(576, 137)
Task:0, Layer:1, project_norm:1.2631942977347859, threshold for regime 1:0.650047779083252
Task:0, layer:2, space shape:(512, 195)
Task:0, Layer:2, project_norm:1.4313229257203814, threshold for regime 1:0.7429264783859253
Task:0, layer:3, space shape:(1024, 77)
Task:0, Layer:3, project_norm:1.6151163578033447, threshold for regime 1:0.9907858967781067
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.07718563079834, threshold for regime 1:1.3476383686065674
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.8969846656349821, threshold for regime 1:0.4536600708961487
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.2692935056222205, threshold for regime 1:0.650047779083252
Task:1, layer:2, space shape:(512, 249)
Task:1, Layer:2, project_norm:1.4465773798705863, threshold for regime 1:0.7429264783859253
Task:1, layer:3, space shape:(1024, 146)
Task:1, Layer:3, project_norm:1.7083419561386108, threshold for regime 1:0.9907858967781067
Task:1, layer:4, space shape:(2048, 174)
Task:1, Layer:4, project_norm:2.2105700969696045, threshold for regime 1:1.3476383686065674
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.8969846656349821, threshold for regime 1:0.4536600708961487
Task:2, layer:1, space shape:(576, 157)
Task:2, Layer:1, project_norm:1.2700498140569119, threshold for regime 1:0.650047779083252
Task:2, layer:2, space shape:(512, 261)
Task:2, Layer:2, project_norm:1.448864994316667, threshold for regime 1:0.7429264783859253
Task:2, layer:3, space shape:(1024, 202)
Task:2, Layer:3, project_norm:1.7512850761413574, threshold for regime 1:0.9907858967781067
Task:2, layer:4, space shape:(2048, 257)
Task:2, Layer:4, project_norm:2.293394088745117, threshold for regime 1:1.3476383686065674
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.8985019204104864, threshold for regime 1:0.4536600708961487
Task:3, layer:1, space shape:(576, 172)
Task:3, Layer:1, project_norm:1.274083227596482, threshold for regime 1:0.650047779083252
Task:3, layer:2, space shape:(512, 276)
Task:3, Layer:2, project_norm:1.4517038073756778, threshold for regime 1:0.7429264783859253
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.7863622903823853, threshold for regime 1:0.9907858967781067
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.354278802871704, threshold for regime 1:1.3476383686065674
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[3 0]
Layer:1, selected task ID:[2 3]
Layer:2, selected task ID:[2 3]
Layer:3, selected task ID:[2 3]
Layer:4, selected task ID:[2 3]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.818 , acc= 78.5%
Test: loss=0.787 , acc= 78.3%
Test: loss=0.814 , acc= 78.4%
Test: loss=0.797 , acc= 78.5%
Test: loss=0.818 , acc= 78.0%
Test: loss=0.833 , acc= 77.7%
Test: loss=0.848 , acc= 77.3%
Test: loss=0.789 , acc= 78.5%
Test: loss=0.832 , acc= 77.1%
Test: loss=0.841 , acc= 78.3%
Average acc= 78.1%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:30400.56704503558
total ranking r = 9
the number of space for current task:9
the new increased space:0, the threshold for new space:10
Ui shape:(48, 9)
activation shape:(576, 14400)
space shape:(576, 175)
threshold for selecting:239325.26518603327
total ranking r = 182
the number of space for current task:182
the new increased space:7, the threshold for new space:175
Ui shape:(576, 182)
activation shape:(512, 2500)
space shape:(512, 316)
threshold for selecting:30845.154668260024
total ranking r = 287
the number of space for current task:287
the new increased space:24, the threshold for new space:316
Ui shape:(512, 287)
activation shape:(1024, 125)
space shape:(1024, 355)
threshold for selecting:12364.906538956799
total ranking r = 338
the number of space for current task:338
the new increased space:99, the threshold for new space:355
Ui shape:(1024, 338)
activation shape:(2048, 125)
space shape:(2048, 455)
threshold for selecting:25411.296298206784
total ranking r = 453
the number of space for current task:453
the new increased space:123, the threshold for new space:455
Ui shape:(2048, 453)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.819 , acc= 77.0%
Test: loss=0.818 , acc= 76.5%
Test: loss=0.824 , acc= 77.2%
Test: loss=0.837 , acc= 77.3%
Test: loss=0.811 , acc= 77.6%
Test: loss=0.844 , acc= 76.1%
Test: loss=0.833 , acc= 76.3%
Test: loss=0.821 , acc= 76.7%
Test: loss=0.821 , acc= 77.5%
Test: loss=0.804 , acc= 77.0%
current testing task:cifar100-1
Test: loss=0.973 , acc= 69.0%
Test: loss=0.964 , acc= 69.7%
Test: loss=0.989 , acc= 69.9%
Test: loss=0.952 , acc= 70.1%
Test: loss=0.961 , acc= 70.6%
Test: loss=0.951 , acc= 70.3%
Test: loss=0.967 , acc= 70.0%
Test: loss=0.957 , acc= 70.3%
Test: loss=0.981 , acc= 68.7%
Test: loss=0.958 , acc= 70.2%
current testing task:cifar100-2
Test: loss=0.779 , acc= 75.3%
Test: loss=0.791 , acc= 74.8%
Test: loss=0.784 , acc= 75.9%
Test: loss=0.800 , acc= 74.4%
Test: loss=0.802 , acc= 74.7%
Test: loss=0.796 , acc= 74.3%
Test: loss=0.785 , acc= 75.2%
Test: loss=0.776 , acc= 74.5%
Test: loss=0.773 , acc= 76.3%
Test: loss=0.806 , acc= 74.3%
current testing task:cifar100-3
Test: loss=0.810 , acc= 73.9%
Test: loss=0.803 , acc= 75.7%
Test: loss=0.799 , acc= 74.5%
Test: loss=0.795 , acc= 76.5%
Test: loss=0.805 , acc= 76.6%
Test: loss=0.801 , acc= 73.3%
Test: loss=0.796 , acc= 74.0%
Test: loss=0.786 , acc= 74.8%
Test: loss=0.811 , acc= 75.0%
Test: loss=0.826 , acc= 74.5%
current testing task:cifar100-4
Test: loss=0.811 , acc= 77.9%
Test: loss=0.851 , acc= 77.8%
Test: loss=0.811 , acc= 78.3%
Test: loss=0.855 , acc= 77.6%
Test: loss=0.799 , acc= 77.9%
Test: loss=0.863 , acc= 76.9%
Test: loss=0.819 , acc= 77.8%
Test: loss=0.810 , acc= 79.7%
Test: loss=0.797 , acc= 77.5%
Test: loss=0.813 , acc= 78.1%
Accuracies =
 76.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.4%  75.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.3%  75.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.0%  74.9%  78.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  5 (cifar100-5)
****************************************************************************************************
----------------------------------------
Task ID :5 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 10)
Task:0, Layer:0, project_norm:0.7418609415886163, threshold for regime 1:0.37539511919021606
Task:0, layer:1, space shape:(576, 137)
Task:0, Layer:1, project_norm:1.226842697604425, threshold for regime 1:0.6330780982971191
Task:0, layer:2, space shape:(512, 195)
Task:0, Layer:2, project_norm:1.4124516546440335, threshold for regime 1:0.7346014976501465
Task:0, layer:3, space shape:(1024, 77)
Task:0, Layer:3, project_norm:1.6906468868255615, threshold for regime 1:1.0220592021942139
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.1762895584106445, threshold for regime 1:1.3855174779891968
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.7393640872633622, threshold for regime 1:0.37539511919021606
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.2334200285395045, threshold for regime 1:0.6330780982971191
Task:1, layer:2, space shape:(512, 249)
Task:1, Layer:2, project_norm:1.4280083092340576, threshold for regime 1:0.7346014976501465
Task:1, layer:3, space shape:(1024, 146)
Task:1, Layer:3, project_norm:1.78241765499115, threshold for regime 1:1.0220592021942139
Task:1, layer:4, space shape:(2048, 174)
Task:1, Layer:4, project_norm:2.300513982772827, threshold for regime 1:1.3855174779891968
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.7393640872633622, threshold for regime 1:0.37539511919021606
Task:2, layer:1, space shape:(576, 157)
Task:2, Layer:1, project_norm:1.2334290454516195, threshold for regime 1:0.6330780982971191
Task:2, layer:2, space shape:(512, 261)
Task:2, Layer:2, project_norm:1.4301633978253643, threshold for regime 1:0.7346014976501465
Task:2, layer:3, space shape:(1024, 202)
Task:2, Layer:3, project_norm:1.8150324821472168, threshold for regime 1:1.0220592021942139
Task:2, layer:4, space shape:(2048, 257)
Task:2, Layer:4, project_norm:2.369974374771118, threshold for regime 1:1.3855174779891968
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.7406977949751838, threshold for regime 1:0.37539511919021606
Task:3, layer:1, space shape:(576, 172)
Task:3, Layer:1, project_norm:1.2379678928177094, threshold for regime 1:0.6330780982971191
Task:3, layer:2, space shape:(512, 276)
Task:3, Layer:2, project_norm:1.4340331618428541, threshold for regime 1:0.7346014976501465
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.854034662246704, threshold for regime 1:1.0220592021942139
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.4342310428619385, threshold for regime 1:1.3855174779891968
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 9)
Task:4, Layer:0, project_norm:0.7407195378369648, threshold for regime 1:0.37539511919021606
Task:4, layer:1, space shape:(576, 182)
Task:4, Layer:1, project_norm:1.2409204319588891, threshold for regime 1:0.6330780982971191
Task:4, layer:2, space shape:(512, 287)
Task:4, Layer:2, project_norm:1.4362694167884742, threshold for regime 1:0.7346014976501465
Task:4, layer:3, space shape:(1024, 338)
Task:4, Layer:3, project_norm:1.8846220970153809, threshold for regime 1:1.0220592021942139
Task:4, layer:4, space shape:(2048, 453)
Task:4, Layer:4, project_norm:2.4843149185180664, threshold for regime 1:1.3855174779891968
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[4 0]
Layer:1, selected task ID:[3 4]
Layer:2, selected task ID:[3 4]
Layer:3, selected task ID:[3 4]
Layer:4, selected task ID:[3 4]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.683 , acc= 76.6%
Test: loss=0.689 , acc= 76.0%
Test: loss=0.681 , acc= 76.2%
Test: loss=0.699 , acc= 77.2%
Test: loss=0.688 , acc= 75.5%
Test: loss=0.693 , acc= 76.5%
Test: loss=0.685 , acc= 76.0%
Test: loss=0.693 , acc= 76.0%
Test: loss=0.683 , acc= 76.4%
Test: loss=0.703 , acc= 76.0%
Average acc= 76.2%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:26564.251161360287
total ranking r = 10
the number of space for current task:10
the new increased space:0, the threshold for new space:10
Ui shape:(48, 10)
activation shape:(576, 14400)
space shape:(576, 182)
threshold for selecting:222808.52754885802
total ranking r = 186
the number of space for current task:186
the new increased space:9, the threshold for new space:182
Ui shape:(576, 186)
activation shape:(512, 2500)
space shape:(512, 340)
threshold for selecting:24970.62403698054
total ranking r = 288
the number of space for current task:288
the new increased space:16, the threshold for new space:340
Ui shape:(512, 288)
activation shape:(1024, 125)
space shape:(1024, 454)
threshold for selecting:9666.174245386443
total ranking r = 409
the number of space for current task:409
the new increased space:96, the threshold for new space:454
Ui shape:(1024, 409)
activation shape:(2048, 125)
space shape:(2048, 578)
threshold for selecting:21649.330751338042
total ranking r = 554
the number of space for current task:554
the new increased space:122, the threshold for new space:578
Ui shape:(2048, 554)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.802 , acc= 78.0%
Test: loss=0.791 , acc= 78.2%
Test: loss=0.814 , acc= 77.5%
Test: loss=0.794 , acc= 77.4%
Test: loss=0.810 , acc= 77.5%
Test: loss=0.840 , acc= 77.3%
Test: loss=0.826 , acc= 77.7%
Test: loss=0.840 , acc= 77.0%
Test: loss=0.809 , acc= 77.9%
Test: loss=0.827 , acc= 77.3%
current testing task:cifar100-1
Test: loss=0.966 , acc= 69.4%
Test: loss=0.978 , acc= 69.1%
Test: loss=0.955 , acc= 69.3%
Test: loss=0.951 , acc= 69.6%
Test: loss=0.973 , acc= 69.2%
Test: loss=0.943 , acc= 70.4%
Test: loss=0.963 , acc= 69.2%
Test: loss=0.968 , acc= 70.0%
Test: loss=0.958 , acc= 69.2%
Test: loss=0.962 , acc= 69.6%
current testing task:cifar100-2
Test: loss=0.801 , acc= 74.0%
Test: loss=0.782 , acc= 75.4%
Test: loss=0.798 , acc= 75.4%
Test: loss=0.769 , acc= 75.8%
Test: loss=0.783 , acc= 75.0%
Test: loss=0.788 , acc= 75.6%
Test: loss=0.789 , acc= 76.0%
Test: loss=0.781 , acc= 75.9%
Test: loss=0.797 , acc= 75.2%
Test: loss=0.789 , acc= 75.7%
current testing task:cifar100-3
Test: loss=0.814 , acc= 74.3%
Test: loss=0.793 , acc= 76.0%
Test: loss=0.797 , acc= 74.8%
Test: loss=0.800 , acc= 76.2%
Test: loss=0.793 , acc= 75.3%
Test: loss=0.820 , acc= 74.9%
Test: loss=0.780 , acc= 76.0%
Test: loss=0.816 , acc= 74.5%
Test: loss=0.813 , acc= 75.0%
Test: loss=0.820 , acc= 74.0%
current testing task:cifar100-4
Test: loss=0.819 , acc= 77.8%
Test: loss=0.824 , acc= 77.5%
Test: loss=0.814 , acc= 78.7%
Test: loss=0.833 , acc= 77.4%
Test: loss=0.826 , acc= 76.8%
Test: loss=0.816 , acc= 78.4%
Test: loss=0.824 , acc= 77.9%
Test: loss=0.810 , acc= 78.2%
Test: loss=0.810 , acc= 77.8%
Test: loss=0.829 , acc= 78.2%
current testing task:cifar100-5
Test: loss=0.696 , acc= 76.9%
Test: loss=0.686 , acc= 76.7%
Test: loss=0.721 , acc= 76.1%
Test: loss=0.689 , acc= 76.1%
Test: loss=0.694 , acc= 75.8%
Test: loss=0.719 , acc= 75.0%
Test: loss=0.691 , acc= 76.1%
Test: loss=0.678 , acc= 76.2%
Test: loss=0.697 , acc= 75.8%
Test: loss=0.680 , acc= 76.7%
Accuracies =
 76.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.4%  75.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.3%  75.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.0%  74.9%  78.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.6%  69.5%  75.4%  75.1%  77.9%  76.1%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  6 (cifar100-6)
****************************************************************************************************
----------------------------------------
Task ID :6 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 10)
Task:0, Layer:0, project_norm:1.0204793277852735, threshold for regime 1:0.5129337906837463
Task:0, layer:1, space shape:(576, 137)
Task:0, Layer:1, project_norm:1.2094559239505396, threshold for regime 1:0.6219913959503174
Task:0, layer:2, space shape:(512, 195)
Task:0, Layer:2, project_norm:1.4263860795922914, threshold for regime 1:0.7386175394058228
Task:0, layer:3, space shape:(1024, 77)
Task:0, Layer:3, project_norm:1.6681097745895386, threshold for regime 1:1.00429368019104
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.2043747901916504, threshold for regime 1:1.3944404125213623
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:1.0179246699801918, threshold for regime 1:0.5129337906837463
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.2155504490636846, threshold for regime 1:0.6219913959503174
Task:1, layer:2, space shape:(512, 249)
Task:1, Layer:2, project_norm:1.4410495434174622, threshold for regime 1:0.7386175394058228
Task:1, layer:3, space shape:(1024, 146)
Task:1, Layer:3, project_norm:1.7634862661361694, threshold for regime 1:1.00429368019104
Task:1, layer:4, space shape:(2048, 174)
Task:1, Layer:4, project_norm:2.3436951637268066, threshold for regime 1:1.3944404125213623
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:1.0179246699801918, threshold for regime 1:0.5129337906837463
Task:2, layer:1, space shape:(576, 157)
Task:2, Layer:1, project_norm:1.2161582358577256, threshold for regime 1:0.6219913959503174
Task:2, layer:2, space shape:(512, 261)
Task:2, Layer:2, project_norm:1.4428440136982605, threshold for regime 1:0.7386175394058228
Task:2, layer:3, space shape:(1024, 202)
Task:2, Layer:3, project_norm:1.797680139541626, threshold for regime 1:1.00429368019104
Task:2, layer:4, space shape:(2048, 257)
Task:2, Layer:4, project_norm:2.412810802459717, threshold for regime 1:1.3944404125213623
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:1.0188439556889266, threshold for regime 1:0.5129337906837463
Task:3, layer:1, space shape:(576, 172)
Task:3, Layer:1, project_norm:1.2204719795931702, threshold for regime 1:0.6219913959503174
Task:3, layer:2, space shape:(512, 276)
Task:3, Layer:2, project_norm:1.4459695603504654, threshold for regime 1:0.7386175394058228
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.8334978818893433, threshold for regime 1:1.00429368019104
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.4751784801483154, threshold for regime 1:1.3944404125213623
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 9)
Task:4, Layer:0, project_norm:1.018808544298437, threshold for regime 1:0.5129337906837463
Task:4, layer:1, space shape:(576, 182)
Task:4, Layer:1, project_norm:1.2227070952679902, threshold for regime 1:0.6219913959503174
Task:4, layer:2, space shape:(512, 287)
Task:4, Layer:2, project_norm:1.4481716834336194, threshold for regime 1:0.7386175394058228
Task:4, layer:3, space shape:(1024, 338)
Task:4, Layer:3, project_norm:1.8616524934768677, threshold for regime 1:1.00429368019104
Task:4, layer:4, space shape:(2048, 453)
Task:4, Layer:4, project_norm:2.5200510025024414, threshold for regime 1:1.3944404125213623
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 10)
Task:5, Layer:0, project_norm:1.0198401801199193, threshold for regime 1:0.5129337906837463
Task:5, layer:1, space shape:(576, 186)
Task:5, Layer:1, project_norm:1.2233740129293869, threshold for regime 1:0.6219913959503174
Task:5, layer:2, space shape:(512, 288)
Task:5, Layer:2, project_norm:1.4485020323737774, threshold for regime 1:0.7386175394058228
Task:5, layer:3, space shape:(1024, 409)
Task:5, Layer:3, project_norm:1.884075403213501, threshold for regime 1:1.00429368019104
Task:5, layer:4, space shape:(2048, 554)
Task:5, Layer:4, project_norm:2.5568935871124268, threshold for regime 1:1.3944404125213623
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[5 0]
Layer:1, selected task ID:[4 5]
Layer:2, selected task ID:[4 5]
Layer:3, selected task ID:[4 5]
Layer:4, selected task ID:[4 5]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.720 , acc= 76.6%
Test: loss=0.745 , acc= 77.4%
Test: loss=0.705 , acc= 77.2%
Test: loss=0.706 , acc= 77.2%
Test: loss=0.694 , acc= 78.4%
Test: loss=0.713 , acc= 78.5%
Test: loss=0.712 , acc= 77.5%
Test: loss=0.716 , acc= 77.6%
Test: loss=0.712 , acc= 77.9%
Test: loss=0.727 , acc= 77.1%
Average acc= 77.5%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:21588.1663011202
total ranking r = 9
the number of space for current task:9
the new increased space:0, the threshold for new space:10
Ui shape:(48, 9)
activation shape:(576, 14400)
space shape:(576, 191)
threshold for selecting:180005.0006273992
total ranking r = 178
the number of space for current task:178
the new increased space:2, the threshold for new space:191
Ui shape:(576, 178)
activation shape:(512, 2500)
space shape:(512, 356)
threshold for selecting:20025.263296661866
total ranking r = 287
the number of space for current task:287
the new increased space:11, the threshold for new space:356
Ui shape:(512, 287)
activation shape:(1024, 125)
space shape:(1024, 550)
threshold for selecting:7344.073641154915
total ranking r = 480
the number of space for current task:480
the new increased space:89, the threshold for new space:550
Ui shape:(1024, 480)
activation shape:(2048, 125)
space shape:(2048, 700)
threshold for selecting:18686.897509156028
total ranking r = 656
the number of space for current task:656
the new increased space:123, the threshold for new space:700
Ui shape:(2048, 656)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.824 , acc= 78.3%
Test: loss=0.814 , acc= 78.3%
Test: loss=0.804 , acc= 77.8%
Test: loss=0.802 , acc= 77.1%
Test: loss=0.806 , acc= 78.0%
Test: loss=0.820 , acc= 77.5%
Test: loss=0.800 , acc= 76.7%
Test: loss=0.802 , acc= 77.3%
Test: loss=0.795 , acc= 77.2%
Test: loss=0.801 , acc= 77.7%
current testing task:cifar100-1
Test: loss=0.977 , acc= 68.3%
Test: loss=0.960 , acc= 69.3%
Test: loss=0.950 , acc= 68.9%
Test: loss=0.967 , acc= 69.3%
Test: loss=0.950 , acc= 69.2%
Test: loss=0.944 , acc= 69.5%
Test: loss=0.955 , acc= 70.1%
Test: loss=0.968 , acc= 69.5%
Test: loss=0.978 , acc= 68.0%
Test: loss=0.973 , acc= 67.7%
current testing task:cifar100-2
Test: loss=0.763 , acc= 75.3%
Test: loss=0.777 , acc= 74.8%
Test: loss=0.793 , acc= 75.6%
Test: loss=0.782 , acc= 75.1%
Test: loss=0.790 , acc= 74.4%
Test: loss=0.795 , acc= 74.8%
Test: loss=0.796 , acc= 74.9%
Test: loss=0.811 , acc= 74.6%
Test: loss=0.793 , acc= 74.5%
Test: loss=0.787 , acc= 75.8%
current testing task:cifar100-3
Test: loss=0.822 , acc= 74.0%
Test: loss=0.794 , acc= 75.2%
Test: loss=0.808 , acc= 74.6%
Test: loss=0.812 , acc= 74.8%
Test: loss=0.808 , acc= 75.5%
Test: loss=0.795 , acc= 75.5%
Test: loss=0.825 , acc= 74.7%
Test: loss=0.792 , acc= 75.2%
Test: loss=0.791 , acc= 74.5%
Test: loss=0.799 , acc= 74.2%
current testing task:cifar100-4
Test: loss=0.791 , acc= 78.0%
Test: loss=0.831 , acc= 77.8%
Test: loss=0.800 , acc= 78.9%
Test: loss=0.825 , acc= 77.7%
Test: loss=0.834 , acc= 76.9%
Test: loss=0.843 , acc= 78.2%
Test: loss=0.794 , acc= 78.3%
Test: loss=0.803 , acc= 77.8%
Test: loss=0.818 , acc= 78.0%
Test: loss=0.807 , acc= 78.3%
current testing task:cifar100-5
Test: loss=0.683 , acc= 75.7%
Test: loss=0.696 , acc= 76.4%
Test: loss=0.711 , acc= 74.7%
Test: loss=0.713 , acc= 75.4%
Test: loss=0.708 , acc= 75.0%
Test: loss=0.696 , acc= 76.6%
Test: loss=0.700 , acc= 75.5%
Test: loss=0.699 , acc= 76.7%
Test: loss=0.724 , acc= 74.8%
Test: loss=0.698 , acc= 77.0%
current testing task:cifar100-6
Test: loss=0.726 , acc= 78.4%
Test: loss=0.714 , acc= 77.7%
Test: loss=0.707 , acc= 78.5%
Test: loss=0.720 , acc= 77.9%
Test: loss=0.723 , acc= 77.5%
Test: loss=0.701 , acc= 77.8%
Test: loss=0.728 , acc= 77.0%
Test: loss=0.705 , acc= 78.0%
Test: loss=0.717 , acc= 77.5%
Test: loss=0.713 , acc= 78.3%
Accuracies =
 76.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.4%  75.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.3%  75.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.0%  74.9%  78.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.6%  69.5%  75.4%  75.1%  77.9%  76.1%   0.0%   0.0%   0.0%   0.0%
 77.6%  69.0%  75.0%  74.8%  78.0%  75.8%  77.9%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  7 (cifar100-7)
****************************************************************************************************
----------------------------------------
Task ID :7 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 10)
Task:0, Layer:0, project_norm:0.7979797155770472, threshold for regime 1:0.401834636926651
Task:0, layer:1, space shape:(576, 137)
Task:0, Layer:1, project_norm:1.238037922762212, threshold for regime 1:0.6376892924308777
Task:0, layer:2, space shape:(512, 195)
Task:0, Layer:2, project_norm:1.4477775343037982, threshold for regime 1:0.7514382600784302
Task:0, layer:3, space shape:(1024, 77)
Task:0, Layer:3, project_norm:1.7071489095687866, threshold for regime 1:1.0346381664276123
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.182858943939209, threshold for regime 1:1.4079492092132568
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.7958789291599347, threshold for regime 1:0.401834636926651
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.2443823625555122, threshold for regime 1:0.6376892924308777
Task:1, layer:2, space shape:(512, 249)
Task:1, Layer:2, project_norm:1.4633451744248442, threshold for regime 1:0.7514382600784302
Task:1, layer:3, space shape:(1024, 146)
Task:1, Layer:3, project_norm:1.8089181184768677, threshold for regime 1:1.0346381664276123
Task:1, layer:4, space shape:(2048, 174)
Task:1, Layer:4, project_norm:2.3479156494140625, threshold for regime 1:1.4079492092132568
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.7958789291599347, threshold for regime 1:0.401834636926651
Task:2, layer:1, space shape:(576, 157)
Task:2, Layer:1, project_norm:1.2445246401499557, threshold for regime 1:0.6376892924308777
Task:2, layer:2, space shape:(512, 261)
Task:2, Layer:2, project_norm:1.4657978497562647, threshold for regime 1:0.7514382600784302
Task:2, layer:3, space shape:(1024, 202)
Task:2, Layer:3, project_norm:1.850927710533142, threshold for regime 1:1.0346381664276123
Task:2, layer:4, space shape:(2048, 257)
Task:2, Layer:4, project_norm:2.4262614250183105, threshold for regime 1:1.4079492092132568
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.7965660094707219, threshold for regime 1:0.401834636926651
Task:3, layer:1, space shape:(576, 172)
Task:3, Layer:1, project_norm:1.24942233206642, threshold for regime 1:0.6376892924308777
Task:3, layer:2, space shape:(512, 276)
Task:3, Layer:2, project_norm:1.4693250207931052, threshold for regime 1:0.7514382600784302
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.8863818645477295, threshold for regime 1:1.0346381664276123
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.4899790287017822, threshold for regime 1:1.4079492092132568
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 9)
Task:4, Layer:0, project_norm:0.7965822034437958, threshold for regime 1:0.401834636926651
Task:4, layer:1, space shape:(576, 182)
Task:4, Layer:1, project_norm:1.2521456325818123, threshold for regime 1:0.6376892924308777
Task:4, layer:2, space shape:(512, 287)
Task:4, Layer:2, project_norm:1.471255715563998, threshold for regime 1:0.7514382600784302
Task:4, layer:3, space shape:(1024, 338)
Task:4, Layer:3, project_norm:1.9160280227661133, threshold for regime 1:1.0346381664276123
Task:4, layer:4, space shape:(2048, 453)
Task:4, Layer:4, project_norm:2.543341636657715, threshold for regime 1:1.4079492092132568
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 10)
Task:5, Layer:0, project_norm:0.7981360217812579, threshold for regime 1:0.401834636926651
Task:5, layer:1, space shape:(576, 186)
Task:5, Layer:1, project_norm:1.2532426090787623, threshold for regime 1:0.6376892924308777
Task:5, layer:2, space shape:(512, 288)
Task:5, Layer:2, project_norm:1.4718082499202223, threshold for regime 1:0.7514382600784302
Task:5, layer:3, space shape:(1024, 409)
Task:5, Layer:3, project_norm:1.9401345252990723, threshold for regime 1:1.0346381664276123
Task:5, layer:4, space shape:(2048, 554)
Task:5, Layer:4, project_norm:2.5761172771453857, threshold for regime 1:1.4079492092132568
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:6, layer:0, space shape:(48, 9)
Task:6, Layer:0, project_norm:0.7965769858169384, threshold for regime 1:0.401834636926651
Task:6, layer:1, space shape:(576, 178)
Task:6, Layer:1, project_norm:1.251149512591502, threshold for regime 1:0.6376892924308777
Task:6, layer:2, space shape:(512, 287)
Task:6, Layer:2, project_norm:1.4720922972132575, threshold for regime 1:0.7514382600784302
Task:6, layer:3, space shape:(1024, 480)
Task:6, Layer:3, project_norm:1.965688943862915, threshold for regime 1:1.0346381664276123
Task:6, layer:4, space shape:(2048, 656)
Task:6, Layer:4, project_norm:2.6136879920959473, threshold for regime 1:1.4079492092132568
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[0 5]
Layer:1, selected task ID:[4 5]
Layer:2, selected task ID:[5 6]
Layer:3, selected task ID:[5 6]
Layer:4, selected task ID:[5 6]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.844 , acc= 74.8%
Test: loss=0.820 , acc= 74.6%
Test: loss=0.837 , acc= 75.6%
Test: loss=0.839 , acc= 74.2%
Test: loss=0.814 , acc= 75.3%
Test: loss=0.833 , acc= 74.8%
Test: loss=0.833 , acc= 74.5%
Test: loss=0.830 , acc= 75.0%
Test: loss=0.844 , acc= 74.5%
Test: loss=0.813 , acc= 74.9%
Average acc= 74.8%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:26375.807274332423
total ranking r = 10
the number of space for current task:10
the new increased space:0, the threshold for new space:10
Ui shape:(48, 10)
activation shape:(576, 14400)
space shape:(576, 193)
threshold for selecting:218775.126792079
total ranking r = 191
the number of space for current task:191
the new increased space:6, the threshold for new space:193
Ui shape:(576, 191)
activation shape:(512, 2500)
space shape:(512, 367)
threshold for selecting:19166.302713375513
total ranking r = 289
the number of space for current task:289
the new increased space:8, the threshold for new space:367
Ui shape:(512, 289)
activation shape:(1024, 125)
space shape:(1024, 639)
threshold for selecting:5597.200113237137
total ranking r = 541
the number of space for current task:541
the new increased space:80, the threshold for new space:639
Ui shape:(1024, 541)
activation shape:(2048, 125)
space shape:(2048, 823)
threshold for selecting:15553.55628079269
total ranking r = 749
the number of space for current task:749
the new increased space:120, the threshold for new space:823
Ui shape:(2048, 749)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.826 , acc= 77.9%
Test: loss=0.814 , acc= 76.7%
Test: loss=0.818 , acc= 77.4%
Test: loss=0.834 , acc= 77.3%
Test: loss=0.816 , acc= 77.7%
Test: loss=0.792 , acc= 77.6%
Test: loss=0.815 , acc= 76.9%
Test: loss=0.811 , acc= 77.8%
Test: loss=0.825 , acc= 76.8%
Test: loss=0.836 , acc= 77.0%
current testing task:cifar100-1
Test: loss=0.952 , acc= 69.9%
Test: loss=0.976 , acc= 68.5%
Test: loss=0.955 , acc= 68.9%
Test: loss=0.969 , acc= 69.4%
Test: loss=0.961 , acc= 69.8%
Test: loss=0.969 , acc= 68.9%
Test: loss=0.991 , acc= 70.1%
Test: loss=0.983 , acc= 69.7%
Test: loss=0.956 , acc= 70.7%
Test: loss=0.976 , acc= 69.3%
current testing task:cifar100-2
Test: loss=0.805 , acc= 75.4%
Test: loss=0.795 , acc= 75.1%
Test: loss=0.774 , acc= 75.2%
Test: loss=0.793 , acc= 74.7%
Test: loss=0.769 , acc= 75.1%
Test: loss=0.803 , acc= 74.8%
Test: loss=0.786 , acc= 75.7%
Test: loss=0.795 , acc= 74.9%
Test: loss=0.787 , acc= 75.5%
Test: loss=0.777 , acc= 75.5%
current testing task:cifar100-3
Test: loss=0.783 , acc= 75.0%
Test: loss=0.797 , acc= 74.1%
Test: loss=0.831 , acc= 75.2%
Test: loss=0.793 , acc= 74.9%
Test: loss=0.796 , acc= 74.7%
Test: loss=0.788 , acc= 75.0%
Test: loss=0.809 , acc= 74.2%
Test: loss=0.802 , acc= 75.6%
Test: loss=0.792 , acc= 74.6%
Test: loss=0.778 , acc= 74.8%
current testing task:cifar100-4
Test: loss=0.814 , acc= 77.2%
Test: loss=0.827 , acc= 77.6%
Test: loss=0.826 , acc= 78.1%
Test: loss=0.814 , acc= 77.8%
Test: loss=0.812 , acc= 77.4%
Test: loss=0.852 , acc= 77.9%
Test: loss=0.860 , acc= 76.2%
Test: loss=0.806 , acc= 78.4%
Test: loss=0.815 , acc= 76.8%
Test: loss=0.831 , acc= 77.7%
current testing task:cifar100-5
Test: loss=0.676 , acc= 75.5%
Test: loss=0.702 , acc= 75.7%
Test: loss=0.697 , acc= 75.1%
Test: loss=0.726 , acc= 76.3%
Test: loss=0.731 , acc= 75.5%
Test: loss=0.711 , acc= 76.5%
Test: loss=0.696 , acc= 75.7%
Test: loss=0.718 , acc= 76.4%
Test: loss=0.688 , acc= 75.8%
Test: loss=0.708 , acc= 75.6%
current testing task:cifar100-6
Test: loss=0.704 , acc= 78.8%
Test: loss=0.712 , acc= 76.9%
Test: loss=0.705 , acc= 77.8%
Test: loss=0.713 , acc= 77.7%
Test: loss=0.702 , acc= 79.1%
Test: loss=0.731 , acc= 77.1%
Test: loss=0.736 , acc= 78.0%
Test: loss=0.724 , acc= 76.5%
Test: loss=0.745 , acc= 77.2%
Test: loss=0.714 , acc= 77.7%
current testing task:cifar100-7
Test: loss=0.851 , acc= 74.5%
Test: loss=0.823 , acc= 75.2%
Test: loss=0.824 , acc= 74.2%
Test: loss=0.832 , acc= 75.3%
Test: loss=0.825 , acc= 75.1%
Test: loss=0.821 , acc= 74.5%
Test: loss=0.821 , acc= 74.8%
Test: loss=0.815 , acc= 74.2%
Test: loss=0.823 , acc= 74.6%
Test: loss=0.827 , acc= 74.7%
Accuracies =
 76.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.4%  75.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.3%  75.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.0%  74.9%  78.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.6%  69.5%  75.4%  75.1%  77.9%  76.1%   0.0%   0.0%   0.0%   0.0%
 77.6%  69.0%  75.0%  74.8%  78.0%  75.8%  77.9%   0.0%   0.0%   0.0%
 77.3%  69.5%  75.2%  74.8%  77.5%  75.8%  77.7%  74.7%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  8 (cifar100-8)
****************************************************************************************************
----------------------------------------
Task ID :8 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 10)
Task:0, Layer:0, project_norm:0.6648428797649829, threshold for regime 1:0.3374858796596527
Task:0, layer:1, space shape:(576, 137)
Task:0, Layer:1, project_norm:1.1107254044643602, threshold for regime 1:0.5811267495155334
Task:0, layer:2, space shape:(512, 195)
Task:0, Layer:2, project_norm:1.3427944692253593, threshold for regime 1:0.7023732662200928
Task:0, layer:3, space shape:(1024, 77)
Task:0, Layer:3, project_norm:1.5710512399673462, threshold for regime 1:0.9697865843772888
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.1528027057647705, threshold for regime 1:1.3671488761901855
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.6621067359279255, threshold for regime 1:0.3374858796596527
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.1198501493052706, threshold for regime 1:0.5811267495155334
Task:1, layer:2, space shape:(512, 249)
Task:1, Layer:2, project_norm:1.3593401359996624, threshold for regime 1:0.7023732662200928
Task:1, layer:3, space shape:(1024, 146)
Task:1, Layer:3, project_norm:1.662958025932312, threshold for regime 1:0.9697865843772888
Task:1, layer:4, space shape:(2048, 174)
Task:1, Layer:4, project_norm:2.270521402359009, threshold for regime 1:1.3671488761901855
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.6621067359279255, threshold for regime 1:0.3374858796596527
Task:2, layer:1, space shape:(576, 157)
Task:2, Layer:1, project_norm:1.1196517934749912, threshold for regime 1:0.5811267495155334
Task:2, layer:2, space shape:(512, 261)
Task:2, Layer:2, project_norm:1.361652683422752, threshold for regime 1:0.7023732662200928
Task:2, layer:3, space shape:(1024, 202)
Task:2, Layer:3, project_norm:1.708073616027832, threshold for regime 1:0.9697865843772888
Task:2, layer:4, space shape:(2048, 257)
Task:2, Layer:4, project_norm:2.3425076007843018, threshold for regime 1:1.3671488761901855
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.6634518953238501, threshold for regime 1:0.3374858796596527
Task:3, layer:1, space shape:(576, 172)
Task:3, Layer:1, project_norm:1.1264093208032024, threshold for regime 1:0.5811267495155334
Task:3, layer:2, space shape:(512, 276)
Task:3, Layer:2, project_norm:1.365749919902954, threshold for regime 1:0.7023732662200928
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.7433404922485352, threshold for regime 1:0.9697865843772888
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.402153968811035, threshold for regime 1:1.3671488761901855
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 9)
Task:4, Layer:0, project_norm:0.6634065623292162, threshold for regime 1:0.3374858796596527
Task:4, layer:1, space shape:(576, 182)
Task:4, Layer:1, project_norm:1.1303410756849464, threshold for regime 1:0.5811267495155334
Task:4, layer:2, space shape:(512, 287)
Task:4, Layer:2, project_norm:1.368415144981582, threshold for regime 1:0.7023732662200928
Task:4, layer:3, space shape:(1024, 338)
Task:4, Layer:3, project_norm:1.774446725845337, threshold for regime 1:0.9697865843772888
Task:4, layer:4, space shape:(2048, 453)
Task:4, Layer:4, project_norm:2.4501070976257324, threshold for regime 1:1.3671488761901855
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 10)
Task:5, Layer:0, project_norm:0.6654890964082907, threshold for regime 1:0.3374858796596527
Task:5, layer:1, space shape:(576, 186)
Task:5, Layer:1, project_norm:1.1312249462073716, threshold for regime 1:0.5811267495155334
Task:5, layer:2, space shape:(512, 288)
Task:5, Layer:2, project_norm:1.3686559848653654, threshold for regime 1:0.7023732662200928
Task:5, layer:3, space shape:(1024, 409)
Task:5, Layer:3, project_norm:1.800160527229309, threshold for regime 1:0.9697865843772888
Task:5, layer:4, space shape:(2048, 554)
Task:5, Layer:4, project_norm:2.4866135120391846, threshold for regime 1:1.3671488761901855
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:6, layer:0, space shape:(48, 9)
Task:6, Layer:0, project_norm:0.6634142616279607, threshold for regime 1:0.3374858796596527
Task:6, layer:1, space shape:(576, 178)
Task:6, Layer:1, project_norm:1.1284420206192056, threshold for regime 1:0.5811267495155334
Task:6, layer:2, space shape:(512, 287)
Task:6, Layer:2, project_norm:1.3682869716771409, threshold for regime 1:0.7023732662200928
Task:6, layer:3, space shape:(1024, 480)
Task:6, Layer:3, project_norm:1.8229011297225952, threshold for regime 1:0.9697865843772888
Task:6, layer:4, space shape:(2048, 656)
Task:6, Layer:4, project_norm:2.5156869888305664, threshold for regime 1:1.3671488761901855
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:7, layer:0, space shape:(48, 10)
Task:7, Layer:0, project_norm:0.6646292748848744, threshold for regime 1:0.3374858796596527
Task:7, layer:1, space shape:(576, 191)
Task:7, Layer:1, project_norm:1.1330525842191643, threshold for regime 1:0.5811267495155334
Task:7, layer:2, space shape:(512, 289)
Task:7, Layer:2, project_norm:1.369026046827001, threshold for regime 1:0.7023732662200928
Task:7, layer:3, space shape:(1024, 541)
Task:7, Layer:3, project_norm:1.8387964963912964, threshold for regime 1:0.9697865843772888
Task:7, layer:4, space shape:(2048, 749)
Task:7, Layer:4, project_norm:2.5417048931121826, threshold for regime 1:1.3671488761901855
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[0 5]
Layer:1, selected task ID:[5 7]
Layer:2, selected task ID:[5 7]
Layer:3, selected task ID:[6 7]
Layer:4, selected task ID:[6 7]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.761 , acc= 75.4%
Test: loss=0.742 , acc= 76.6%
Test: loss=0.759 , acc= 76.8%
Test: loss=0.765 , acc= 76.4%
Test: loss=0.746 , acc= 75.6%
Test: loss=0.760 , acc= 75.7%
Test: loss=0.775 , acc= 76.0%
Test: loss=0.765 , acc= 75.8%
Test: loss=0.774 , acc= 76.0%
Test: loss=0.750 , acc= 77.6%
Average acc= 76.2%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:33871.431689176854
total ranking r = 10
the number of space for current task:10
the new increased space:0, the threshold for new space:10
Ui shape:(48, 10)
activation shape:(576, 14400)
space shape:(576, 199)
threshold for selecting:216499.88967566195
total ranking r = 201
the number of space for current task:201
the new increased space:7, the threshold for new space:199
Ui shape:(576, 201)
activation shape:(512, 2500)
space shape:(512, 375)
threshold for selecting:19610.91450987062
total ranking r = 307
the number of space for current task:307
the new increased space:11, the threshold for new space:375
Ui shape:(512, 307)
activation shape:(1024, 125)
space shape:(1024, 719)
threshold for selecting:4756.181243114406
total ranking r = 609
the number of space for current task:609
the new increased space:74, the threshold for new space:719
Ui shape:(1024, 609)
activation shape:(2048, 125)
space shape:(2048, 943)
threshold for selecting:14663.659334206022
total ranking r = 860
the number of space for current task:860
the new increased space:123, the threshold for new space:943
Ui shape:(2048, 860)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.808 , acc= 75.9%
Test: loss=0.802 , acc= 78.4%
Test: loss=0.804 , acc= 77.1%
Test: loss=0.797 , acc= 77.1%
Test: loss=0.784 , acc= 77.9%
Test: loss=0.806 , acc= 77.7%
Test: loss=0.812 , acc= 78.2%
Test: loss=0.780 , acc= 79.0%
Test: loss=0.828 , acc= 76.7%
Test: loss=0.826 , acc= 77.1%
current testing task:cifar100-1
Test: loss=0.969 , acc= 68.4%
Test: loss=0.967 , acc= 70.0%
Test: loss=0.981 , acc= 68.6%
Test: loss=0.973 , acc= 69.8%
Test: loss=0.949 , acc= 70.3%
Test: loss=0.947 , acc= 70.7%
Test: loss=0.993 , acc= 69.2%
Test: loss=0.954 , acc= 69.0%
Test: loss=0.944 , acc= 70.5%
Test: loss=0.956 , acc= 69.6%
current testing task:cifar100-2
Test: loss=0.777 , acc= 75.9%
Test: loss=0.758 , acc= 75.0%
Test: loss=0.781 , acc= 75.2%
Test: loss=0.778 , acc= 75.1%
Test: loss=0.786 , acc= 75.1%
Test: loss=0.774 , acc= 75.8%
Test: loss=0.809 , acc= 74.6%
Test: loss=0.771 , acc= 74.9%
Test: loss=0.772 , acc= 75.8%
Test: loss=0.776 , acc= 74.6%
current testing task:cifar100-3
Test: loss=0.788 , acc= 74.2%
Test: loss=0.809 , acc= 74.5%
Test: loss=0.791 , acc= 74.9%
Test: loss=0.798 , acc= 75.3%
Test: loss=0.813 , acc= 75.3%
Test: loss=0.805 , acc= 75.1%
Test: loss=0.787 , acc= 75.1%
Test: loss=0.781 , acc= 76.5%
Test: loss=0.768 , acc= 76.3%
Test: loss=0.798 , acc= 74.3%
current testing task:cifar100-4
Test: loss=0.819 , acc= 77.1%
Test: loss=0.815 , acc= 77.8%
Test: loss=0.813 , acc= 77.4%
Test: loss=0.801 , acc= 77.9%
Test: loss=0.823 , acc= 77.7%
Test: loss=0.840 , acc= 78.4%
Test: loss=0.835 , acc= 78.5%
Test: loss=0.817 , acc= 77.9%
Test: loss=0.816 , acc= 78.6%
Test: loss=0.817 , acc= 79.0%
current testing task:cifar100-5
Test: loss=0.702 , acc= 75.7%
Test: loss=0.681 , acc= 76.8%
Test: loss=0.719 , acc= 75.6%
Test: loss=0.724 , acc= 75.1%
Test: loss=0.721 , acc= 76.0%
Test: loss=0.707 , acc= 77.6%
Test: loss=0.717 , acc= 75.7%
Test: loss=0.679 , acc= 77.2%
Test: loss=0.682 , acc= 76.9%
Test: loss=0.690 , acc= 76.4%
current testing task:cifar100-6
Test: loss=0.729 , acc= 77.6%
Test: loss=0.735 , acc= 76.4%
Test: loss=0.721 , acc= 77.7%
Test: loss=0.726 , acc= 76.1%
Test: loss=0.712 , acc= 78.1%
Test: loss=0.713 , acc= 77.8%
Test: loss=0.735 , acc= 77.5%
Test: loss=0.735 , acc= 77.5%
Test: loss=0.707 , acc= 77.6%
Test: loss=0.705 , acc= 77.8%
current testing task:cifar100-7
Test: loss=0.813 , acc= 74.2%
Test: loss=0.824 , acc= 75.0%
Test: loss=0.829 , acc= 75.0%
Test: loss=0.812 , acc= 74.2%
Test: loss=0.838 , acc= 74.2%
Test: loss=0.827 , acc= 75.2%
Test: loss=0.855 , acc= 74.1%
Test: loss=0.814 , acc= 75.5%
Test: loss=0.830 , acc= 75.4%
Test: loss=0.827 , acc= 74.7%
current testing task:cifar100-8
Test: loss=0.751 , acc= 75.5%
Test: loss=0.762 , acc= 75.1%
Test: loss=0.749 , acc= 76.7%
Test: loss=0.763 , acc= 76.3%
Test: loss=0.765 , acc= 75.8%
Test: loss=0.751 , acc= 76.0%
Test: loss=0.731 , acc= 76.2%
Test: loss=0.743 , acc= 77.1%
Test: loss=0.739 , acc= 76.8%
Test: loss=0.787 , acc= 75.4%
Accuracies =
 76.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.4%  75.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.3%  75.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.0%  74.9%  78.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.6%  69.5%  75.4%  75.1%  77.9%  76.1%   0.0%   0.0%   0.0%   0.0%
 77.6%  69.0%  75.0%  74.8%  78.0%  75.8%  77.9%   0.0%   0.0%   0.0%
 77.3%  69.5%  75.2%  74.8%  77.5%  75.8%  77.7%  74.7%   0.0%   0.0%
 77.5%  69.6%  75.2%  75.1%  78.0%  76.3%  77.4%  74.8%  76.1%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  9 (cifar100-9)
****************************************************************************************************
----------------------------------------
Task ID :9 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 10)
Task:0, Layer:0, project_norm:0.713622101565359, threshold for regime 1:0.36011677980422974
Task:0, layer:1, space shape:(576, 137)
Task:0, Layer:1, project_norm:1.1344406515131118, threshold for regime 1:0.5890020728111267
Task:0, layer:2, space shape:(512, 195)
Task:0, Layer:2, project_norm:1.3558509694286973, threshold for regime 1:0.7064815163612366
Task:0, layer:3, space shape:(1024, 77)
Task:0, Layer:3, project_norm:1.641414761543274, threshold for regime 1:0.9907159805297852
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.2810733318328857, threshold for regime 1:1.4152601957321167
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.7113464037971704, threshold for regime 1:0.36011677980422974
Task:1, layer:1, space shape:(576, 156)
Task:1, Layer:1, project_norm:1.1419997051752742, threshold for regime 1:0.5890020728111267
Task:1, layer:2, space shape:(512, 249)
Task:1, Layer:2, project_norm:1.371639120104912, threshold for regime 1:0.7064815163612366
Task:1, layer:3, space shape:(1024, 146)
Task:1, Layer:3, project_norm:1.7302873134613037, threshold for regime 1:0.9907159805297852
Task:1, layer:4, space shape:(2048, 174)
Task:1, Layer:4, project_norm:2.398421049118042, threshold for regime 1:1.4152601957321167
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 8)
Task:2, Layer:0, project_norm:0.7113464037971704, threshold for regime 1:0.36011677980422974
Task:2, layer:1, space shape:(576, 157)
Task:2, Layer:1, project_norm:1.1421365912878325, threshold for regime 1:0.5890020728111267
Task:2, layer:2, space shape:(512, 261)
Task:2, Layer:2, project_norm:1.373382741736684, threshold for regime 1:0.7064815163612366
Task:2, layer:3, space shape:(1024, 202)
Task:2, Layer:3, project_norm:1.7685688734054565, threshold for regime 1:0.9907159805297852
Task:2, layer:4, space shape:(2048, 257)
Task:2, Layer:4, project_norm:2.465102434158325, threshold for regime 1:1.4152601957321167
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.7124788324156014, threshold for regime 1:0.36011677980422974
Task:3, layer:1, space shape:(576, 172)
Task:3, Layer:1, project_norm:1.1475544844380998, threshold for regime 1:0.5890020728111267
Task:3, layer:2, space shape:(512, 276)
Task:3, Layer:2, project_norm:1.3777082718852418, threshold for regime 1:0.7064815163612366
Task:3, layer:3, space shape:(1024, 270)
Task:3, Layer:3, project_norm:1.8039031028747559, threshold for regime 1:0.9907159805297852
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.525752305984497, threshold for regime 1:1.4152601957321167
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 9)
Task:4, Layer:0, project_norm:0.7123556646036935, threshold for regime 1:0.36011677980422974
Task:4, layer:1, space shape:(576, 182)
Task:4, Layer:1, project_norm:1.1507076703365362, threshold for regime 1:0.5890020728111267
Task:4, layer:2, space shape:(512, 287)
Task:4, Layer:2, project_norm:1.3795745073742847, threshold for regime 1:0.7064815163612366
Task:4, layer:3, space shape:(1024, 338)
Task:4, Layer:3, project_norm:1.8328574895858765, threshold for regime 1:0.9907159805297852
Task:4, layer:4, space shape:(2048, 453)
Task:4, Layer:4, project_norm:2.568453788757324, threshold for regime 1:1.4152601957321167
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 10)
Task:5, Layer:0, project_norm:0.7135407114649795, threshold for regime 1:0.36011677980422974
Task:5, layer:1, space shape:(576, 186)
Task:5, Layer:1, project_norm:1.1521938432922525, threshold for regime 1:0.5890020728111267
Task:5, layer:2, space shape:(512, 288)
Task:5, Layer:2, project_norm:1.3800797716826783, threshold for regime 1:0.7064815163612366
Task:5, layer:3, space shape:(1024, 409)
Task:5, Layer:3, project_norm:1.8552793264389038, threshold for regime 1:0.9907159805297852
Task:5, layer:4, space shape:(2048, 554)
Task:5, Layer:4, project_norm:2.6056392192840576, threshold for regime 1:1.4152601957321167
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:6, layer:0, space shape:(48, 9)
Task:6, Layer:0, project_norm:0.7123719745415874, threshold for regime 1:0.36011677980422974
Task:6, layer:1, space shape:(576, 178)
Task:6, Layer:1, project_norm:1.1496156419959935, threshold for regime 1:0.5890020728111267
Task:6, layer:2, space shape:(512, 287)
Task:6, Layer:2, project_norm:1.3798776651660887, threshold for regime 1:0.7064815163612366
Task:6, layer:3, space shape:(1024, 480)
Task:6, Layer:3, project_norm:1.8759663105010986, threshold for regime 1:0.9907159805297852
Task:6, layer:4, space shape:(2048, 656)
Task:6, Layer:4, project_norm:2.6333093643188477, threshold for regime 1:1.4152601957321167
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:7, layer:0, space shape:(48, 10)
Task:7, Layer:0, project_norm:0.7135356000589813, threshold for regime 1:0.36011677980422974
Task:7, layer:1, space shape:(576, 191)
Task:7, Layer:1, project_norm:1.1532206032605705, threshold for regime 1:0.5890020728111267
Task:7, layer:2, space shape:(512, 289)
Task:7, Layer:2, project_norm:1.3804014166693677, threshold for regime 1:0.7064815163612366
Task:7, layer:3, space shape:(1024, 541)
Task:7, Layer:3, project_norm:1.892067313194275, threshold for regime 1:0.9907159805297852
Task:7, layer:4, space shape:(2048, 749)
Task:7, Layer:4, project_norm:2.6564688682556152, threshold for regime 1:1.4152601957321167
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:8, layer:0, space shape:(48, 10)
Task:8, Layer:0, project_norm:0.7134103444783408, threshold for regime 1:0.36011677980422974
Task:8, layer:1, space shape:(576, 201)
Task:8, Layer:1, project_norm:1.1558737693362215, threshold for regime 1:0.5890020728111267
Task:8, layer:2, space shape:(512, 307)
Task:8, Layer:2, project_norm:1.3839308511269641, threshold for regime 1:0.7064815163612366
Task:8, layer:3, space shape:(1024, 609)
Task:8, Layer:3, project_norm:1.9089124202728271, threshold for regime 1:0.9907159805297852
Task:8, layer:4, space shape:(2048, 860)
Task:8, Layer:4, project_norm:2.678511619567871, threshold for regime 1:1.4152601957321167
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[5 0]
Layer:1, selected task ID:[7 8]
Layer:2, selected task ID:[7 8]
Layer:3, selected task ID:[7 8]
Layer:4, selected task ID:[7 8]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.599 , acc= 82.3%
Test: loss=0.596 , acc= 81.9%
Test: loss=0.584 , acc= 82.7%
Test: loss=0.622 , acc= 82.1%
Test: loss=0.613 , acc= 82.2%
Test: loss=0.589 , acc= 83.1%
Test: loss=0.588 , acc= 82.0%
Test: loss=0.630 , acc= 81.5%
Test: loss=0.570 , acc= 83.5%
Test: loss=0.605 , acc= 82.6%
Average acc= 82.4%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 10)
threshold for selecting:18211.162864221587
total ranking r = 8
the number of space for current task:8
the new increased space:0, the threshold for new space:10
Ui shape:(48, 8)
activation shape:(576, 14400)
space shape:(576, 206)
threshold for selecting:178330.155442818
total ranking r = 191
the number of space for current task:191
the new increased space:2, the threshold for new space:206
Ui shape:(576, 191)
activation shape:(512, 2500)
space shape:(512, 386)
threshold for selecting:15961.46468415704
total ranking r = 295
the number of space for current task:295
the new increased space:5, the threshold for new space:386
Ui shape:(512, 295)
activation shape:(1024, 125)
space shape:(1024, 793)
threshold for selecting:3145.848479346154
total ranking r = 643
the number of space for current task:643
the new increased space:55, the threshold for new space:793
Ui shape:(1024, 643)
activation shape:(2048, 125)
space shape:(2048, 1066)
threshold for selecting:11489.03749021847
total ranking r = 949
the number of space for current task:949
the new increased space:119, the threshold for new space:1066
Ui shape:(2048, 949)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.810 , acc= 77.2%
Test: loss=0.810 , acc= 77.2%
Test: loss=0.805 , acc= 77.8%
Test: loss=0.826 , acc= 77.1%
Test: loss=0.793 , acc= 77.7%
Test: loss=0.819 , acc= 76.8%
Test: loss=0.785 , acc= 77.2%
Test: loss=0.811 , acc= 77.8%
Test: loss=0.837 , acc= 76.4%
Test: loss=0.810 , acc= 78.2%
current testing task:cifar100-1
Test: loss=0.958 , acc= 70.3%
Test: loss=0.972 , acc= 68.3%
Test: loss=0.964 , acc= 69.6%
Test: loss=0.955 , acc= 69.9%
Test: loss=0.939 , acc= 70.1%
Test: loss=0.957 , acc= 69.8%
Test: loss=0.980 , acc= 69.3%
Test: loss=0.950 , acc= 70.4%
Test: loss=0.974 , acc= 69.8%
Test: loss=0.961 , acc= 69.7%
current testing task:cifar100-2
Test: loss=0.766 , acc= 75.2%
Test: loss=0.783 , acc= 75.3%
Test: loss=0.767 , acc= 74.6%
Test: loss=0.785 , acc= 74.7%
Test: loss=0.786 , acc= 75.0%
Test: loss=0.776 , acc= 75.3%
Test: loss=0.793 , acc= 73.8%
Test: loss=0.804 , acc= 74.3%
Test: loss=0.776 , acc= 75.4%
Test: loss=0.778 , acc= 75.3%
current testing task:cifar100-3
Test: loss=0.803 , acc= 75.8%
Test: loss=0.803 , acc= 74.3%
Test: loss=0.786 , acc= 75.7%
Test: loss=0.804 , acc= 75.6%
Test: loss=0.789 , acc= 74.6%
Test: loss=0.800 , acc= 74.9%
Test: loss=0.782 , acc= 75.1%
Test: loss=0.802 , acc= 76.0%
Test: loss=0.797 , acc= 75.0%
Test: loss=0.832 , acc= 74.4%
current testing task:cifar100-4
Test: loss=0.817 , acc= 78.5%
Test: loss=0.818 , acc= 78.7%
Test: loss=0.823 , acc= 78.1%
Test: loss=0.831 , acc= 76.8%
Test: loss=0.810 , acc= 77.1%
Test: loss=0.802 , acc= 79.4%
Test: loss=0.813 , acc= 77.7%
Test: loss=0.814 , acc= 77.3%
Test: loss=0.807 , acc= 77.9%
Test: loss=0.807 , acc= 78.0%
current testing task:cifar100-5
Test: loss=0.700 , acc= 76.2%
Test: loss=0.696 , acc= 77.1%
Test: loss=0.715 , acc= 74.9%
Test: loss=0.688 , acc= 76.6%
Test: loss=0.694 , acc= 76.2%
Test: loss=0.688 , acc= 76.0%
Test: loss=0.689 , acc= 76.7%
Test: loss=0.728 , acc= 77.1%
Test: loss=0.683 , acc= 76.6%
Test: loss=0.684 , acc= 77.3%
current testing task:cifar100-6
Test: loss=0.715 , acc= 76.1%
Test: loss=0.731 , acc= 76.8%
Test: loss=0.731 , acc= 76.7%
Test: loss=0.717 , acc= 77.9%
Test: loss=0.738 , acc= 76.7%
Test: loss=0.734 , acc= 76.6%
Test: loss=0.718 , acc= 77.5%
Test: loss=0.720 , acc= 77.6%
Test: loss=0.723 , acc= 77.6%
Test: loss=0.724 , acc= 77.3%
current testing task:cifar100-7
Test: loss=0.812 , acc= 75.8%
Test: loss=0.849 , acc= 73.5%
Test: loss=0.822 , acc= 75.2%
Test: loss=0.831 , acc= 74.4%
Test: loss=0.815 , acc= 75.2%
Test: loss=0.833 , acc= 74.0%
Test: loss=0.845 , acc= 74.1%
Test: loss=0.826 , acc= 74.6%
Test: loss=0.829 , acc= 74.3%
Test: loss=0.826 , acc= 74.9%
current testing task:cifar100-8
Test: loss=0.765 , acc= 75.7%
Test: loss=0.759 , acc= 77.1%
Test: loss=0.735 , acc= 76.9%
Test: loss=0.766 , acc= 76.0%
Test: loss=0.752 , acc= 77.1%
Test: loss=0.769 , acc= 76.2%
Test: loss=0.771 , acc= 76.1%
Test: loss=0.718 , acc= 76.4%
Test: loss=0.775 , acc= 76.0%
Test: loss=0.760 , acc= 76.0%
current testing task:cifar100-9
Test: loss=0.588 , acc= 83.0%
Test: loss=0.594 , acc= 82.5%
Test: loss=0.605 , acc= 81.2%
Test: loss=0.591 , acc= 81.9%
Test: loss=0.608 , acc= 82.6%
Test: loss=0.606 , acc= 81.7%
Test: loss=0.599 , acc= 83.0%
Test: loss=0.601 , acc= 82.6%
Test: loss=0.597 , acc= 82.1%
Test: loss=0.594 , acc= 82.4%
Accuracies =
 76.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.5%  69.4%  75.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.3%  75.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.9%  69.9%  75.0%  74.9%  78.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 77.6%  69.5%  75.4%  75.1%  77.9%  76.1%   0.0%   0.0%   0.0%   0.0%
 77.6%  69.0%  75.0%  74.8%  78.0%  75.8%  77.9%   0.0%   0.0%   0.0%
 77.3%  69.5%  75.2%  74.8%  77.5%  75.8%  77.7%  74.7%   0.0%   0.0%
 77.5%  69.6%  75.2%  75.1%  78.0%  76.3%  77.4%  74.8%  76.1%   0.0%
 77.3%  69.7%  74.9%  75.1%  77.9%  76.5%  77.1%  74.6%  76.3%  82.3%
--------------------------------------------------
Task Order : [0 1 2 3 4 5 6 7 8 9]
Final Avg Accuracy: 76.18%
Backward transfer:  0.00%
[Elapsed time = 4285134.6 ms]
--------------------------------------------------
====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=64, gpm_thro=0.97, lr=0.01, lr_factor=2, lr_min=1e-05, lr_patience=6, mixup_alpha=20, mixup_weight=0.0001, momentum=0.9, n_epochs=200, pc_valid=0.05, savename='./log/DFTRGP/', seed=3)
====================================================================================================
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  0 (cifar100-0)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.01
----------------------------------------
Model parameters ---
(0, 'conv1.weight', torch.Size([64, 3, 4, 4]))
(5, 'conv2.weight', torch.Size([128, 64, 3, 3]))
(10, 'conv3.weight', torch.Size([256, 128, 2, 2]))
(15, 'fc1.weight', torch.Size([2048, 1024]))
(20, 'fc2.weight', torch.Size([2048, 2048]))
(25, 'fc3.0.weight', torch.Size([10, 2048]))
(26, 'fc3.1.weight', torch.Size([10, 2048]))
(27, 'fc3.2.weight', torch.Size([10, 2048]))
(28, 'fc3.3.weight', torch.Size([10, 2048]))
(29, 'fc3.4.weight', torch.Size([10, 2048]))
(30, 'fc3.5.weight', torch.Size([10, 2048]))
(31, 'fc3.6.weight', torch.Size([10, 2048]))
(32, 'fc3.7.weight', torch.Size([10, 2048]))
(33, 'fc3.8.weight', torch.Size([10, 2048]))
(34, 'fc3.9.weight', torch.Size([10, 2048]))
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
----------------------------------------
Test: loss=0.839 , acc= 75.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.830 , acc= 75.8%
Test: loss=0.808 , acc= 76.3%
Test: loss=0.855 , acc= 75.3%
Test: loss=0.827 , acc= 76.0%
Test: loss=0.831 , acc= 75.4%
Test: loss=0.847 , acc= 74.8%
Test: loss=0.840 , acc= 74.0%
Test: loss=0.842 , acc= 75.6%
Test: loss=0.815 , acc= 75.1%
Test: loss=0.839 , acc= 75.0%
Accuracies =
 75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  1 (cifar100-1)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.6289592331686639, threshold for regime 1:0.3248634934425354
Task:0, layer:1, space shape:(576, 141)
Task:0, Layer:1, project_norm:1.29661461619318, threshold for regime 1:0.6696614027023315
Task:0, layer:2, space shape:(512, 203)
Task:0, Layer:2, project_norm:1.4610460204387536, threshold for regime 1:0.7617443799972534
Task:0, layer:3, space shape:(1024, 76)
Task:0, Layer:3, project_norm:1.6560494899749756, threshold for regime 1:1.0290791988372803
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.092916965484619, threshold for regime 1:1.3695489168167114
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
space1 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=1.018 , acc= 68.3%
Test: loss=0.998 , acc= 67.9%
Test: loss=1.006 , acc= 68.1%
Test: loss=1.039 , acc= 67.4%
Test: loss=1.003 , acc= 67.9%
Test: loss=1.015 , acc= 68.3%
Test: loss=1.012 , acc= 68.8%
Test: loss=0.999 , acc= 68.1%
Test: loss=0.999 , acc= 68.3%
Test: loss=1.013 , acc= 68.3%
Average acc= 68.1%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 8)
threshold for selecting:38894.88060923555
total ranking r = 8
the number of space for current task:8
the new increased space:0, the threshold for new space:8
Ui shape:(48, 8)
activation shape:(576, 14400)
space shape:(576, 141)
threshold for selecting:311066.23790729867
total ranking r = 171
the number of space for current task:171
the new increased space:29, the threshold for new space:141
Ui shape:(576, 171)
activation shape:(512, 2500)
space shape:(512, 203)
threshold for selecting:65897.27819625134
total ranking r = 268
the number of space for current task:268
the new increased space:67, the threshold for new space:203
Ui shape:(512, 268)
activation shape:(1024, 125)
space shape:(1024, 76)
threshold for selecting:27790.771308085183
total ranking r = 144
the number of space for current task:144
the new increased space:85, the threshold for new space:76
Ui shape:(1024, 144)
activation shape:(2048, 125)
space shape:(2048, 95)
threshold for selecting:47290.765808897326
total ranking r = 172
the number of space for current task:172
the new increased space:118, the threshold for new space:95
Ui shape:(2048, 172)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.792 , acc= 76.6%
Test: loss=0.801 , acc= 76.2%
Test: loss=0.827 , acc= 75.6%
Test: loss=0.790 , acc= 75.3%
Test: loss=0.815 , acc= 76.1%
Test: loss=0.820 , acc= 76.0%
Test: loss=0.827 , acc= 76.3%
Test: loss=0.792 , acc= 75.5%
Test: loss=0.801 , acc= 75.8%
Test: loss=0.814 , acc= 76.9%
current testing task:cifar100-1
Test: loss=1.043 , acc= 66.7%
Test: loss=1.024 , acc= 67.2%
Test: loss=1.029 , acc= 69.2%
Test: loss=1.021 , acc= 66.8%
Test: loss=1.007 , acc= 67.5%
Test: loss=1.016 , acc= 67.7%
Test: loss=1.026 , acc= 67.8%
Test: loss=1.005 , acc= 68.4%
Test: loss=1.017 , acc= 67.8%
Test: loss=1.005 , acc= 68.2%
Accuracies =
 75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.0%  67.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  2 (cifar100-2)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.9842030784440204, threshold for regime 1:0.4982837438583374
Task:0, layer:1, space shape:(576, 141)
Task:0, Layer:1, project_norm:1.3777915537500556, threshold for regime 1:0.7085404396057129
Task:0, layer:2, space shape:(512, 203)
Task:0, Layer:2, project_norm:1.4721179983677335, threshold for regime 1:0.7648195624351501
Task:0, layer:3, space shape:(1024, 76)
Task:0, Layer:3, project_norm:1.7480711936950684, threshold for regime 1:1.0465458631515503
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.264355182647705, threshold for regime 1:1.4169460535049438
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.9842030784440204, threshold for regime 1:0.4982837438583374
Task:1, layer:1, space shape:(576, 171)
Task:1, Layer:1, project_norm:1.3869875263682168, threshold for regime 1:0.7085404396057129
Task:1, layer:2, space shape:(512, 268)
Task:1, Layer:2, project_norm:1.4902676055090895, threshold for regime 1:0.7648195624351501
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.8255177736282349, threshold for regime 1:1.0465458631515503
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.3660032749176025, threshold for regime 1:1.4169460535049438
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[0 1]
Layer:1, selected task ID:[0 1]
Layer:2, selected task ID:[0 1]
Layer:3, selected task ID:[0 1]
Layer:4, selected task ID:[0 1]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.884 , acc= 75.1%
Test: loss=0.865 , acc= 74.2%
Test: loss=0.865 , acc= 74.2%
Test: loss=0.880 , acc= 74.1%
Test: loss=0.842 , acc= 75.2%
Test: loss=0.868 , acc= 74.9%
Test: loss=0.865 , acc= 74.1%
Test: loss=0.886 , acc= 74.0%
Test: loss=0.849 , acc= 74.0%
Test: loss=0.850 , acc= 74.6%
Average acc= 74.4%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 8)
threshold for selecting:26692.31252774732
total ranking r = 7
the number of space for current task:7
the new increased space:0, the threshold for new space:8
Ui shape:(48, 7)
activation shape:(576, 14400)
space shape:(576, 170)
threshold for selecting:207781.38251630735
total ranking r = 164
the number of space for current task:164
the new increased space:9, the threshold for new space:170
Ui shape:(576, 164)
activation shape:(512, 2500)
space shape:(512, 270)
threshold for selecting:36876.61029031339
total ranking r = 266
the number of space for current task:266
the new increased space:35, the threshold for new space:270
Ui shape:(512, 266)
activation shape:(1024, 125)
space shape:(1024, 161)
threshold for selecting:17584.024190203287
total ranking r = 193
the number of space for current task:193
the new increased space:88, the threshold for new space:161
Ui shape:(1024, 193)
activation shape:(2048, 125)
space shape:(2048, 213)
threshold for selecting:33428.31047965586
total ranking r = 251
the number of space for current task:251
the new increased space:117, the threshold for new space:213
Ui shape:(2048, 251)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.801 , acc= 74.2%
Test: loss=0.805 , acc= 75.7%
Test: loss=0.814 , acc= 75.1%
Test: loss=0.813 , acc= 76.1%
Test: loss=0.800 , acc= 75.9%
Test: loss=0.805 , acc= 75.2%
Test: loss=0.813 , acc= 75.7%
Test: loss=0.823 , acc= 75.2%
Test: loss=0.824 , acc= 76.0%
Test: loss=0.797 , acc= 76.0%
current testing task:cifar100-1
Test: loss=1.020 , acc= 67.5%
Test: loss=1.027 , acc= 65.7%
Test: loss=1.026 , acc= 67.3%
Test: loss=1.018 , acc= 67.1%
Test: loss=1.036 , acc= 67.7%
Test: loss=1.012 , acc= 67.9%
Test: loss=1.014 , acc= 67.2%
Test: loss=1.008 , acc= 67.3%
Test: loss=1.022 , acc= 67.9%
Test: loss=1.044 , acc= 67.0%
current testing task:cifar100-2
Test: loss=0.854 , acc= 74.5%
Test: loss=0.851 , acc= 73.5%
Test: loss=0.856 , acc= 74.9%
Test: loss=0.848 , acc= 74.5%
Test: loss=0.861 , acc= 74.3%
Test: loss=0.860 , acc= 74.4%
Test: loss=0.869 , acc= 74.5%
Test: loss=0.857 , acc= 74.7%
Test: loss=0.879 , acc= 74.7%
Test: loss=0.865 , acc= 73.4%
Accuracies =
 75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.0%  67.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.5%  67.3%  74.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  3 (cifar100-3)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.7299198519566525, threshold for regime 1:0.372824490070343
Task:0, layer:1, space shape:(576, 141)
Task:0, Layer:1, project_norm:1.3134871708109068, threshold for regime 1:0.6790993213653564
Task:0, layer:2, space shape:(512, 203)
Task:0, Layer:2, project_norm:1.4201992615328236, threshold for regime 1:0.7428578734397888
Task:0, layer:3, space shape:(1024, 76)
Task:0, Layer:3, project_norm:1.6825485229492188, threshold for regime 1:1.0343215465545654
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.081899881362915, threshold for regime 1:1.3705552816390991
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.7299198519566525, threshold for regime 1:0.372824490070343
Task:1, layer:1, space shape:(576, 171)
Task:1, Layer:1, project_norm:1.3239078959769683, threshold for regime 1:0.6790993213653564
Task:1, layer:2, space shape:(512, 268)
Task:1, Layer:2, project_norm:1.4411772069996396, threshold for regime 1:0.7428578734397888
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.7704827785491943, threshold for regime 1:1.0343215465545654
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.207517623901367, threshold for regime 1:1.3705552816390991
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 7)
Task:2, Layer:0, project_norm:0.7191328158052117, threshold for regime 1:0.372824490070343
Task:2, layer:1, space shape:(576, 164)
Task:2, Layer:1, project_norm:1.3220033798192197, threshold for regime 1:0.6790993213653564
Task:2, layer:2, space shape:(512, 266)
Task:2, Layer:2, project_norm:1.4397205935051336, threshold for regime 1:0.7428578734397888
Task:2, layer:3, space shape:(1024, 193)
Task:2, Layer:3, project_norm:1.8114417791366577, threshold for regime 1:1.0343215465545654
Task:2, layer:4, space shape:(2048, 251)
Task:2, Layer:4, project_norm:2.294010877609253, threshold for regime 1:1.3705552816390991
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[1 0]
Layer:1, selected task ID:[2 1]
Layer:2, selected task ID:[2 1]
Layer:3, selected task ID:[1 2]
Layer:4, selected task ID:[1 2]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.883 , acc= 74.1%
Test: loss=0.878 , acc= 73.1%
Test: loss=0.895 , acc= 73.8%
Test: loss=0.875 , acc= 74.1%
Test: loss=0.921 , acc= 72.0%
Test: loss=0.883 , acc= 74.1%
Test: loss=0.853 , acc= 74.6%
Test: loss=0.878 , acc= 72.9%
Test: loss=0.861 , acc= 73.4%
Test: loss=0.905 , acc= 73.5%
Average acc= 73.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 8)
threshold for selecting:26748.465021570006
total ranking r = 9
the number of space for current task:9
the new increased space:0, the threshold for new space:8
Ui shape:(48, 9)
activation shape:(576, 14400)
space shape:(576, 179)
threshold for selecting:224226.9138371157
total ranking r = 186
the number of space for current task:186
the new increased space:13, the threshold for new space:179
Ui shape:(576, 186)
activation shape:(512, 2500)
space shape:(512, 305)
threshold for selecting:33647.0196668178
total ranking r = 290
the number of space for current task:290
the new increased space:30, the threshold for new space:305
Ui shape:(512, 290)
activation shape:(1024, 125)
space shape:(1024, 249)
threshold for selecting:15783.352450058388
total ranking r = 266
the number of space for current task:266
the new increased space:100, the threshold for new space:249
Ui shape:(1024, 266)
activation shape:(2048, 125)
space shape:(2048, 330)
threshold for selecting:30768.84603691497
total ranking r = 354
the number of space for current task:354
the new increased space:123, the threshold for new space:330
Ui shape:(2048, 354)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.792 , acc= 76.1%
Test: loss=0.812 , acc= 75.8%
Test: loss=0.808 , acc= 74.9%
Test: loss=0.808 , acc= 75.6%
Test: loss=0.805 , acc= 75.6%
Test: loss=0.814 , acc= 75.4%
Test: loss=0.801 , acc= 76.5%
Test: loss=0.795 , acc= 75.6%
Test: loss=0.812 , acc= 75.0%
Test: loss=0.802 , acc= 75.7%
current testing task:cifar100-1
Test: loss=0.988 , acc= 69.0%
Test: loss=1.016 , acc= 68.3%
Test: loss=0.995 , acc= 68.0%
Test: loss=1.015 , acc= 66.8%
Test: loss=0.997 , acc= 67.9%
Test: loss=1.003 , acc= 68.4%
Test: loss=1.001 , acc= 69.0%
Test: loss=1.010 , acc= 69.6%
Test: loss=1.036 , acc= 68.0%
Test: loss=0.989 , acc= 68.6%
current testing task:cifar100-2
Test: loss=0.844 , acc= 75.0%
Test: loss=0.858 , acc= 74.7%
Test: loss=0.844 , acc= 74.7%
Test: loss=0.846 , acc= 74.5%
Test: loss=0.869 , acc= 73.4%
Test: loss=0.844 , acc= 75.2%
Test: loss=0.839 , acc= 75.7%
Test: loss=0.879 , acc= 73.5%
Test: loss=0.852 , acc= 74.3%
Test: loss=0.858 , acc= 74.1%
current testing task:cifar100-3
Test: loss=0.865 , acc= 74.2%
Test: loss=0.892 , acc= 73.4%
Test: loss=0.878 , acc= 73.3%
Test: loss=0.875 , acc= 74.4%
Test: loss=0.876 , acc= 74.6%
Test: loss=0.849 , acc= 74.6%
Test: loss=0.884 , acc= 74.4%
Test: loss=0.891 , acc= 73.3%
Test: loss=0.876 , acc= 73.1%
Test: loss=0.873 , acc= 74.6%
Accuracies =
 75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.0%  67.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.5%  67.3%  74.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.6%  68.4%  74.5%  74.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  4 (cifar100-4)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.768712468340754, threshold for regime 1:0.39306268095970154
Task:0, layer:1, space shape:(576, 141)
Task:0, Layer:1, project_norm:1.3399998259346677, threshold for regime 1:0.6960405111312866
Task:0, layer:2, space shape:(512, 203)
Task:0, Layer:2, project_norm:1.5029274328691273, threshold for regime 1:0.7834466695785522
Task:0, layer:3, space shape:(1024, 76)
Task:0, Layer:3, project_norm:1.786635398864746, threshold for regime 1:1.0706923007965088
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.311513662338257, threshold for regime 1:1.4497220516204834
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.768712468340754, threshold for regime 1:0.39306268095970154
Task:1, layer:1, space shape:(576, 171)
Task:1, Layer:1, project_norm:1.3530968652789586, threshold for regime 1:0.6960405111312866
Task:1, layer:2, space shape:(512, 268)
Task:1, Layer:2, project_norm:1.5229168407717528, threshold for regime 1:0.7834466695785522
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.8727357387542725, threshold for regime 1:1.0706923007965088
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.428966760635376, threshold for regime 1:1.4497220516204834
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 7)
Task:2, Layer:0, project_norm:0.7589625998131565, threshold for regime 1:0.39306268095970154
Task:2, layer:1, space shape:(576, 164)
Task:2, Layer:1, project_norm:1.3509951450102229, threshold for regime 1:0.6960405111312866
Task:2, layer:2, space shape:(512, 266)
Task:2, Layer:2, project_norm:1.5213963361953513, threshold for regime 1:0.7834466695785522
Task:2, layer:3, space shape:(1024, 193)
Task:2, Layer:3, project_norm:1.901761770248413, threshold for regime 1:1.0706923007965088
Task:2, layer:4, space shape:(2048, 251)
Task:2, Layer:4, project_norm:2.4972243309020996, threshold for regime 1:1.4497220516204834
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.771877372872781, threshold for regime 1:0.39306268095970154
Task:3, layer:1, space shape:(576, 186)
Task:3, Layer:1, project_norm:1.358024667942109, threshold for regime 1:0.6960405111312866
Task:3, layer:2, space shape:(512, 290)
Task:3, Layer:2, project_norm:1.5279735304060325, threshold for regime 1:0.7834466695785522
Task:3, layer:3, space shape:(1024, 266)
Task:3, Layer:3, project_norm:1.9469377994537354, threshold for regime 1:1.0706923007965088
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.568695306777954, threshold for regime 1:1.4497220516204834
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[0 3]
Layer:1, selected task ID:[1 3]
Layer:2, selected task ID:[1 3]
Layer:3, selected task ID:[2 3]
Layer:4, selected task ID:[2 3]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.809 , acc= 77.5%
Test: loss=0.840 , acc= 76.7%
Test: loss=0.854 , acc= 76.9%
Test: loss=0.818 , acc= 76.7%
Test: loss=0.851 , acc= 76.6%
Test: loss=0.821 , acc= 77.3%
Test: loss=0.817 , acc= 77.2%
Test: loss=0.827 , acc= 77.0%
Test: loss=0.810 , acc= 77.3%
Test: loss=0.840 , acc= 77.4%
Average acc= 77.1%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 8)
threshold for selecting:38025.64384950942
total ranking r = 9
the number of space for current task:9
the new increased space:0, the threshold for new space:8
Ui shape:(48, 9)
activation shape:(576, 14400)
space shape:(576, 192)
threshold for selecting:231960.51719685874
total ranking r = 195
the number of space for current task:195
the new increased space:9, the threshold for new space:192
Ui shape:(576, 195)
activation shape:(512, 2500)
space shape:(512, 335)
threshold for selecting:29010.541990751466
total ranking r = 295
the number of space for current task:295
the new increased space:21, the threshold for new space:335
Ui shape:(512, 295)
activation shape:(1024, 125)
space shape:(1024, 349)
threshold for selecting:12298.86956550181
total ranking r = 330
the number of space for current task:330
the new increased space:97, the threshold for new space:349
Ui shape:(1024, 330)
activation shape:(2048, 125)
space shape:(2048, 453)
threshold for selecting:24963.56604192499
total ranking r = 446
the number of space for current task:446
the new increased space:124, the threshold for new space:453
Ui shape:(2048, 446)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.801 , acc= 76.3%
Test: loss=0.798 , acc= 76.0%
Test: loss=0.806 , acc= 75.5%
Test: loss=0.829 , acc= 75.9%
Test: loss=0.811 , acc= 75.9%
Test: loss=0.791 , acc= 77.2%
Test: loss=0.818 , acc= 76.2%
Test: loss=0.786 , acc= 77.7%
Test: loss=0.796 , acc= 75.1%
Test: loss=0.785 , acc= 76.6%
current testing task:cifar100-1
Test: loss=1.002 , acc= 67.9%
Test: loss=1.028 , acc= 67.7%
Test: loss=1.010 , acc= 68.5%
Test: loss=1.008 , acc= 67.1%
Test: loss=1.003 , acc= 68.4%
Test: loss=1.022 , acc= 67.3%
Test: loss=1.011 , acc= 68.2%
Test: loss=1.004 , acc= 68.6%
Test: loss=1.012 , acc= 67.1%
Test: loss=1.011 , acc= 68.2%
current testing task:cifar100-2
Test: loss=0.850 , acc= 74.8%
Test: loss=0.857 , acc= 74.0%
Test: loss=0.836 , acc= 75.1%
Test: loss=0.845 , acc= 75.1%
Test: loss=0.879 , acc= 74.0%
Test: loss=0.834 , acc= 75.5%
Test: loss=0.868 , acc= 74.6%
Test: loss=0.832 , acc= 75.2%
Test: loss=0.862 , acc= 75.7%
Test: loss=0.844 , acc= 75.0%
current testing task:cifar100-3
Test: loss=0.876 , acc= 74.3%
Test: loss=0.868 , acc= 74.7%
Test: loss=0.868 , acc= 73.3%
Test: loss=0.891 , acc= 73.2%
Test: loss=0.878 , acc= 73.2%
Test: loss=0.876 , acc= 74.1%
Test: loss=0.902 , acc= 73.8%
Test: loss=0.884 , acc= 73.7%
Test: loss=0.877 , acc= 73.7%
Test: loss=0.905 , acc= 73.7%
current testing task:cifar100-4
Test: loss=0.840 , acc= 76.6%
Test: loss=0.813 , acc= 77.1%
Test: loss=0.826 , acc= 78.0%
Test: loss=0.814 , acc= 77.6%
Test: loss=0.824 , acc= 77.8%
Test: loss=0.813 , acc= 77.3%
Test: loss=0.842 , acc= 76.8%
Test: loss=0.832 , acc= 76.5%
Test: loss=0.825 , acc= 76.9%
Test: loss=0.838 , acc= 77.2%
Accuracies =
 75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.0%  67.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.5%  67.3%  74.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.6%  68.4%  74.5%  74.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.2%  67.9%  74.9%  73.8%  77.2%   0.0%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  5 (cifar100-5)
****************************************************************************************************
----------------------------------------
Task ID :5 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.7286853098670827, threshold for regime 1:0.37202024459838867
Task:0, layer:1, space shape:(576, 141)
Task:0, Layer:1, project_norm:1.2891998277875751, threshold for regime 1:0.6679151654243469
Task:0, layer:2, space shape:(512, 203)
Task:0, Layer:2, project_norm:1.4885899511990763, threshold for regime 1:0.7740984559059143
Task:0, layer:3, space shape:(1024, 76)
Task:0, Layer:3, project_norm:1.8203247785568237, threshold for regime 1:1.0898061990737915
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.491755247116089, threshold for regime 1:1.5365939140319824
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.7286853098670827, threshold for regime 1:0.37202024459838867
Task:1, layer:1, space shape:(576, 171)
Task:1, Layer:1, project_norm:1.2999337370693018, threshold for regime 1:0.6679151654243469
Task:1, layer:2, space shape:(512, 268)
Task:1, Layer:2, project_norm:1.507237317701069, threshold for regime 1:0.7740984559059143
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.9049146175384521, threshold for regime 1:1.0898061990737915
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.606419086456299, threshold for regime 1:1.5365939140319824
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 7)
Task:2, Layer:0, project_norm:0.7165865420567616, threshold for regime 1:0.37202024459838867
Task:2, layer:1, space shape:(576, 164)
Task:2, Layer:1, project_norm:1.2986238171479323, threshold for regime 1:0.6679151654243469
Task:2, layer:2, space shape:(512, 266)
Task:2, Layer:2, project_norm:1.5060023845442816, threshold for regime 1:0.7740984559059143
Task:2, layer:3, space shape:(1024, 193)
Task:2, Layer:3, project_norm:1.9428874254226685, threshold for regime 1:1.0898061990737915
Task:2, layer:4, space shape:(2048, 251)
Task:2, Layer:4, project_norm:2.681978464126587, threshold for regime 1:1.5365939140319824
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.7307698823226576, threshold for regime 1:0.37202024459838867
Task:3, layer:1, space shape:(576, 186)
Task:3, Layer:1, project_norm:1.305047644085214, threshold for regime 1:0.6679151654243469
Task:3, layer:2, space shape:(512, 290)
Task:3, Layer:2, project_norm:1.512182002219137, threshold for regime 1:0.7740984559059143
Task:3, layer:3, space shape:(1024, 266)
Task:3, Layer:3, project_norm:1.9856282472610474, threshold for regime 1:1.0898061990737915
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.752239942550659, threshold for regime 1:1.5365939140319824
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 9)
Task:4, Layer:0, project_norm:0.7314637389965111, threshold for regime 1:0.37202024459838867
Task:4, layer:1, space shape:(576, 195)
Task:4, Layer:1, project_norm:1.3077148915744268, threshold for regime 1:0.6679151654243469
Task:4, layer:2, space shape:(512, 295)
Task:4, Layer:2, project_norm:1.5125750346401774, threshold for regime 1:0.7740984559059143
Task:4, layer:3, space shape:(1024, 330)
Task:4, Layer:3, project_norm:2.016094207763672, threshold for regime 1:1.0898061990737915
Task:4, layer:4, space shape:(2048, 446)
Task:4, Layer:4, project_norm:2.7981066703796387, threshold for regime 1:1.5365939140319824
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[3 4]
Layer:1, selected task ID:[3 4]
Layer:2, selected task ID:[3 4]
Layer:3, selected task ID:[3 4]
Layer:4, selected task ID:[3 4]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.713 , acc= 76.5%
Test: loss=0.706 , acc= 76.2%
Test: loss=0.712 , acc= 75.9%
Test: loss=0.702 , acc= 77.5%
Test: loss=0.686 , acc= 76.8%
Test: loss=0.693 , acc= 76.7%
Test: loss=0.691 , acc= 77.1%
Test: loss=0.682 , acc= 76.6%
Test: loss=0.690 , acc= 76.7%
Test: loss=0.703 , acc= 78.0%
Average acc= 76.8%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 8)
threshold for selecting:35687.44750688251
total ranking r = 8
the number of space for current task:8
the new increased space:0, the threshold for new space:8
Ui shape:(48, 8)
activation shape:(576, 14400)
space shape:(576, 201)
threshold for selecting:204668.90209148946
total ranking r = 197
the number of space for current task:197
the new increased space:8, the threshold for new space:201
Ui shape:(576, 197)
activation shape:(512, 2500)
space shape:(512, 356)
threshold for selecting:24215.10868669092
total ranking r = 301
the number of space for current task:301
the new increased space:15, the threshold for new space:356
Ui shape:(512, 301)
activation shape:(1024, 125)
space shape:(1024, 446)
threshold for selecting:10141.661814551859
total ranking r = 403
the number of space for current task:403
the new increased space:98, the threshold for new space:446
Ui shape:(1024, 403)
activation shape:(2048, 125)
space shape:(2048, 577)
threshold for selecting:22309.60402194434
total ranking r = 556
the number of space for current task:556
the new increased space:123, the threshold for new space:577
Ui shape:(2048, 556)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.797 , acc= 77.0%
Test: loss=0.787 , acc= 77.0%
Test: loss=0.762 , acc= 77.2%
Test: loss=0.796 , acc= 76.8%
Test: loss=0.789 , acc= 77.0%
Test: loss=0.784 , acc= 75.7%
Test: loss=0.804 , acc= 76.3%
Test: loss=0.803 , acc= 76.1%
Test: loss=0.787 , acc= 77.2%
Test: loss=0.810 , acc= 75.8%
current testing task:cifar100-1
Test: loss=0.979 , acc= 68.7%
Test: loss=1.027 , acc= 65.7%
Test: loss=1.018 , acc= 67.8%
Test: loss=1.013 , acc= 67.1%
Test: loss=0.981 , acc= 68.7%
Test: loss=1.001 , acc= 67.9%
Test: loss=1.015 , acc= 67.1%
Test: loss=0.996 , acc= 67.8%
Test: loss=1.020 , acc= 67.4%
Test: loss=1.001 , acc= 67.8%
current testing task:cifar100-2
Test: loss=0.849 , acc= 73.9%
Test: loss=0.835 , acc= 75.2%
Test: loss=0.851 , acc= 74.5%
Test: loss=0.861 , acc= 74.1%
Test: loss=0.855 , acc= 74.5%
Test: loss=0.853 , acc= 74.7%
Test: loss=0.837 , acc= 74.4%
Test: loss=0.863 , acc= 73.7%
Test: loss=0.865 , acc= 74.4%
Test: loss=0.835 , acc= 73.6%
current testing task:cifar100-3
Test: loss=0.895 , acc= 74.0%
Test: loss=0.892 , acc= 74.6%
Test: loss=0.866 , acc= 73.7%
Test: loss=0.906 , acc= 73.2%
Test: loss=0.890 , acc= 73.7%
Test: loss=0.874 , acc= 74.0%
Test: loss=0.857 , acc= 73.8%
Test: loss=0.877 , acc= 74.4%
Test: loss=0.880 , acc= 73.9%
Test: loss=0.893 , acc= 72.7%
current testing task:cifar100-4
Test: loss=0.846 , acc= 76.8%
Test: loss=0.842 , acc= 77.0%
Test: loss=0.820 , acc= 78.0%
Test: loss=0.835 , acc= 76.9%
Test: loss=0.810 , acc= 76.4%
Test: loss=0.843 , acc= 76.5%
Test: loss=0.829 , acc= 77.4%
Test: loss=0.833 , acc= 76.5%
Test: loss=0.840 , acc= 76.6%
Test: loss=0.847 , acc= 75.9%
current testing task:cifar100-5
Test: loss=0.704 , acc= 76.9%
Test: loss=0.704 , acc= 75.3%
Test: loss=0.697 , acc= 77.2%
Test: loss=0.702 , acc= 76.9%
Test: loss=0.698 , acc= 76.5%
Test: loss=0.712 , acc= 76.7%
Test: loss=0.698 , acc= 77.3%
Test: loss=0.690 , acc= 76.7%
Test: loss=0.719 , acc= 76.6%
Test: loss=0.699 , acc= 76.4%
Accuracies =
 75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.0%  67.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.5%  67.3%  74.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.6%  68.4%  74.5%  74.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.2%  67.9%  74.9%  73.8%  77.2%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  67.6%  74.3%  73.8%  76.8%  76.7%   0.0%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  6 (cifar100-6)
****************************************************************************************************
----------------------------------------
Task ID :6 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.7179726781848624, threshold for regime 1:0.3644949495792389
Task:0, layer:1, space shape:(576, 141)
Task:0, Layer:1, project_norm:1.262627099186452, threshold for regime 1:0.6528863906860352
Task:0, layer:2, space shape:(512, 203)
Task:0, Layer:2, project_norm:1.4334367741658864, threshold for regime 1:0.7442657947540283
Task:0, layer:3, space shape:(1024, 76)
Task:0, Layer:3, project_norm:1.8284763097763062, threshold for regime 1:1.0849273204803467
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.4314730167388916, threshold for regime 1:1.5020527839660645
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.7179726781848624, threshold for regime 1:0.3644949495792389
Task:1, layer:1, space shape:(576, 171)
Task:1, Layer:1, project_norm:1.2727154810003496, threshold for regime 1:0.6528863906860352
Task:1, layer:2, space shape:(512, 268)
Task:1, Layer:2, project_norm:1.4512664359386385, threshold for regime 1:0.7442657947540283
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.924259066581726, threshold for regime 1:1.0849273204803467
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.56575345993042, threshold for regime 1:1.5020527839660645
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 7)
Task:2, Layer:0, project_norm:0.7033461668244843, threshold for regime 1:0.3644949495792389
Task:2, layer:1, space shape:(576, 164)
Task:2, Layer:1, project_norm:1.2713785157571231, threshold for regime 1:0.6528863906860352
Task:2, layer:2, space shape:(512, 266)
Task:2, Layer:2, project_norm:1.450152079681893, threshold for regime 1:0.7442657947540283
Task:2, layer:3, space shape:(1024, 193)
Task:2, Layer:3, project_norm:1.9534225463867188, threshold for regime 1:1.0849273204803467
Task:2, layer:4, space shape:(2048, 251)
Task:2, Layer:4, project_norm:2.634568691253662, threshold for regime 1:1.5020527839660645
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.7193015275667172, threshold for regime 1:0.3644949495792389
Task:3, layer:1, space shape:(576, 186)
Task:3, Layer:1, project_norm:1.277802936246116, threshold for regime 1:0.6528863906860352
Task:3, layer:2, space shape:(512, 290)
Task:3, Layer:2, project_norm:1.4557735430851633, threshold for regime 1:0.7442657947540283
Task:3, layer:3, space shape:(1024, 266)
Task:3, Layer:3, project_norm:1.9930715560913086, threshold for regime 1:1.0849273204803467
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.697965145111084, threshold for regime 1:1.5020527839660645
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 9)
Task:4, Layer:0, project_norm:0.7202094310184848, threshold for regime 1:0.3644949495792389
Task:4, layer:1, space shape:(576, 195)
Task:4, Layer:1, project_norm:1.2797782697881255, threshold for regime 1:0.6528863906860352
Task:4, layer:2, space shape:(512, 295)
Task:4, Layer:2, project_norm:1.4565757463911435, threshold for regime 1:0.7442657947540283
Task:4, layer:3, space shape:(1024, 330)
Task:4, Layer:3, project_norm:2.0206782817840576, threshold for regime 1:1.0849273204803467
Task:4, layer:4, space shape:(2048, 446)
Task:4, Layer:4, project_norm:2.738905906677246, threshold for regime 1:1.5020527839660645
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 8)
Task:5, Layer:0, project_norm:0.7179726781848624, threshold for regime 1:0.3644949495792389
Task:5, layer:1, space shape:(576, 197)
Task:5, Layer:1, project_norm:1.2807908710704665, threshold for regime 1:0.6528863906860352
Task:5, layer:2, space shape:(512, 301)
Task:5, Layer:2, project_norm:1.458156978962281, threshold for regime 1:0.7442657947540283
Task:5, layer:3, space shape:(1024, 403)
Task:5, Layer:3, project_norm:2.0444467067718506, threshold for regime 1:1.0849273204803467
Task:5, layer:4, space shape:(2048, 556)
Task:5, Layer:4, project_norm:2.776388168334961, threshold for regime 1:1.5020527839660645
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[3 4]
Layer:1, selected task ID:[4 5]
Layer:2, selected task ID:[4 5]
Layer:3, selected task ID:[4 5]
Layer:4, selected task ID:[4 5]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.724 , acc= 77.4%
Test: loss=0.703 , acc= 78.1%
Test: loss=0.699 , acc= 78.9%
Test: loss=0.704 , acc= 78.4%
Test: loss=0.707 , acc= 78.9%
Test: loss=0.703 , acc= 78.2%
Test: loss=0.692 , acc= 78.2%
Test: loss=0.716 , acc= 78.5%
Test: loss=0.691 , acc= 78.3%
Test: loss=0.696 , acc= 78.4%
Average acc= 78.3%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 8)
threshold for selecting:22285.796268389862
total ranking r = 7
the number of space for current task:7
the new increased space:0, the threshold for new space:8
Ui shape:(48, 7)
activation shape:(576, 14400)
space shape:(576, 209)
threshold for selecting:181182.31506844133
total ranking r = 194
the number of space for current task:194
the new increased space:5, the threshold for new space:209
Ui shape:(576, 194)
activation shape:(512, 2500)
space shape:(512, 371)
threshold for selecting:19256.703671606552
total ranking r = 296
the number of space for current task:296
the new increased space:10, the threshold for new space:371
Ui shape:(512, 296)
activation shape:(1024, 125)
space shape:(1024, 544)
threshold for selecting:7472.297417362279
total ranking r = 471
the number of space for current task:471
the new increased space:86, the threshold for new space:544
Ui shape:(1024, 471)
activation shape:(2048, 125)
space shape:(2048, 700)
threshold for selecting:18186.474848542362
total ranking r = 647
the number of space for current task:647
the new increased space:123, the threshold for new space:700
Ui shape:(2048, 647)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.810 , acc= 76.2%
Test: loss=0.751 , acc= 76.5%
Test: loss=0.775 , acc= 77.1%
Test: loss=0.772 , acc= 76.1%
Test: loss=0.808 , acc= 75.9%
Test: loss=0.813 , acc= 76.5%
Test: loss=0.785 , acc= 76.0%
Test: loss=0.786 , acc= 76.5%
Test: loss=0.794 , acc= 75.9%
Test: loss=0.799 , acc= 77.0%
current testing task:cifar100-1
Test: loss=1.023 , acc= 67.0%
Test: loss=1.000 , acc= 68.2%
Test: loss=0.997 , acc= 68.7%
Test: loss=1.019 , acc= 67.9%
Test: loss=1.023 , acc= 66.8%
Test: loss=1.022 , acc= 67.6%
Test: loss=0.999 , acc= 68.3%
Test: loss=1.000 , acc= 67.4%
Test: loss=1.016 , acc= 67.9%
Test: loss=1.021 , acc= 67.5%
current testing task:cifar100-2
Test: loss=0.856 , acc= 73.0%
Test: loss=0.836 , acc= 74.1%
Test: loss=0.822 , acc= 74.6%
Test: loss=0.826 , acc= 74.9%
Test: loss=0.855 , acc= 74.7%
Test: loss=0.804 , acc= 75.3%
Test: loss=0.835 , acc= 74.9%
Test: loss=0.848 , acc= 73.9%
Test: loss=0.817 , acc= 74.9%
Test: loss=0.847 , acc= 74.3%
current testing task:cifar100-3
Test: loss=0.896 , acc= 73.5%
Test: loss=0.879 , acc= 75.0%
Test: loss=0.872 , acc= 73.9%
Test: loss=0.866 , acc= 73.9%
Test: loss=0.876 , acc= 73.6%
Test: loss=0.856 , acc= 75.2%
Test: loss=0.865 , acc= 74.1%
Test: loss=0.873 , acc= 74.3%
Test: loss=0.861 , acc= 74.7%
Test: loss=0.873 , acc= 74.9%
current testing task:cifar100-4
Test: loss=0.814 , acc= 77.0%
Test: loss=0.798 , acc= 76.5%
Test: loss=0.832 , acc= 78.2%
Test: loss=0.828 , acc= 76.6%
Test: loss=0.814 , acc= 77.0%
Test: loss=0.840 , acc= 76.2%
Test: loss=0.813 , acc= 76.2%
Test: loss=0.822 , acc= 77.0%
Test: loss=0.819 , acc= 78.0%
Test: loss=0.830 , acc= 76.9%
current testing task:cifar100-5
Test: loss=0.685 , acc= 77.1%
Test: loss=0.684 , acc= 76.8%
Test: loss=0.675 , acc= 77.4%
Test: loss=0.697 , acc= 77.8%
Test: loss=0.694 , acc= 77.6%
Test: loss=0.678 , acc= 76.5%
Test: loss=0.702 , acc= 76.8%
Test: loss=0.703 , acc= 77.6%
Test: loss=0.704 , acc= 77.0%
Test: loss=0.697 , acc= 77.3%
current testing task:cifar100-6
Test: loss=0.696 , acc= 79.3%
Test: loss=0.711 , acc= 77.9%
Test: loss=0.717 , acc= 78.8%
Test: loss=0.709 , acc= 79.2%
Test: loss=0.698 , acc= 78.1%
Test: loss=0.734 , acc= 77.7%
Test: loss=0.700 , acc= 78.8%
Test: loss=0.715 , acc= 78.2%
Test: loss=0.710 , acc= 78.5%
Test: loss=0.734 , acc= 78.3%
Accuracies =
 75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.0%  67.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.5%  67.3%  74.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.6%  68.4%  74.5%  74.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.2%  67.9%  74.9%  73.8%  77.2%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  67.6%  74.3%  73.8%  76.8%  76.7%   0.0%   0.0%   0.0%   0.0%
 76.4%  67.7%  74.5%  74.3%  77.0%  77.2%  78.5%   0.0%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  7 (cifar100-7)
****************************************************************************************************
----------------------------------------
Task ID :7 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.8805391625359275, threshold for regime 1:0.44474199414253235
Task:0, layer:1, space shape:(576, 141)
Task:0, Layer:1, project_norm:1.361558070834832, threshold for regime 1:0.7049404978752136
Task:0, layer:2, space shape:(512, 203)
Task:0, Layer:2, project_norm:1.5416353574476198, threshold for regime 1:0.8001933693885803
Task:0, layer:3, space shape:(1024, 76)
Task:0, Layer:3, project_norm:1.8218882083892822, threshold for regime 1:1.0835723876953125
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.3427045345306396, threshold for regime 1:1.4656809568405151
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.8805391625359275, threshold for regime 1:0.44474199414253235
Task:1, layer:1, space shape:(576, 171)
Task:1, Layer:1, project_norm:1.3731554053073753, threshold for regime 1:0.7049404978752136
Task:1, layer:2, space shape:(512, 268)
Task:1, Layer:2, project_norm:1.560134769507981, threshold for regime 1:0.8001933693885803
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.9051021337509155, threshold for regime 1:1.0835723876953125
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.4599108695983887, threshold for regime 1:1.4656809568405151
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 7)
Task:2, Layer:0, project_norm:0.831149292796905, threshold for regime 1:0.44474199414253235
Task:2, layer:1, space shape:(576, 164)
Task:2, Layer:1, project_norm:1.3714778690924467, threshold for regime 1:0.7049404978752136
Task:2, layer:2, space shape:(512, 266)
Task:2, Layer:2, project_norm:1.5592159022527217, threshold for regime 1:0.8001933693885803
Task:2, layer:3, space shape:(1024, 193)
Task:2, Layer:3, project_norm:1.93865168094635, threshold for regime 1:1.0835723876953125
Task:2, layer:4, space shape:(2048, 251)
Task:2, Layer:4, project_norm:2.5384416580200195, threshold for regime 1:1.4656809568405151
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.8815005764530476, threshold for regime 1:0.44474199414253235
Task:3, layer:1, space shape:(576, 186)
Task:3, Layer:1, project_norm:1.3786595887753634, threshold for regime 1:0.7049404978752136
Task:3, layer:2, space shape:(512, 290)
Task:3, Layer:2, project_norm:1.5648768616143525, threshold for regime 1:0.8001933693885803
Task:3, layer:3, space shape:(1024, 266)
Task:3, Layer:3, project_norm:1.9793615341186523, threshold for regime 1:1.0835723876953125
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.6006057262420654, threshold for regime 1:1.4656809568405151
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 9)
Task:4, Layer:0, project_norm:0.8812744366565963, threshold for regime 1:0.44474199414253235
Task:4, layer:1, space shape:(576, 195)
Task:4, Layer:1, project_norm:1.3807952780197268, threshold for regime 1:0.7049404978752136
Task:4, layer:2, space shape:(512, 295)
Task:4, Layer:2, project_norm:1.5657601038836515, threshold for regime 1:0.8001933693885803
Task:4, layer:3, space shape:(1024, 330)
Task:4, Layer:3, project_norm:2.007230043411255, threshold for regime 1:1.0835723876953125
Task:4, layer:4, space shape:(2048, 446)
Task:4, Layer:4, project_norm:2.6483278274536133, threshold for regime 1:1.4656809568405151
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 8)
Task:5, Layer:0, project_norm:0.8805391625359275, threshold for regime 1:0.44474199414253235
Task:5, layer:1, space shape:(576, 197)
Task:5, Layer:1, project_norm:1.381497238404718, threshold for regime 1:0.7049404978752136
Task:5, layer:2, space shape:(512, 301)
Task:5, Layer:2, project_norm:1.567668630198893, threshold for regime 1:0.8001933693885803
Task:5, layer:3, space shape:(1024, 403)
Task:5, Layer:3, project_norm:2.0344161987304688, threshold for regime 1:1.0835723876953125
Task:5, layer:4, space shape:(2048, 556)
Task:5, Layer:4, project_norm:2.686464309692383, threshold for regime 1:1.4656809568405151
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:6, layer:0, space shape:(48, 7)
Task:6, Layer:0, project_norm:0.8777995187376674, threshold for regime 1:0.44474199414253235
Task:6, layer:1, space shape:(576, 194)
Task:6, Layer:1, project_norm:1.3806780162186625, threshold for regime 1:0.7049404978752136
Task:6, layer:2, space shape:(512, 296)
Task:6, Layer:2, project_norm:1.5665039039327862, threshold for regime 1:0.8001933693885803
Task:6, layer:3, space shape:(1024, 471)
Task:6, Layer:3, project_norm:2.0571813583374023, threshold for regime 1:1.0835723876953125
Task:6, layer:4, space shape:(2048, 647)
Task:6, Layer:4, project_norm:2.718356132507324, threshold for regime 1:1.4656809568405151
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[4 3]
Layer:1, selected task ID:[4 5]
Layer:2, selected task ID:[6 5]
Layer:3, selected task ID:[5 6]
Layer:4, selected task ID:[5 6]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.825 , acc= 75.0%
Test: loss=0.829 , acc= 74.8%
Test: loss=0.807 , acc= 76.5%
Test: loss=0.820 , acc= 74.7%
Test: loss=0.845 , acc= 74.8%
Test: loss=0.804 , acc= 75.2%
Test: loss=0.835 , acc= 74.9%
Test: loss=0.822 , acc= 75.4%
Test: loss=0.782 , acc= 75.8%
Test: loss=0.804 , acc= 75.3%
Average acc= 75.2%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 8)
threshold for selecting:27381.468614831792
total ranking r = 8
the number of space for current task:8
the new increased space:0, the threshold for new space:8
Ui shape:(48, 8)
activation shape:(576, 14400)
space shape:(576, 214)
threshold for selecting:192727.88364874033
total ranking r = 201
the number of space for current task:201
the new increased space:3, the threshold for new space:214
Ui shape:(576, 201)
activation shape:(512, 2500)
space shape:(512, 381)
threshold for selecting:18292.87611120383
total ranking r = 303
the number of space for current task:303
the new increased space:7, the threshold for new space:381
Ui shape:(512, 303)
activation shape:(1024, 125)
space shape:(1024, 630)
threshold for selecting:5819.327286892571
total ranking r = 533
the number of space for current task:533
the new increased space:81, the threshold for new space:630
Ui shape:(1024, 533)
activation shape:(2048, 125)
space shape:(2048, 823)
threshold for selecting:15724.473460862646
total ranking r = 752
the number of space for current task:752
the new increased space:120, the threshold for new space:823
Ui shape:(2048, 752)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.791 , acc= 77.3%
Test: loss=0.770 , acc= 77.6%
Test: loss=0.785 , acc= 78.3%
Test: loss=0.784 , acc= 76.1%
Test: loss=0.788 , acc= 77.0%
Test: loss=0.764 , acc= 76.5%
Test: loss=0.784 , acc= 77.1%
Test: loss=0.780 , acc= 76.8%
Test: loss=0.782 , acc= 77.8%
Test: loss=0.798 , acc= 75.9%
current testing task:cifar100-1
Test: loss=0.996 , acc= 68.3%
Test: loss=1.012 , acc= 68.8%
Test: loss=1.026 , acc= 68.1%
Test: loss=1.024 , acc= 67.1%
Test: loss=1.004 , acc= 67.6%
Test: loss=1.016 , acc= 67.8%
Test: loss=0.994 , acc= 68.6%
Test: loss=1.020 , acc= 68.2%
Test: loss=1.021 , acc= 68.3%
Test: loss=0.986 , acc= 69.4%
current testing task:cifar100-2
Test: loss=0.853 , acc= 74.6%
Test: loss=0.825 , acc= 74.5%
Test: loss=0.821 , acc= 74.3%
Test: loss=0.848 , acc= 74.3%
Test: loss=0.826 , acc= 75.0%
Test: loss=0.827 , acc= 74.4%
Test: loss=0.847 , acc= 74.8%
Test: loss=0.852 , acc= 74.7%
Test: loss=0.843 , acc= 74.6%
Test: loss=0.835 , acc= 74.6%
current testing task:cifar100-3
Test: loss=0.847 , acc= 73.6%
Test: loss=0.843 , acc= 74.6%
Test: loss=0.863 , acc= 74.2%
Test: loss=0.846 , acc= 74.1%
Test: loss=0.845 , acc= 74.7%
Test: loss=0.850 , acc= 73.8%
Test: loss=0.868 , acc= 73.7%
Test: loss=0.868 , acc= 73.6%
Test: loss=0.868 , acc= 73.7%
Test: loss=0.865 , acc= 74.0%
current testing task:cifar100-4
Test: loss=0.829 , acc= 76.5%
Test: loss=0.794 , acc= 78.3%
Test: loss=0.821 , acc= 77.3%
Test: loss=0.806 , acc= 76.5%
Test: loss=0.790 , acc= 77.8%
Test: loss=0.809 , acc= 78.2%
Test: loss=0.819 , acc= 76.7%
Test: loss=0.803 , acc= 77.7%
Test: loss=0.820 , acc= 76.6%
Test: loss=0.809 , acc= 78.2%
current testing task:cifar100-5
Test: loss=0.663 , acc= 78.2%
Test: loss=0.677 , acc= 77.5%
Test: loss=0.709 , acc= 76.1%
Test: loss=0.697 , acc= 76.8%
Test: loss=0.709 , acc= 76.5%
Test: loss=0.688 , acc= 77.7%
Test: loss=0.693 , acc= 77.5%
Test: loss=0.714 , acc= 76.6%
Test: loss=0.696 , acc= 77.4%
Test: loss=0.691 , acc= 75.9%
current testing task:cifar100-6
Test: loss=0.701 , acc= 78.7%
Test: loss=0.714 , acc= 78.3%
Test: loss=0.705 , acc= 79.5%
Test: loss=0.699 , acc= 79.0%
Test: loss=0.687 , acc= 78.8%
Test: loss=0.696 , acc= 78.8%
Test: loss=0.701 , acc= 78.4%
Test: loss=0.708 , acc= 78.3%
Test: loss=0.703 , acc= 79.4%
Test: loss=0.712 , acc= 78.4%
current testing task:cifar100-7
Test: loss=0.808 , acc= 74.8%
Test: loss=0.806 , acc= 75.8%
Test: loss=0.793 , acc= 75.8%
Test: loss=0.832 , acc= 75.1%
Test: loss=0.843 , acc= 74.5%
Test: loss=0.821 , acc= 75.9%
Test: loss=0.827 , acc= 75.1%
Test: loss=0.803 , acc= 75.4%
Test: loss=0.822 , acc= 75.5%
Test: loss=0.812 , acc= 75.3%
Accuracies =
 75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.0%  67.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.5%  67.3%  74.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.6%  68.4%  74.5%  74.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.2%  67.9%  74.9%  73.8%  77.2%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  67.6%  74.3%  73.8%  76.8%  76.7%   0.0%   0.0%   0.0%   0.0%
 76.4%  67.7%  74.5%  74.3%  77.0%  77.2%  78.5%   0.0%   0.0%   0.0%
 77.0%  68.2%  74.6%  74.0%  77.4%  77.0%  78.8%  75.3%   0.0%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  8 (cifar100-8)
****************************************************************************************************
----------------------------------------
Task ID :8 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.7192195941747663, threshold for regime 1:0.3667411506175995
Task:0, layer:1, space shape:(576, 141)
Task:0, Layer:1, project_norm:1.2641358660273767, threshold for regime 1:0.6641022562980652
Task:0, layer:2, space shape:(512, 203)
Task:0, Layer:2, project_norm:1.4196702331168363, threshold for regime 1:0.745491623878479
Task:0, layer:3, space shape:(1024, 76)
Task:0, Layer:3, project_norm:1.7582405805587769, threshold for regime 1:1.06301748752594
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.3812918663024902, threshold for regime 1:1.4899260997772217
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.7192195941747663, threshold for regime 1:0.3667411506175995
Task:1, layer:1, space shape:(576, 171)
Task:1, Layer:1, project_norm:1.2810313584096078, threshold for regime 1:0.6641022562980652
Task:1, layer:2, space shape:(512, 268)
Task:1, Layer:2, project_norm:1.4425185597516461, threshold for regime 1:0.745491623878479
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.8481322526931763, threshold for regime 1:1.06301748752594
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.505647659301758, threshold for regime 1:1.4899260997772217
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 7)
Task:2, Layer:0, project_norm:0.7035482564660948, threshold for regime 1:0.3667411506175995
Task:2, layer:1, space shape:(576, 164)
Task:2, Layer:1, project_norm:1.2784996556575823, threshold for regime 1:0.6641022562980652
Task:2, layer:2, space shape:(512, 266)
Task:2, Layer:2, project_norm:1.4405899566839955, threshold for regime 1:0.745491623878479
Task:2, layer:3, space shape:(1024, 193)
Task:2, Layer:3, project_norm:1.880886197090149, threshold for regime 1:1.06301748752594
Task:2, layer:4, space shape:(2048, 251)
Task:2, Layer:4, project_norm:2.580307722091675, threshold for regime 1:1.4899260997772217
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.720925811612269, threshold for regime 1:0.3667411506175995
Task:3, layer:1, space shape:(576, 186)
Task:3, Layer:1, project_norm:1.287736956713302, threshold for regime 1:0.6641022562980652
Task:3, layer:2, space shape:(512, 290)
Task:3, Layer:2, project_norm:1.4483567508287511, threshold for regime 1:0.745491623878479
Task:3, layer:3, space shape:(1024, 266)
Task:3, Layer:3, project_norm:1.9241615533828735, threshold for regime 1:1.06301748752594
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.6459741592407227, threshold for regime 1:1.4899260997772217
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 9)
Task:4, Layer:0, project_norm:0.7212754910548551, threshold for regime 1:0.3667411506175995
Task:4, layer:1, space shape:(576, 195)
Task:4, Layer:1, project_norm:1.291199132979552, threshold for regime 1:0.6641022562980652
Task:4, layer:2, space shape:(512, 295)
Task:4, Layer:2, project_norm:1.449461768432189, threshold for regime 1:0.745491623878479
Task:4, layer:3, space shape:(1024, 330)
Task:4, Layer:3, project_norm:1.9555312395095825, threshold for regime 1:1.06301748752594
Task:4, layer:4, space shape:(2048, 446)
Task:4, Layer:4, project_norm:2.689021348953247, threshold for regime 1:1.4899260997772217
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 8)
Task:5, Layer:0, project_norm:0.7192195941747663, threshold for regime 1:0.3667411506175995
Task:5, layer:1, space shape:(576, 197)
Task:5, Layer:1, project_norm:1.292062077965811, threshold for regime 1:0.6641022562980652
Task:5, layer:2, space shape:(512, 301)
Task:5, Layer:2, project_norm:1.4518361914962468, threshold for regime 1:0.745491623878479
Task:5, layer:3, space shape:(1024, 403)
Task:5, Layer:3, project_norm:1.984362244606018, threshold for regime 1:1.06301748752594
Task:5, layer:4, space shape:(2048, 556)
Task:5, Layer:4, project_norm:2.7334861755371094, threshold for regime 1:1.4899260997772217
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:6, layer:0, space shape:(48, 7)
Task:6, Layer:0, project_norm:0.7156891256083142, threshold for regime 1:0.3667411506175995
Task:6, layer:1, space shape:(576, 194)
Task:6, Layer:1, project_norm:1.291193070376016, threshold for regime 1:0.6641022562980652
Task:6, layer:2, space shape:(512, 296)
Task:6, Layer:2, project_norm:1.4501473277689678, threshold for regime 1:0.745491623878479
Task:6, layer:3, space shape:(1024, 471)
Task:6, Layer:3, project_norm:2.007035970687866, threshold for regime 1:1.06301748752594
Task:6, layer:4, space shape:(2048, 647)
Task:6, Layer:4, project_norm:2.758319139480591, threshold for regime 1:1.4899260997772217
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:7, layer:0, space shape:(48, 8)
Task:7, Layer:0, project_norm:0.7192195941747663, threshold for regime 1:0.3667411506175995
Task:7, layer:1, space shape:(576, 201)
Task:7, Layer:1, project_norm:1.2936416113987528, threshold for regime 1:0.6641022562980652
Task:7, layer:2, space shape:(512, 303)
Task:7, Layer:2, project_norm:1.4521844592772872, threshold for regime 1:0.745491623878479
Task:7, layer:3, space shape:(1024, 533)
Task:7, Layer:3, project_norm:2.0240743160247803, threshold for regime 1:1.06301748752594
Task:7, layer:4, space shape:(2048, 752)
Task:7, Layer:4, project_norm:2.7892186641693115, threshold for regime 1:1.4899260997772217
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[3 4]
Layer:1, selected task ID:[5 7]
Layer:2, selected task ID:[5 7]
Layer:3, selected task ID:[6 7]
Layer:4, selected task ID:[6 7]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.789 , acc= 76.7%
Test: loss=0.765 , acc= 75.0%
Test: loss=0.754 , acc= 76.8%
Test: loss=0.761 , acc= 77.0%
Test: loss=0.769 , acc= 76.1%
Test: loss=0.771 , acc= 76.6%
Test: loss=0.784 , acc= 76.1%
Test: loss=0.769 , acc= 76.9%
Test: loss=0.785 , acc= 76.8%
Test: loss=0.760 , acc= 76.7%
Average acc= 76.5%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 8)
threshold for selecting:37906.84789157094
total ranking r = 10
the number of space for current task:10
the new increased space:1, the threshold for new space:8
Ui shape:(48, 10)
activation shape:(576, 14400)
space shape:(576, 217)
threshold for selecting:210480.43263357805
total ranking r = 216
the number of space for current task:216
the new increased space:9, the threshold for new space:217
Ui shape:(576, 216)
activation shape:(512, 2500)
space shape:(512, 388)
threshold for selecting:19313.950960698243
total ranking r = 320
the number of space for current task:320
the new increased space:9, the threshold for new space:388
Ui shape:(512, 320)
activation shape:(1024, 125)
space shape:(1024, 711)
threshold for selecting:4934.847044435388
total ranking r = 601
the number of space for current task:601
the new increased space:77, the threshold for new space:711
Ui shape:(1024, 601)
activation shape:(2048, 125)
space shape:(2048, 943)
threshold for selecting:14513.508328183147
total ranking r = 859
the number of space for current task:859
the new increased space:123, the threshold for new space:943
Ui shape:(2048, 859)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.809 , acc= 76.9%
Test: loss=0.795 , acc= 77.1%
Test: loss=0.801 , acc= 77.0%
Test: loss=0.791 , acc= 76.1%
Test: loss=0.789 , acc= 76.8%
Test: loss=0.763 , acc= 75.9%
Test: loss=0.782 , acc= 76.5%
Test: loss=0.778 , acc= 76.6%
Test: loss=0.792 , acc= 77.3%
Test: loss=0.789 , acc= 77.2%
current testing task:cifar100-1
Test: loss=0.997 , acc= 68.1%
Test: loss=1.014 , acc= 67.7%
Test: loss=1.020 , acc= 67.9%
Test: loss=1.007 , acc= 68.4%
Test: loss=1.000 , acc= 68.0%
Test: loss=1.013 , acc= 67.2%
Test: loss=0.995 , acc= 67.6%
Test: loss=1.034 , acc= 66.9%
Test: loss=1.008 , acc= 69.6%
Test: loss=0.994 , acc= 68.2%
current testing task:cifar100-2
Test: loss=0.854 , acc= 74.5%
Test: loss=0.840 , acc= 73.9%
Test: loss=0.854 , acc= 74.3%
Test: loss=0.838 , acc= 73.9%
Test: loss=0.833 , acc= 74.8%
Test: loss=0.826 , acc= 74.3%
Test: loss=0.852 , acc= 74.1%
Test: loss=0.824 , acc= 74.4%
Test: loss=0.850 , acc= 73.4%
Test: loss=0.853 , acc= 74.0%
current testing task:cifar100-3
Test: loss=0.880 , acc= 74.1%
Test: loss=0.868 , acc= 73.9%
Test: loss=0.885 , acc= 73.4%
Test: loss=0.874 , acc= 72.8%
Test: loss=0.872 , acc= 74.1%
Test: loss=0.859 , acc= 74.6%
Test: loss=0.868 , acc= 73.2%
Test: loss=0.866 , acc= 74.8%
Test: loss=0.869 , acc= 74.6%
Test: loss=0.884 , acc= 73.7%
current testing task:cifar100-4
Test: loss=0.813 , acc= 76.7%
Test: loss=0.818 , acc= 77.9%
Test: loss=0.830 , acc= 76.6%
Test: loss=0.811 , acc= 77.6%
Test: loss=0.830 , acc= 76.3%
Test: loss=0.803 , acc= 77.0%
Test: loss=0.824 , acc= 75.8%
Test: loss=0.842 , acc= 75.8%
Test: loss=0.804 , acc= 78.0%
Test: loss=0.827 , acc= 77.2%
current testing task:cifar100-5
Test: loss=0.681 , acc= 77.5%
Test: loss=0.701 , acc= 76.5%
Test: loss=0.692 , acc= 77.2%
Test: loss=0.705 , acc= 76.8%
Test: loss=0.740 , acc= 75.2%
Test: loss=0.718 , acc= 76.8%
Test: loss=0.702 , acc= 76.1%
Test: loss=0.684 , acc= 76.3%
Test: loss=0.688 , acc= 77.2%
Test: loss=0.709 , acc= 76.4%
current testing task:cifar100-6
Test: loss=0.728 , acc= 78.2%
Test: loss=0.703 , acc= 77.9%
Test: loss=0.712 , acc= 78.5%
Test: loss=0.701 , acc= 77.9%
Test: loss=0.707 , acc= 78.9%
Test: loss=0.719 , acc= 77.5%
Test: loss=0.725 , acc= 78.1%
Test: loss=0.698 , acc= 77.9%
Test: loss=0.688 , acc= 78.1%
Test: loss=0.733 , acc= 77.4%
current testing task:cifar100-7
Test: loss=0.815 , acc= 76.4%
Test: loss=0.826 , acc= 75.3%
Test: loss=0.827 , acc= 75.7%
Test: loss=0.810 , acc= 75.3%
Test: loss=0.807 , acc= 75.3%
Test: loss=0.808 , acc= 75.9%
Test: loss=0.820 , acc= 74.3%
Test: loss=0.818 , acc= 76.1%
Test: loss=0.810 , acc= 74.9%
Test: loss=0.800 , acc= 75.8%
current testing task:cifar100-8
Test: loss=0.781 , acc= 76.3%
Test: loss=0.782 , acc= 75.7%
Test: loss=0.785 , acc= 77.3%
Test: loss=0.780 , acc= 77.0%
Test: loss=0.785 , acc= 75.8%
Test: loss=0.770 , acc= 77.1%
Test: loss=0.816 , acc= 76.7%
Test: loss=0.762 , acc= 77.4%
Test: loss=0.768 , acc= 76.3%
Test: loss=0.788 , acc= 76.3%
Accuracies =
 75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.0%  67.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.5%  67.3%  74.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.6%  68.4%  74.5%  74.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.2%  67.9%  74.9%  73.8%  77.2%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  67.6%  74.3%  73.8%  76.8%  76.7%   0.0%   0.0%   0.0%   0.0%
 76.4%  67.7%  74.5%  74.3%  77.0%  77.2%  78.5%   0.0%   0.0%   0.0%
 77.0%  68.2%  74.6%  74.0%  77.4%  77.0%  78.8%  75.3%   0.0%   0.0%
 76.7%  68.0%  74.2%  73.9%  76.9%  76.6%  78.0%  75.5%  76.6%   0.0%
thresholds: [0.97 0.97 0.97 0.97 0.97]
****************************************************************************************************
Task  9 (cifar100-9)
****************************************************************************************************
----------------------------------------
Task ID :9 | Learning Rate : 0.01
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([48, 48])
Layer 2 - Projection Matrix shape: torch.Size([576, 576])
Layer 3 - Projection Matrix shape: torch.Size([512, 512])
Layer 4 - Projection Matrix shape: torch.Size([1024, 1024])
Layer 5 - Projection Matrix shape: torch.Size([2048, 2048])
=== excute gradient projection condition
Task:0, layer:0, space shape:(48, 8)
Task:0, Layer:0, project_norm:0.9764173337461425, threshold for regime 1:0.4927264153957367
Task:0, layer:1, space shape:(576, 141)
Task:0, Layer:1, project_norm:1.3234607506052911, threshold for regime 1:0.6885181665420532
Task:0, layer:2, space shape:(512, 203)
Task:0, Layer:2, project_norm:1.4544550285428917, threshold for regime 1:0.7588090300559998
Task:0, layer:3, space shape:(1024, 76)
Task:0, Layer:3, project_norm:1.8116707801818848, threshold for regime 1:1.0755738019943237
Task:0, layer:4, space shape:(2048, 95)
Task:0, Layer:4, project_norm:2.4379560947418213, threshold for regime 1:1.5122977495193481
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:1, layer:0, space shape:(48, 8)
Task:1, Layer:0, project_norm:0.9764173337461424, threshold for regime 1:0.4927264153957367
Task:1, layer:1, space shape:(576, 171)
Task:1, Layer:1, project_norm:1.336997042853516, threshold for regime 1:0.6885181665420532
Task:1, layer:2, space shape:(512, 268)
Task:1, Layer:2, project_norm:1.4740375750665837, threshold for regime 1:0.7588090300559998
Task:1, layer:3, space shape:(1024, 144)
Task:1, Layer:3, project_norm:1.8918706178665161, threshold for regime 1:1.0755738019943237
Task:1, layer:4, space shape:(2048, 172)
Task:1, Layer:4, project_norm:2.5461533069610596, threshold for regime 1:1.5122977495193481
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:2, layer:0, space shape:(48, 7)
Task:2, Layer:0, project_norm:0.9568070155379422, threshold for regime 1:0.4927264153957367
Task:2, layer:1, space shape:(576, 164)
Task:2, Layer:1, project_norm:1.3347036698266606, threshold for regime 1:0.6885181665420532
Task:2, layer:2, space shape:(512, 266)
Task:2, Layer:2, project_norm:1.4726861749767668, threshold for regime 1:0.7588090300559998
Task:2, layer:3, space shape:(1024, 193)
Task:2, Layer:3, project_norm:1.9289774894714355, threshold for regime 1:1.0755738019943237
Task:2, layer:4, space shape:(2048, 251)
Task:2, Layer:4, project_norm:2.639651298522949, threshold for regime 1:1.5122977495193481
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:3, layer:0, space shape:(48, 9)
Task:3, Layer:0, project_norm:0.9771654577142243, threshold for regime 1:0.4927264153957367
Task:3, layer:1, space shape:(576, 186)
Task:3, Layer:1, project_norm:1.342857769964278, threshold for regime 1:0.6885181665420532
Task:3, layer:2, space shape:(512, 290)
Task:3, Layer:2, project_norm:1.4796586960429607, threshold for regime 1:0.7588090300559998
Task:3, layer:3, space shape:(1024, 266)
Task:3, Layer:3, project_norm:1.9678807258605957, threshold for regime 1:1.0755738019943237
Task:3, layer:4, space shape:(2048, 354)
Task:3, Layer:4, project_norm:2.7069790363311768, threshold for regime 1:1.5122977495193481
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:4, layer:0, space shape:(48, 9)
Task:4, Layer:0, project_norm:0.978009020319699, threshold for regime 1:0.4927264153957367
Task:4, layer:1, space shape:(576, 195)
Task:4, Layer:1, project_norm:1.3455188913607934, threshold for regime 1:0.6885181665420532
Task:4, layer:2, space shape:(512, 295)
Task:4, Layer:2, project_norm:1.4806279817855148, threshold for regime 1:0.7588090300559998
Task:4, layer:3, space shape:(1024, 330)
Task:4, Layer:3, project_norm:1.9949513673782349, threshold for regime 1:1.0755738019943237
Task:4, layer:4, space shape:(2048, 446)
Task:4, Layer:4, project_norm:2.751483201980591, threshold for regime 1:1.5122977495193481
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:5, layer:0, space shape:(48, 8)
Task:5, Layer:0, project_norm:0.9764173337461424, threshold for regime 1:0.4927264153957367
Task:5, layer:1, space shape:(576, 197)
Task:5, Layer:1, project_norm:1.3468049853026103, threshold for regime 1:0.6885181665420532
Task:5, layer:2, space shape:(512, 301)
Task:5, Layer:2, project_norm:1.4821500727899422, threshold for regime 1:0.7588090300559998
Task:5, layer:3, space shape:(1024, 403)
Task:5, Layer:3, project_norm:2.021106243133545, threshold for regime 1:1.0755738019943237
Task:5, layer:4, space shape:(2048, 556)
Task:5, Layer:4, project_norm:2.7930097579956055, threshold for regime 1:1.5122977495193481
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:6, layer:0, space shape:(48, 7)
Task:6, Layer:0, project_norm:0.9731934721049592, threshold for regime 1:0.4927264153957367
Task:6, layer:1, space shape:(576, 194)
Task:6, Layer:1, project_norm:1.3455768799355323, threshold for regime 1:0.6885181665420532
Task:6, layer:2, space shape:(512, 296)
Task:6, Layer:2, project_norm:1.4809957366344924, threshold for regime 1:0.7588090300559998
Task:6, layer:3, space shape:(1024, 471)
Task:6, Layer:3, project_norm:2.0446014404296875, threshold for regime 1:1.0755738019943237
Task:6, layer:4, space shape:(2048, 647)
Task:6, Layer:4, project_norm:2.8220810890197754, threshold for regime 1:1.5122977495193481
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:7, layer:0, space shape:(48, 8)
Task:7, Layer:0, project_norm:0.9764173337461425, threshold for regime 1:0.4927264153957367
Task:7, layer:1, space shape:(576, 201)
Task:7, Layer:1, project_norm:1.3478735327160554, threshold for regime 1:0.6885181665420532
Task:7, layer:2, space shape:(512, 303)
Task:7, Layer:2, project_norm:1.4827954241927659, threshold for regime 1:0.7588090300559998
Task:7, layer:3, space shape:(1024, 533)
Task:7, Layer:3, project_norm:2.05936861038208, threshold for regime 1:1.0755738019943237
Task:7, layer:4, space shape:(2048, 752)
Task:7, Layer:4, project_norm:2.8470709323883057, threshold for regime 1:1.5122977495193481
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Task:8, layer:0, space shape:(48, 10)
Task:8, Layer:0, project_norm:0.9791052392154304, threshold for regime 1:0.4927264153957367
Task:8, layer:1, space shape:(576, 216)
Task:8, Layer:1, project_norm:1.3520823449452206, threshold for regime 1:0.6885181665420532
Task:8, layer:2, space shape:(512, 320)
Task:8, Layer:2, project_norm:1.4864494447088181, threshold for regime 1:0.7588090300559998
Task:8, layer:3, space shape:(1024, 601)
Task:8, Layer:3, project_norm:2.0754075050354004, threshold for regime 1:1.0755738019943237
Task:8, layer:4, space shape:(2048, 859)
Task:8, Layer:4, project_norm:2.872657299041748, threshold for regime 1:1.5122977495193481
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
--------------------
selected top-2 tasks:
Layer:0, selected task ID:[4 8]
Layer:1, selected task ID:[7 8]
Layer:2, selected task ID:[7 8]
Layer:3, selected task ID:[7 8]
Layer:4, selected task ID:[7 8]
space1 is not None!
space2 is not None!
----------------------------------------
 lr=5.0e-03
 lr=2.5e-03
 lr=1.3e-03
 lr=6.3e-04
 lr=3.1e-04
 lr=1.6e-04
 lr=7.8e-05
 lr=3.9e-05
 lr=2.0e-05
 lr=9.8e-06
Test: loss=0.639 , acc= 80.9%
Test: loss=0.652 , acc= 80.9%
Test: loss=0.640 , acc= 81.3%
Test: loss=0.654 , acc= 80.9%
Test: loss=0.653 , acc= 81.4%
Test: loss=0.671 , acc= 80.7%
Test: loss=0.643 , acc= 81.5%
Test: loss=0.651 , acc= 81.1%
Test: loss=0.660 , acc= 81.5%
Test: loss=0.659 , acc= 81.3%
Average acc= 81.1%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (48, 20184)
Layer 2 : (576, 14400)
Layer 3 : (512, 2500)
Layer 4 : (1024, 125)
Layer 5 : (2048, 125)
------------------------------
Threshold:[0.97 0.97 0.97 0.97 0.97]
activation shape:(48, 20184)
space shape:(48, 9)
threshold for selecting:27811.435372741755
total ranking r = 9
the number of space for current task:9
the new increased space:0, the threshold for new space:9
Ui shape:(48, 9)
activation shape:(576, 14400)
space shape:(576, 226)
threshold for selecting:191626.45851640566
total ranking r = 213
the number of space for current task:213
the new increased space:3, the threshold for new space:226
Ui shape:(576, 213)
activation shape:(512, 2500)
space shape:(512, 397)
threshold for selecting:17684.019569995275
total ranking r = 319
the number of space for current task:319
the new increased space:6, the threshold for new space:397
Ui shape:(512, 319)
activation shape:(1024, 125)
space shape:(1024, 788)
threshold for selecting:3439.0691908752196
total ranking r = 645
the number of space for current task:645
the new increased space:59, the threshold for new space:788
Ui shape:(1024, 645)
activation shape:(2048, 125)
space shape:(2048, 1066)
threshold for selecting:12111.108963399252
total ranking r = 962
the number of space for current task:962
the new increased space:121, the threshold for new space:1066
Ui shape:(2048, 962)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar100-0
Test: loss=0.780 , acc= 76.8%
Test: loss=0.782 , acc= 76.7%
Test: loss=0.776 , acc= 77.7%
Test: loss=0.793 , acc= 75.7%
Test: loss=0.792 , acc= 76.7%
Test: loss=0.793 , acc= 76.0%
Test: loss=0.775 , acc= 76.6%
Test: loss=0.772 , acc= 77.0%
Test: loss=0.815 , acc= 75.7%
Test: loss=0.773 , acc= 77.7%
current testing task:cifar100-1
Test: loss=1.022 , acc= 68.5%
Test: loss=1.014 , acc= 68.5%
Test: loss=1.032 , acc= 69.0%
Test: loss=1.025 , acc= 68.4%
Test: loss=1.009 , acc= 67.5%
Test: loss=1.033 , acc= 67.1%
Test: loss=0.999 , acc= 68.8%
Test: loss=1.022 , acc= 67.4%
Test: loss=1.041 , acc= 68.5%
Test: loss=1.008 , acc= 68.6%
current testing task:cifar100-2
Test: loss=0.826 , acc= 74.1%
Test: loss=0.862 , acc= 74.1%
Test: loss=0.843 , acc= 74.9%
Test: loss=0.843 , acc= 74.9%
Test: loss=0.838 , acc= 74.6%
Test: loss=0.821 , acc= 75.6%
Test: loss=0.846 , acc= 74.5%
Test: loss=0.833 , acc= 74.7%
Test: loss=0.834 , acc= 74.4%
Test: loss=0.861 , acc= 74.0%
current testing task:cifar100-3
Test: loss=0.882 , acc= 73.0%
Test: loss=0.868 , acc= 73.7%
Test: loss=0.864 , acc= 74.8%
Test: loss=0.861 , acc= 73.6%
Test: loss=0.863 , acc= 73.7%
Test: loss=0.907 , acc= 73.4%
Test: loss=0.864 , acc= 73.7%
Test: loss=0.884 , acc= 74.6%
Test: loss=0.875 , acc= 73.5%
Test: loss=0.874 , acc= 73.9%
current testing task:cifar100-4
Test: loss=0.799 , acc= 77.4%
Test: loss=0.808 , acc= 76.3%
Test: loss=0.790 , acc= 76.8%
Test: loss=0.785 , acc= 77.7%
Test: loss=0.802 , acc= 77.2%
Test: loss=0.783 , acc= 77.6%
Test: loss=0.797 , acc= 76.9%
Test: loss=0.833 , acc= 76.1%
Test: loss=0.800 , acc= 77.1%
Test: loss=0.800 , acc= 76.2%
current testing task:cifar100-5
Test: loss=0.679 , acc= 76.6%
Test: loss=0.699 , acc= 76.4%
Test: loss=0.684 , acc= 77.3%
Test: loss=0.676 , acc= 77.3%
Test: loss=0.712 , acc= 76.5%
Test: loss=0.719 , acc= 76.0%
Test: loss=0.729 , acc= 76.2%
Test: loss=0.704 , acc= 76.2%
Test: loss=0.698 , acc= 75.4%
Test: loss=0.671 , acc= 78.1%
current testing task:cifar100-6
Test: loss=0.728 , acc= 78.9%
Test: loss=0.709 , acc= 79.2%
Test: loss=0.710 , acc= 78.9%
Test: loss=0.740 , acc= 77.6%
Test: loss=0.731 , acc= 78.7%
Test: loss=0.705 , acc= 79.2%
Test: loss=0.718 , acc= 77.5%
Test: loss=0.721 , acc= 77.7%
Test: loss=0.721 , acc= 78.4%
Test: loss=0.713 , acc= 78.5%
current testing task:cifar100-7
Test: loss=0.832 , acc= 74.4%
Test: loss=0.826 , acc= 76.7%
Test: loss=0.802 , acc= 76.1%
Test: loss=0.801 , acc= 76.1%
Test: loss=0.800 , acc= 75.5%
Test: loss=0.816 , acc= 75.7%
Test: loss=0.826 , acc= 75.4%
Test: loss=0.809 , acc= 75.9%
Test: loss=0.811 , acc= 76.3%
Test: loss=0.796 , acc= 75.6%
current testing task:cifar100-8
Test: loss=0.775 , acc= 75.7%
Test: loss=0.754 , acc= 76.7%
Test: loss=0.771 , acc= 76.9%
Test: loss=0.800 , acc= 76.0%
Test: loss=0.775 , acc= 77.1%
Test: loss=0.784 , acc= 76.0%
Test: loss=0.774 , acc= 75.9%
Test: loss=0.755 , acc= 77.5%
Test: loss=0.780 , acc= 75.6%
Test: loss=0.776 , acc= 77.5%
current testing task:cifar100-9
Test: loss=0.672 , acc= 80.8%
Test: loss=0.646 , acc= 81.7%
Test: loss=0.667 , acc= 81.4%
Test: loss=0.654 , acc= 80.1%
Test: loss=0.636 , acc= 81.5%
Test: loss=0.634 , acc= 82.2%
Test: loss=0.665 , acc= 81.6%
Test: loss=0.645 , acc= 81.0%
Test: loss=0.670 , acc= 80.5%
Test: loss=0.666 , acc= 81.1%
Accuracies =
 75.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.0%  67.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.5%  67.3%  74.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 75.6%  68.4%  74.5%  74.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.2%  67.9%  74.9%  73.8%  77.2%   0.0%   0.0%   0.0%   0.0%   0.0%
 76.6%  67.6%  74.3%  73.8%  76.8%  76.7%   0.0%   0.0%   0.0%   0.0%
 76.4%  67.7%  74.5%  74.3%  77.0%  77.2%  78.5%   0.0%   0.0%   0.0%
 77.0%  68.2%  74.6%  74.0%  77.4%  77.0%  78.8%  75.3%   0.0%   0.0%
 76.7%  68.0%  74.2%  73.9%  76.9%  76.6%  78.0%  75.5%  76.6%   0.0%
 76.7%  68.2%  74.6%  73.8%  76.9%  76.6%  78.5%  75.8%  76.5%  81.2%
--------------------------------------------------
Task Order : [0 1 2 3 4 5 6 7 8 9]
Final Avg Accuracy: 75.87%
Backward transfer:  0.21%
[Elapsed time = 4275685.1 ms]
--------------------------------------------------
mixup_weight: 0.0001
gpm_thro: 0.97
Accuracy: [76.408, 76.18400000000001, 75.87]
Backward transfer: [0.27777777777778095, 0.0011111111111069426, 0.2111111111111149]
Final Avg Accuracy: 76.15%, std: 0.22
Final Avg Backward transfer:  0.16%, std: 0.12
