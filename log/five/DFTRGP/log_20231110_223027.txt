====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=64, gpm_thro=0.96, lr=0.1, lr_factor=3, lr_min=0.001, lr_patience=5, mixup_alpha=1, mixup_weight=0.01, momentum=0.9, n_epochs=100, pc_valid=0.05, savename='./log/DFTRGP/', seed=1)
====================================================================================================
****************************************************************************************************
Task  0 (cifar10)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.1
----------------------------------------
(0, 'conv1.weight', torch.Size([20, 3, 3, 3]))
(1, 'conv1.scale1', torch.Size([27, 27]))
(2, 'conv1.scale2', torch.Size([27, 27]))
(3, 'bn1.weight', torch.Size([20]))
(4, 'bn1.bias', torch.Size([20]))
(5, 'layer1.0.conv1.weight', torch.Size([20, 20, 3, 3]))
(6, 'layer1.0.conv1.scale1', torch.Size([180, 180]))
(7, 'layer1.0.conv1.scale2', torch.Size([180, 180]))
(8, 'layer1.0.bn1.weight', torch.Size([20]))
(9, 'layer1.0.bn1.bias', torch.Size([20]))
(10, 'layer1.0.conv2.weight', torch.Size([20, 20, 3, 3]))
(11, 'layer1.0.conv2.scale1', torch.Size([180, 180]))
(12, 'layer1.0.conv2.scale2', torch.Size([180, 180]))
(13, 'layer1.0.bn2.weight', torch.Size([20]))
(14, 'layer1.0.bn2.bias', torch.Size([20]))
(15, 'layer1.1.conv1.weight', torch.Size([20, 20, 3, 3]))
(16, 'layer1.1.conv1.scale1', torch.Size([180, 180]))
(17, 'layer1.1.conv1.scale2', torch.Size([180, 180]))
(18, 'layer1.1.bn1.weight', torch.Size([20]))
(19, 'layer1.1.bn1.bias', torch.Size([20]))
(20, 'layer1.1.conv2.weight', torch.Size([20, 20, 3, 3]))
(21, 'layer1.1.conv2.scale1', torch.Size([180, 180]))
(22, 'layer1.1.conv2.scale2', torch.Size([180, 180]))
(23, 'layer1.1.bn2.weight', torch.Size([20]))
(24, 'layer1.1.bn2.bias', torch.Size([20]))
(25, 'layer2.0.conv1.weight', torch.Size([40, 20, 3, 3]))
(26, 'layer2.0.conv1.scale1', torch.Size([180, 180]))
(27, 'layer2.0.conv1.scale2', torch.Size([180, 180]))
(28, 'layer2.0.bn1.weight', torch.Size([40]))
(29, 'layer2.0.bn1.bias', torch.Size([40]))
(30, 'layer2.0.conv2.weight', torch.Size([40, 40, 3, 3]))
(31, 'layer2.0.conv2.scale1', torch.Size([360, 360]))
(32, 'layer2.0.conv2.scale2', torch.Size([360, 360]))
(33, 'layer2.0.bn2.weight', torch.Size([40]))
(34, 'layer2.0.bn2.bias', torch.Size([40]))
(35, 'layer2.0.shortcut.0.weight', torch.Size([40, 20, 1, 1]))
(36, 'layer2.0.shortcut.0.scale1', torch.Size([20, 20]))
(37, 'layer2.0.shortcut.0.scale2', torch.Size([20, 20]))
(38, 'layer2.0.shortcut.1.weight', torch.Size([40]))
(39, 'layer2.0.shortcut.1.bias', torch.Size([40]))
(40, 'layer2.1.conv1.weight', torch.Size([40, 40, 3, 3]))
(41, 'layer2.1.conv1.scale1', torch.Size([360, 360]))
(42, 'layer2.1.conv1.scale2', torch.Size([360, 360]))
(43, 'layer2.1.bn1.weight', torch.Size([40]))
(44, 'layer2.1.bn1.bias', torch.Size([40]))
(45, 'layer2.1.conv2.weight', torch.Size([40, 40, 3, 3]))
(46, 'layer2.1.conv2.scale1', torch.Size([360, 360]))
(47, 'layer2.1.conv2.scale2', torch.Size([360, 360]))
(48, 'layer2.1.bn2.weight', torch.Size([40]))
(49, 'layer2.1.bn2.bias', torch.Size([40]))
(50, 'layer3.0.conv1.weight', torch.Size([80, 40, 3, 3]))
(51, 'layer3.0.conv1.scale1', torch.Size([360, 360]))
(52, 'layer3.0.conv1.scale2', torch.Size([360, 360]))
(53, 'layer3.0.bn1.weight', torch.Size([80]))
(54, 'layer3.0.bn1.bias', torch.Size([80]))
(55, 'layer3.0.conv2.weight', torch.Size([80, 80, 3, 3]))
(56, 'layer3.0.conv2.scale1', torch.Size([720, 720]))
(57, 'layer3.0.conv2.scale2', torch.Size([720, 720]))
(58, 'layer3.0.bn2.weight', torch.Size([80]))
(59, 'layer3.0.bn2.bias', torch.Size([80]))
(60, 'layer3.0.shortcut.0.weight', torch.Size([80, 40, 1, 1]))
(61, 'layer3.0.shortcut.0.scale1', torch.Size([40, 40]))
(62, 'layer3.0.shortcut.0.scale2', torch.Size([40, 40]))
(63, 'layer3.0.shortcut.1.weight', torch.Size([80]))
(64, 'layer3.0.shortcut.1.bias', torch.Size([80]))
(65, 'layer3.1.conv1.weight', torch.Size([80, 80, 3, 3]))
(66, 'layer3.1.conv1.scale1', torch.Size([720, 720]))
(67, 'layer3.1.conv1.scale2', torch.Size([720, 720]))
(68, 'layer3.1.bn1.weight', torch.Size([80]))
(69, 'layer3.1.bn1.bias', torch.Size([80]))
(70, 'layer3.1.conv2.weight', torch.Size([80, 80, 3, 3]))
(71, 'layer3.1.conv2.scale1', torch.Size([720, 720]))
(72, 'layer3.1.conv2.scale2', torch.Size([720, 720]))
(73, 'layer3.1.bn2.weight', torch.Size([80]))
(74, 'layer3.1.bn2.bias', torch.Size([80]))
(75, 'layer4.0.conv1.weight', torch.Size([160, 80, 3, 3]))
(76, 'layer4.0.conv1.scale1', torch.Size([720, 720]))
(77, 'layer4.0.conv1.scale2', torch.Size([720, 720]))
(78, 'layer4.0.bn1.weight', torch.Size([160]))
(79, 'layer4.0.bn1.bias', torch.Size([160]))
(80, 'layer4.0.conv2.weight', torch.Size([160, 160, 3, 3]))
(81, 'layer4.0.conv2.scale1', torch.Size([1440, 1440]))
(82, 'layer4.0.conv2.scale2', torch.Size([1440, 1440]))
(83, 'layer4.0.bn2.weight', torch.Size([160]))
(84, 'layer4.0.bn2.bias', torch.Size([160]))
(85, 'layer4.0.shortcut.0.weight', torch.Size([160, 80, 1, 1]))
(86, 'layer4.0.shortcut.0.scale1', torch.Size([80, 80]))
(87, 'layer4.0.shortcut.0.scale2', torch.Size([80, 80]))
(88, 'layer4.0.shortcut.1.weight', torch.Size([160]))
(89, 'layer4.0.shortcut.1.bias', torch.Size([160]))
(90, 'layer4.1.conv1.weight', torch.Size([160, 160, 3, 3]))
(91, 'layer4.1.conv1.scale1', torch.Size([1440, 1440]))
(92, 'layer4.1.conv1.scale2', torch.Size([1440, 1440]))
(93, 'layer4.1.bn1.weight', torch.Size([160]))
(94, 'layer4.1.bn1.bias', torch.Size([160]))
(95, 'layer4.1.conv2.weight', torch.Size([160, 160, 3, 3]))
(96, 'layer4.1.conv2.scale1', torch.Size([1440, 1440]))
(97, 'layer4.1.conv2.scale2', torch.Size([1440, 1440]))
(98, 'layer4.1.bn2.weight', torch.Size([160]))
(99, 'layer4.1.bn2.bias', torch.Size([160]))
(100, 'linear.0.weight', torch.Size([10, 640]))
(101, 'linear.1.weight', torch.Size([10, 640]))
(102, 'linear.2.weight', torch.Size([10, 640]))
(103, 'linear.3.weight', torch.Size([10, 640]))
(104, 'linear.4.weight', torch.Size([10, 640]))
Model parameters ---
(0, 'conv1.weight', torch.Size([20, 3, 3, 3]))
(5, 'layer1.0.conv1.weight', torch.Size([20, 20, 3, 3]))
(10, 'layer1.0.conv2.weight', torch.Size([20, 20, 3, 3]))
(15, 'layer1.1.conv1.weight', torch.Size([20, 20, 3, 3]))
(20, 'layer1.1.conv2.weight', torch.Size([20, 20, 3, 3]))
(25, 'layer2.0.conv1.weight', torch.Size([40, 20, 3, 3]))
(30, 'layer2.0.conv2.weight', torch.Size([40, 40, 3, 3]))
(35, 'layer2.0.shortcut.0.weight', torch.Size([40, 20, 1, 1]))
(40, 'layer2.1.conv1.weight', torch.Size([40, 40, 3, 3]))
(45, 'layer2.1.conv2.weight', torch.Size([40, 40, 3, 3]))
(50, 'layer3.0.conv1.weight', torch.Size([80, 40, 3, 3]))
(55, 'layer3.0.conv2.weight', torch.Size([80, 80, 3, 3]))
(60, 'layer3.0.shortcut.0.weight', torch.Size([80, 40, 1, 1]))
(65, 'layer3.1.conv1.weight', torch.Size([80, 80, 3, 3]))
(70, 'layer3.1.conv2.weight', torch.Size([80, 80, 3, 3]))
(75, 'layer4.0.conv1.weight', torch.Size([160, 80, 3, 3]))
(80, 'layer4.0.conv2.weight', torch.Size([160, 160, 3, 3]))
(85, 'layer4.0.shortcut.0.weight', torch.Size([160, 80, 1, 1]))
(90, 'layer4.1.conv1.weight', torch.Size([160, 160, 3, 3]))
(95, 'layer4.1.conv2.weight', torch.Size([160, 160, 3, 3]))
----------------------------------------
Epoch   1 | Train: loss=1.483, acc= 47.5% | time=110247.4ms |
 Valid: loss=1.534, acc= 45.2% |
 *
Epoch   2 | Train: loss=1.048, acc= 63.5% | time=123741.0ms |
 Valid: loss=1.094, acc= 61.8% |
 *
Epoch   3 | Train: loss=1.179, acc= 60.3% | time=98495.6ms |
 Valid: loss=1.241, acc= 58.0% |
Epoch   4 | Train: loss=0.752, acc= 73.7% | time=103445.2ms |
 Valid: loss=0.839, acc= 71.0% |
 *
Epoch   5 | Train: loss=0.639, acc= 77.5% | time=97638.9ms |
 Valid: loss=0.793, acc= 72.7% |
 *
Epoch   6 | Train: loss=0.467, acc= 84.2% | time=112401.2ms |
 Valid: loss=0.660, acc= 76.9% |
 *
Epoch   7 | Train: loss=0.422, acc= 85.5% | time=113930.5ms |
 Valid: loss=0.647, acc= 77.9% |
 *
Epoch   8 | Train: loss=0.414, acc= 85.4% | time=109402.4ms |
 Valid: loss=0.713, acc= 74.8% |
Epoch   9 | Train: loss=0.220, acc= 93.7% | time=106094.8ms |
 Valid: loss=0.565, acc= 80.9% |
 *
Epoch  10 | Train: loss=0.204, acc= 93.7% | time=114969.5ms |
 Valid: loss=0.616, acc= 79.4% |
Epoch  11 | Train: loss=0.471, acc= 84.2% | time=102260.3ms |
 Valid: loss=0.973, acc= 71.5% |
Epoch  12 | Train: loss=0.445, acc= 90.1% | time=97831.4ms |
 Valid: loss=0.909, acc= 74.6% |
Epoch  13 | Train: loss=0.138, acc= 95.8% | time=111942.8ms |
 Valid: loss=0.669, acc= 79.1% |
Epoch  14 | Train: loss=0.291, acc= 90.8% | time=107360.7ms |
 Valid: loss=0.902, acc= 74.3% |
 lr=3.3e-02
Epoch  15 | Train: loss=0.014, acc= 99.9% | time=105837.4ms |
 Valid: loss=0.540, acc= 83.2% |
 *
Epoch  16 | Train: loss=0.009, acc=100.0% | time=93337.4ms |
 Valid: loss=0.532, acc= 83.3% |
 *
Epoch  17 | Train: loss=0.009, acc=100.0% | time=112301.0ms |
 Valid: loss=0.550, acc= 83.4% |
Epoch  18 | Train: loss=0.007, acc=100.0% | time=106443.5ms |
 Valid: loss=0.563, acc= 83.4% |
Epoch  19 | Train: loss=0.006, acc=100.0% | time=104275.7ms |
 Valid: loss=0.548, acc= 83.1% |
Epoch  20 | Train: loss=0.008, acc=100.0% | time=95594.4ms |
 Valid: loss=0.571, acc= 82.4% |
Epoch  21 | Train: loss=0.009, acc=100.0% | time=113778.5ms |
 Valid: loss=0.578, acc= 82.5% |
 lr=1.1e-02
Epoch  22 | Train: loss=0.005, acc=100.0% | time=105385.8ms |
 Valid: loss=0.545, acc= 83.8% |
Epoch  23 | Train: loss=0.005, acc=100.0% | time=106295.2ms |
 Valid: loss=0.549, acc= 84.0% |
Epoch  24 | Train: loss=0.005, acc=100.0% | time=85950.5ms |
 Valid: loss=0.538, acc= 83.9% |
Epoch  25 | Train: loss=0.005, acc=100.0% | time=109224.8ms |
 Valid: loss=0.539, acc= 83.8% |
Epoch  26 | Train: loss=0.005, acc=100.0% | time=111277.8ms |
 Valid: loss=0.543, acc= 84.0% |
 lr=3.7e-03
Epoch  27 | Train: loss=0.005, acc=100.0% | time=113833.8ms |
 Valid: loss=0.541, acc= 83.6% |
Epoch  28 | Train: loss=0.004, acc=100.0% | time=96908.9ms |
 Valid: loss=0.543, acc= 83.2% |
Epoch  29 | Train: loss=0.005, acc=100.0% | time=110096.5ms |
 Valid: loss=0.544, acc= 83.4% |
Epoch  30 | Train: loss=0.005, acc=100.0% | time=110630.2ms |
 Valid: loss=0.541, acc= 83.6% |
Epoch  31 | Train: loss=0.004, acc=100.0% | time=106175.4ms |
 Valid: loss=0.535, acc= 83.2% |
 lr=1.2e-03
Epoch  32 | Train: loss=0.005, acc=100.0% | time=86497.0ms |
 Valid: loss=0.546, acc= 83.0% |
Epoch  33 | Train: loss=0.005, acc=100.0% | time=99043.6ms |
 Valid: loss=0.543, acc= 83.7% |
Epoch  34 | Train: loss=0.004, acc=100.0% | time=115596.3ms |
 Valid: loss=0.547, acc= 83.1% |
Epoch  35 | Train: loss=0.004, acc=100.0% | time=107564.2ms |
 Valid: loss=0.533, acc= 83.4% |
Epoch  36 | Train: loss=0.004, acc=100.0% | time=104667.0ms |
 Valid: loss=0.538, acc= 83.3% |
 lr=4.1e-04
----------------------------------------
Test: loss=0.583 , acc= 82.8%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.588 , acc= 82.8%
Test: loss=0.586 , acc= 82.8%
Test: loss=0.585 , acc= 82.5%
Test: loss=0.587 , acc= 82.7%
Test: loss=0.588 , acc= 82.7%
Accuracies =
 82.7%   0.0%   0.0%   0.0%   0.0%
****************************************************************************************************
Task  1 (mnist)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 6)
Task:0, Layer:0, project_norm:0.04966335907037753, threshold for regime 1:0.02565404772758484
Task:0, layer:1, space shape:(180, 42)
Task:0, Layer:1, project_norm:0.07132527632867319, threshold for regime 1:0.03705449402332306
Task:0, layer:2, space shape:(180, 77)
Task:0, Layer:2, project_norm:0.06400477433509141, threshold for regime 1:0.033158767968416214
Task:0, layer:3, space shape:(180, 65)
Task:0, Layer:3, project_norm:0.07438209483103835, threshold for regime 1:0.038251910358667374
Task:0, layer:4, space shape:(180, 99)
Task:0, Layer:4, project_norm:0.0697812621926617, threshold for regime 1:0.03557325154542923
Task:0, layer:5, space shape:(180, 73)
Task:0, Layer:5, project_norm:0.08115130110690198, threshold for regime 1:0.0414930135011673
Task:0, layer:6, space shape:(360, 199)
Task:0, Layer:6, project_norm:0.11081516005686075, threshold for regime 1:0.056980013847351074
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.05641700610064706, threshold for regime 1:0.029535852372646332
Task:0, layer:8, space shape:(360, 204)
Task:0, Layer:8, project_norm:0.11608005031933262, threshold for regime 1:0.059081461280584335
Task:0, layer:9, space shape:(360, 211)
Task:0, Layer:9, project_norm:0.13908369088860414, threshold for regime 1:0.07030992209911346
Task:0, layer:10, space shape:(360, 194)
Task:0, Layer:10, project_norm:0.1550119827357321, threshold for regime 1:0.07908149063587189
Task:0, layer:11, space shape:(720, 417)
Task:0, Layer:11, project_norm:0.22681261813119236, threshold for regime 1:0.11689774692058563
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.10971553169225204, threshold for regime 1:0.056417204439640045
Task:0, layer:13, space shape:(720, 443)
Task:0, Layer:13, project_norm:0.23096109473464332, threshold for regime 1:0.11803846806287766
Task:0, layer:14, space shape:(720, 444)
Task:0, Layer:14, project_norm:0.23851668842986615, threshold for regime 1:0.12335267663002014
Task:0, layer:15, space shape:(720, 324)
Task:0, Layer:15, project_norm:0.30552887401165957, threshold for regime 1:0.16181068122386932
Task:0, layer:16, space shape:(1440, 581)
Task:0, Layer:16, project_norm:0.43523608172885536, threshold for regime 1:0.2398403435945511
Task:0, layer:17, space shape:(80, 56)
Task:0, Layer:17, project_norm:0.20334852099246936, threshold for regime 1:0.1056462824344635
Task:0, layer:18, space shape:(1440, 688)
Task:0, Layer:18, project_norm:0.45711335519080576, threshold for regime 1:0.2515392005443573
Task:0, layer:19, space shape:(1440, 660)
Task:0, Layer:19, project_norm:0.6506314276948556, threshold for regime 1:0.35852447152137756
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
space1 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.034, acc= 99.2% | time=310837.6ms |
 Valid: loss=0.047, acc= 98.9% |
Epoch   2 | Train: loss=0.020, acc= 99.6% | time=298795.6ms |
 Valid: loss=0.035, acc= 99.2% |
Epoch   3 | Train: loss=0.016, acc= 99.7% | time=305145.8ms |
 Valid: loss=0.033, acc= 99.1% |
Epoch   4 | Train: loss=0.012, acc= 99.8% | time=307405.0ms |
 Valid: loss=0.030, acc= 99.2% |
Epoch   5 | Train: loss=0.009, acc= 99.8% | time=303520.6ms |
 Valid: loss=0.028, acc= 99.3% |
Epoch   6 | Train: loss=0.008, acc= 99.9% | time=313238.8ms |
 Valid: loss=0.026, acc= 99.2% |
Epoch   7 | Train: loss=0.006, acc= 99.9% | time=291276.6ms |
 Valid: loss=0.025, acc= 99.3% |
Epoch   8 | Train: loss=0.004, acc= 99.9% | time=309986.6ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch   9 | Train: loss=0.004, acc=100.0% | time=303882.9ms |
 Valid: loss=0.023, acc= 99.3% |
Epoch  10 | Train: loss=0.003, acc=100.0% | time=292162.2ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  11 | Train: loss=0.003, acc=100.0% | time=328164.1ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  12 | Train: loss=0.002, acc=100.0% | time=301513.7ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  13 | Train: loss=0.002, acc=100.0% | time=290189.4ms |
 Valid: loss=0.020, acc= 99.2% |
Epoch  14 | Train: loss=0.001, acc=100.0% | time=322652.9ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  15 | Train: loss=0.001, acc=100.0% | time=278824.1ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  16 | Train: loss=0.001, acc=100.0% | time=297667.8ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  17 | Train: loss=0.001, acc=100.0% | time=324451.9ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  18 | Train: loss=0.001, acc=100.0% | time=261298.8ms |
 Valid: loss=0.022, acc= 99.3% |
 lr=3.3e-02
Epoch  19 | Train: loss=0.001, acc=100.0% | time=283210.7ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  20 | Train: loss=0.001, acc=100.0% | time=288967.5ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  21 | Train: loss=0.000, acc=100.0% | time=254913.0ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  22 | Train: loss=0.000, acc=100.0% | time=272014.5ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  23 | Train: loss=0.000, acc=100.0% | time=287522.7ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  24 | Train: loss=0.000, acc=100.0% | time=250495.5ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  25 | Train: loss=0.000, acc=100.0% | time=265472.3ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  26 | Train: loss=0.000, acc=100.0% | time=281885.8ms |
 Valid: loss=0.020, acc= 99.4% |
 lr=1.1e-02
Epoch  27 | Train: loss=0.000, acc=100.0% | time=243623.7ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  28 | Train: loss=0.000, acc=100.0% | time=251181.8ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  29 | Train: loss=0.000, acc=100.0% | time=263547.7ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  30 | Train: loss=0.000, acc=100.0% | time=259839.2ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  31 | Train: loss=0.000, acc=100.0% | time=252167.9ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  32 | Train: loss=0.000, acc=100.0% | time=254314.0ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  33 | Train: loss=0.000, acc=100.0% | time=268171.0ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  34 | Train: loss=0.000, acc=100.0% | time=220494.3ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  35 | Train: loss=0.000, acc=100.0% | time=217831.0ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  36 | Train: loss=0.000, acc=100.0% | time=245694.2ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  37 | Train: loss=0.000, acc=100.0% | time=226283.4ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  38 | Train: loss=0.000, acc=100.0% | time=234260.3ms |
 Valid: loss=0.019, acc= 99.3% |
Epoch  39 | Train: loss=0.000, acc=100.0% | time=221565.3ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  40 | Train: loss=0.000, acc=100.0% | time=236339.3ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  41 | Train: loss=0.000, acc=100.0% | time=238410.9ms |
 Valid: loss=0.020, acc= 99.3% |
 lr=3.7e-03
Epoch  42 | Train: loss=0.000, acc=100.0% | time=221584.1ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  43 | Train: loss=0.000, acc=100.0% | time=231626.5ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  44 | Train: loss=0.000, acc=100.0% | time=227525.8ms |
 Valid: loss=0.020, acc= 99.5% |
Epoch  45 | Train: loss=0.000, acc=100.0% | time=217537.3ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  46 | Train: loss=0.000, acc=100.0% | time=213209.7ms |
 Valid: loss=0.019, acc= 99.5% |
 lr=1.2e-03
Epoch  47 | Train: loss=0.000, acc=100.0% | time=231109.6ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  48 | Train: loss=0.000, acc=100.0% | time=226582.1ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  49 | Train: loss=0.000, acc=100.0% | time=218593.8ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  50 | Train: loss=0.000, acc=100.0% | time=220782.7ms |
 Valid: loss=0.019, acc= 99.3% |
Epoch  51 | Train: loss=0.000, acc=100.0% | time=226732.1ms |
 Valid: loss=0.020, acc= 99.3% |
 lr=4.1e-04
Test: loss=0.017 , acc= 99.4%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.017 , acc= 99.5%
Test: loss=0.017 , acc= 99.5%
Test: loss=0.017 , acc= 99.4%
Test: loss=0.017 , acc= 99.4%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.4%
Average acc= 99.5%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 6)
threshold for selecting:16304.517307499824
total ranking r = 6
the number of space for current task:6
the new increased space:1, the threshold for new space:6
Ui shape:(27, 6)
activation shape:(180, 10240)
space shape:(180, 42)
threshold for selecting:78478.95630342164
total ranking r = 48
the number of space for current task:48
the new increased space:7, the threshold for new space:42
Ui shape:(180, 48)
activation shape:(180, 10240)
space shape:(180, 77)
threshold for selecting:33325.99292388617
total ranking r = 83
the number of space for current task:83
the new increased space:9, the threshold for new space:77
Ui shape:(180, 83)
activation shape:(180, 10240)
space shape:(180, 65)
threshold for selecting:145499.79257059027
total ranking r = 72
the number of space for current task:72
the new increased space:9, the threshold for new space:65
Ui shape:(180, 72)
activation shape:(180, 10240)
space shape:(180, 99)
threshold for selecting:24505.609203048654
total ranking r = 105
the number of space for current task:105
the new increased space:8, the threshold for new space:99
Ui shape:(180, 105)
activation shape:(180, 2560)
space shape:(180, 73)
threshold for selecting:57289.858843130234
total ranking r = 78
the number of space for current task:78
the new increased space:10, the threshold for new space:73
Ui shape:(180, 78)
activation shape:(360, 2560)
space shape:(360, 199)
threshold for selecting:24537.253485460435
total ranking r = 210
the number of space for current task:210
the new increased space:31, the threshold for new space:199
Ui shape:(360, 210)
activation shape:(20, 2560)
space shape:(20, 13)
threshold for selecting:7999.08013299478
total ranking r = 15
the number of space for current task:15
the new increased space:1, the threshold for new space:13
Ui shape:(20, 15)
activation shape:(360, 2560)
space shape:(360, 204)
threshold for selecting:75711.34707382033
total ranking r = 215
the number of space for current task:215
the new increased space:29, the threshold for new space:204
Ui shape:(360, 215)
activation shape:(360, 12800)
space shape:(360, 211)
threshold for selecting:92541.0842827388
total ranking r = 219
the number of space for current task:219
the new increased space:24, the threshold for new space:211
Ui shape:(360, 219)
activation shape:(360, 3200)
space shape:(360, 194)
threshold for selecting:129971.07165133224
total ranking r = 208
the number of space for current task:208
the new increased space:28, the threshold for new space:194
Ui shape:(360, 208)
activation shape:(720, 3200)
space shape:(720, 417)
threshold for selecting:68806.53887437456
total ranking r = 462
the number of space for current task:462
the new increased space:70, the threshold for new space:417
Ui shape:(720, 462)
activation shape:(40, 3200)
space shape:(40, 29)
threshold for selecting:12948.282318325368
total ranking r = 30
the number of space for current task:30
the new increased space:2, the threshold for new space:29
Ui shape:(40, 30)
activation shape:(720, 6400)
space shape:(720, 443)
threshold for selecting:339438.44982280594
total ranking r = 479
the number of space for current task:479
the new increased space:61, the threshold for new space:443
Ui shape:(720, 479)
activation shape:(720, 6400)
space shape:(720, 444)
threshold for selecting:128215.35359880293
total ranking r = 503
the number of space for current task:503
the new increased space:71, the threshold for new space:444
Ui shape:(720, 503)
activation shape:(720, 1600)
space shape:(720, 324)
threshold for selecting:224953.55283590508
total ranking r = 406
the number of space for current task:406
the new increased space:89, the threshold for new space:324
Ui shape:(720, 406)
activation shape:(1440, 1600)
space shape:(1440, 581)
threshold for selecting:139779.0387804375
total ranking r = 818
the number of space for current task:818
the new increased space:236, the threshold for new space:581
Ui shape:(1440, 818)
activation shape:(80, 1600)
space shape:(80, 56)
threshold for selecting:15404.552686508196
total ranking r = 61
the number of space for current task:61
the new increased space:5, the threshold for new space:56
Ui shape:(80, 61)
activation shape:(1440, 1600)
space shape:(1440, 688)
threshold for selecting:130729.53284702041
total ranking r = 939
the number of space for current task:939
the new increased space:250, the threshold for new space:688
Ui shape:(1440, 939)
activation shape:(1440, 1600)
space shape:(1440, 660)
threshold for selecting:101577.6795328126
total ranking r = 907
the number of space for current task:907
the new increased space:246, the threshold for new space:660
Ui shape:(1440, 907)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.591 , acc= 82.8%
Test: loss=0.592 , acc= 82.6%
Test: loss=0.590 , acc= 82.9%
Test: loss=0.590 , acc= 82.9%
Test: loss=0.590 , acc= 82.6%
current testing task:mnist
Test: loss=0.016 , acc= 99.5%
Test: loss=0.017 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Accuracies =
 82.7%   0.0%   0.0%   0.0%   0.0%
 82.8%  99.5%   0.0%   0.0%   0.0%
****************************************************************************************************
Task  2 (svhn)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 6)
Task:0, Layer:0, project_norm:0.09196104578346688, threshold for regime 1:0.046092208474874496
Task:0, layer:1, space shape:(180, 42)
Task:0, Layer:1, project_norm:0.05792821156532359, threshold for regime 1:0.029773257672786713
Task:0, layer:2, space shape:(180, 77)
Task:0, Layer:2, project_norm:0.0551647546122543, threshold for regime 1:0.028111306950449944
Task:0, layer:3, space shape:(180, 65)
Task:0, Layer:3, project_norm:0.048763343902963614, threshold for regime 1:0.025060564279556274
Task:0, layer:4, space shape:(180, 99)
Task:0, Layer:4, project_norm:0.04555229690432882, threshold for regime 1:0.023209284991025925
Task:0, layer:5, space shape:(180, 73)
Task:0, Layer:5, project_norm:0.048564842896656905, threshold for regime 1:0.024897301569581032
Task:0, layer:6, space shape:(360, 199)
Task:0, Layer:6, project_norm:0.060402580703842496, threshold for regime 1:0.03096400573849678
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.029101351569435358, threshold for regime 1:0.015622975304722786
Task:0, layer:8, space shape:(360, 204)
Task:0, Layer:8, project_norm:0.05249481813468283, threshold for regime 1:0.026885705068707466
Task:0, layer:9, space shape:(360, 211)
Task:0, Layer:9, project_norm:0.05315756907721994, threshold for regime 1:0.027030976489186287
Task:0, layer:10, space shape:(360, 194)
Task:0, Layer:10, project_norm:0.07066895108739703, threshold for regime 1:0.03635704144835472
Task:0, layer:11, space shape:(720, 417)
Task:0, Layer:11, project_norm:0.09601312239000524, threshold for regime 1:0.04965022951364517
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.04596835644346319, threshold for regime 1:0.02371208742260933
Task:0, layer:13, space shape:(720, 443)
Task:0, Layer:13, project_norm:0.08966338966335546, threshold for regime 1:0.04595222324132919
Task:0, layer:14, space shape:(720, 444)
Task:0, Layer:14, project_norm:0.09914678600027618, threshold for regime 1:0.05103170871734619
Task:0, layer:15, space shape:(720, 324)
Task:0, Layer:15, project_norm:0.12807308968819367, threshold for regime 1:0.06723708659410477
Task:0, layer:16, space shape:(1440, 581)
Task:0, Layer:16, project_norm:0.18904196124541833, threshold for regime 1:0.10125668346881866
Task:0, layer:17, space shape:(80, 56)
Task:0, Layer:17, project_norm:0.1014751847273526, threshold for regime 1:0.052300937473773956
Task:0, layer:18, space shape:(1440, 688)
Task:0, Layer:18, project_norm:0.20422167558342985, threshold for regime 1:0.11022189259529114
Task:0, layer:19, space shape:(1440, 660)
Task:0, Layer:19, project_norm:0.33010151852617803, threshold for regime 1:0.1771727204322815
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:1, layer:0, space shape:(27, 6)
Task:1, Layer:0, project_norm:0.09102153413879144, threshold for regime 1:0.046092208474874496
Task:1, layer:1, space shape:(180, 48)
Task:1, Layer:1, project_norm:0.0580515286611167, threshold for regime 1:0.029773257672786713
Task:1, layer:2, space shape:(180, 83)
Task:1, Layer:2, project_norm:0.055283337552906854, threshold for regime 1:0.028111306950449944
Task:1, layer:3, space shape:(180, 72)
Task:1, Layer:3, project_norm:0.04893343803044558, threshold for regime 1:0.025060564279556274
Task:1, layer:4, space shape:(180, 105)
Task:1, Layer:4, project_norm:0.045570962001289274, threshold for regime 1:0.023209284991025925
Task:1, layer:5, space shape:(180, 78)
Task:1, Layer:5, project_norm:0.04858186702482141, threshold for regime 1:0.024897301569581032
Task:1, layer:6, space shape:(360, 210)
Task:1, Layer:6, project_norm:0.06049562598323366, threshold for regime 1:0.03096400573849678
Task:1, layer:7, space shape:(20, 15)
Task:1, Layer:7, project_norm:0.029980612346844026, threshold for regime 1:0.015622975304722786
Task:1, layer:8, space shape:(360, 215)
Task:1, Layer:8, project_norm:0.05264303885368589, threshold for regime 1:0.026885705068707466
Task:1, layer:9, space shape:(360, 219)
Task:1, Layer:9, project_norm:0.05318395829170324, threshold for regime 1:0.027030976489186287
Task:1, layer:10, space shape:(360, 208)
Task:1, Layer:10, project_norm:0.07082574770571805, threshold for regime 1:0.03635704144835472
Task:1, layer:11, space shape:(720, 462)
Task:1, Layer:11, project_norm:0.09655307766210039, threshold for regime 1:0.04965022951364517
Task:1, layer:12, space shape:(40, 30)
Task:1, Layer:12, project_norm:0.04591252792383282, threshold for regime 1:0.02371208742260933
Task:1, layer:13, space shape:(720, 479)
Task:1, Layer:13, project_norm:0.08997140557059297, threshold for regime 1:0.04595222324132919
Task:1, layer:14, space shape:(720, 503)
Task:1, Layer:14, project_norm:0.09990589242783231, threshold for regime 1:0.05103170871734619
Task:1, layer:15, space shape:(720, 406)
Task:1, Layer:15, project_norm:0.129843951172864, threshold for regime 1:0.06723708659410477
Task:1, layer:16, space shape:(1440, 818)
Task:1, Layer:16, project_norm:0.19404375256184941, threshold for regime 1:0.10125668346881866
Task:1, layer:17, space shape:(80, 61)
Task:1, Layer:17, project_norm:0.10223409288715876, threshold for regime 1:0.052300937473773956
Task:1, layer:18, space shape:(1440, 939)
Task:1, Layer:18, project_norm:0.21127879859781193, threshold for regime 1:0.11022189259529114
Task:1, layer:19, space shape:(1440, 907)
Task:1, Layer:19, project_norm:0.3407159292769516, threshold for regime 1:0.1771727204322815
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Layer:0, selected task ID:[1]
Layer:1, selected task ID:[1]
Layer:2, selected task ID:[1]
Layer:3, selected task ID:[1]
Layer:4, selected task ID:[1]
Layer:5, selected task ID:[1]
Layer:6, selected task ID:[1]
Layer:7, selected task ID:[1]
Layer:8, selected task ID:[1]
Layer:9, selected task ID:[1]
Layer:10, selected task ID:[1]
Layer:11, selected task ID:[1]
Layer:12, selected task ID:[1]
Layer:13, selected task ID:[1]
Layer:14, selected task ID:[1]
Layer:15, selected task ID:[1]
Layer:16, selected task ID:[1]
Layer:17, selected task ID:[1]
Layer:18, selected task ID:[1]
Layer:19, selected task ID:[1]
space1 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.287, acc= 91.6% | time=281279.9ms |
 Valid: loss=0.327, acc= 90.6% |
Epoch   2 | Train: loss=0.202, acc= 94.6% | time=265848.6ms |
 Valid: loss=0.260, acc= 92.6% |
Epoch   3 | Train: loss=0.169, acc= 95.7% | time=269070.3ms |
 Valid: loss=0.242, acc= 93.6% |
Epoch   4 | Train: loss=0.147, acc= 96.3% | time=271311.7ms |
 Valid: loss=0.240, acc= 93.2% |
Epoch   5 | Train: loss=0.127, acc= 97.0% | time=282181.6ms |
 Valid: loss=0.233, acc= 93.6% |
Epoch   6 | Train: loss=0.102, acc= 97.8% | time=283446.9ms |
 Valid: loss=0.227, acc= 93.8% |
Epoch   7 | Train: loss=0.086, acc= 98.1% | time=283141.5ms |
 Valid: loss=0.221, acc= 94.0% |
Epoch   8 | Train: loss=0.070, acc= 98.8% | time=282817.2ms |
 Valid: loss=0.229, acc= 93.8% |
Epoch   9 | Train: loss=0.054, acc= 99.1% | time=282232.1ms |
 Valid: loss=0.220, acc= 93.9% |
Epoch  10 | Train: loss=0.050, acc= 99.2% | time=265159.0ms |
 Valid: loss=0.237, acc= 93.8% |
Epoch  11 | Train: loss=0.033, acc= 99.6% | time=269044.8ms |
 Valid: loss=0.226, acc= 93.9% |
Epoch  12 | Train: loss=0.025, acc= 99.7% | time=274590.6ms |
 Valid: loss=0.228, acc= 94.0% |
Epoch  13 | Train: loss=0.021, acc= 99.8% | time=276268.0ms |
 Valid: loss=0.236, acc= 94.0% |
Epoch  14 | Train: loss=0.022, acc= 99.8% | time=255146.5ms |
 Valid: loss=0.248, acc= 93.4% |
 lr=3.3e-02
Epoch  15 | Train: loss=0.010, acc= 99.9% | time=280493.6ms |
 Valid: loss=0.225, acc= 94.5% |
Epoch  16 | Train: loss=0.008, acc=100.0% | time=267266.3ms |
 Valid: loss=0.230, acc= 94.1% |
Epoch  17 | Train: loss=0.007, acc=100.0% | time=251175.6ms |
 Valid: loss=0.232, acc= 94.3% |
Epoch  18 | Train: loss=0.006, acc=100.0% | time=268330.3ms |
 Valid: loss=0.230, acc= 94.2% |
Epoch  19 | Train: loss=0.006, acc=100.0% | time=273148.1ms |
 Valid: loss=0.237, acc= 94.1% |
 lr=1.1e-02
Epoch  20 | Train: loss=0.005, acc=100.0% | time=298233.1ms |
 Valid: loss=0.233, acc= 94.2% |
Epoch  21 | Train: loss=0.005, acc=100.0% | time=277687.0ms |
 Valid: loss=0.235, acc= 94.2% |
Epoch  22 | Train: loss=0.005, acc=100.0% | time=271460.4ms |
 Valid: loss=0.234, acc= 94.1% |
Epoch  23 | Train: loss=0.005, acc=100.0% | time=267167.2ms |
 Valid: loss=0.236, acc= 94.1% |
Epoch  24 | Train: loss=0.005, acc=100.0% | time=259659.7ms |
 Valid: loss=0.233, acc= 94.2% |
 lr=3.7e-03
Epoch  25 | Train: loss=0.005, acc=100.0% | time=285032.8ms |
 Valid: loss=0.235, acc= 94.3% |
Epoch  26 | Train: loss=0.005, acc=100.0% | time=268601.5ms |
 Valid: loss=0.236, acc= 94.0% |
Epoch  27 | Train: loss=0.005, acc=100.0% | time=259075.4ms |
 Valid: loss=0.234, acc= 94.3% |
Epoch  28 | Train: loss=0.005, acc=100.0% | time=292831.0ms |
 Valid: loss=0.236, acc= 94.2% |
Epoch  29 | Train: loss=0.005, acc=100.0% | time=270118.4ms |
 Valid: loss=0.238, acc= 94.0% |
 lr=1.2e-03
Epoch  30 | Train: loss=0.005, acc=100.0% | time=274102.9ms |
 Valid: loss=0.235, acc= 94.3% |
Epoch  31 | Train: loss=0.005, acc=100.0% | time=266766.4ms |
 Valid: loss=0.236, acc= 94.0% |
Epoch  32 | Train: loss=0.005, acc=100.0% | time=282834.3ms |
 Valid: loss=0.237, acc= 94.2% |
Epoch  33 | Train: loss=0.005, acc=100.0% | time=274006.5ms |
 Valid: loss=0.235, acc= 94.1% |
Epoch  34 | Train: loss=0.005, acc=100.0% | time=263168.0ms |
 Valid: loss=0.236, acc= 94.1% |
 lr=4.1e-04
Test: loss=0.200 , acc= 94.3%
Test: loss=0.200 , acc= 94.4%
Test: loss=0.201 , acc= 94.3%
Test: loss=0.200 , acc= 94.4%
Test: loss=0.200 , acc= 94.4%
Test: loss=0.200 , acc= 94.4%
Test: loss=0.200 , acc= 94.4%
Test: loss=0.200 , acc= 94.4%
Test: loss=0.200 , acc= 94.4%
Test: loss=0.199 , acc= 94.5%
Average acc= 94.4%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 7)
threshold for selecting:3622.2316502791437
total ranking r = 4
the number of space for current task:4
the new increased space:0, the threshold for new space:7
Ui shape:(27, 4)
activation shape:(180, 10240)
space shape:(180, 49)
threshold for selecting:40851.70617429758
total ranking r = 39
the number of space for current task:39
the new increased space:2, the threshold for new space:49
Ui shape:(180, 39)
activation shape:(180, 10240)
space shape:(180, 86)
threshold for selecting:25320.48320844819
total ranking r = 74
the number of space for current task:74
the new increased space:2, the threshold for new space:86
Ui shape:(180, 74)
activation shape:(180, 10240)
space shape:(180, 74)
threshold for selecting:99170.47705265868
total ranking r = 65
the number of space for current task:65
the new increased space:4, the threshold for new space:74
Ui shape:(180, 65)
activation shape:(180, 10240)
space shape:(180, 107)
threshold for selecting:22213.507203460093
total ranking r = 99
the number of space for current task:99
the new increased space:5, the threshold for new space:107
Ui shape:(180, 99)
activation shape:(180, 2560)
space shape:(180, 83)
threshold for selecting:40935.75214637283
total ranking r = 76
the number of space for current task:76
the new increased space:6, the threshold for new space:83
Ui shape:(180, 76)
activation shape:(360, 2560)
space shape:(360, 230)
threshold for selecting:18695.51735345849
total ranking r = 226
the number of space for current task:226
the new increased space:23, the threshold for new space:230
Ui shape:(360, 226)
activation shape:(20, 2560)
space shape:(20, 14)
threshold for selecting:6329.481257764358
total ranking r = 15
the number of space for current task:15
the new increased space:1, the threshold for new space:14
Ui shape:(20, 15)
activation shape:(360, 2560)
space shape:(360, 233)
threshold for selecting:59248.91517763832
total ranking r = 233
the number of space for current task:233
the new increased space:23, the threshold for new space:233
Ui shape:(360, 233)
activation shape:(360, 12800)
space shape:(360, 235)
threshold for selecting:63639.750732114066
total ranking r = 224
the number of space for current task:224
the new increased space:12, the threshold for new space:235
Ui shape:(360, 224)
activation shape:(360, 3200)
space shape:(360, 222)
threshold for selecting:95504.47365050318
total ranking r = 218
the number of space for current task:218
the new increased space:22, the threshold for new space:222
Ui shape:(360, 218)
activation shape:(720, 3200)
space shape:(720, 487)
threshold for selecting:45596.95463724676
total ranking r = 514
the number of space for current task:514
the new increased space:64, the threshold for new space:487
Ui shape:(720, 514)
activation shape:(40, 3200)
space shape:(40, 31)
threshold for selecting:11045.073162955561
total ranking r = 31
the number of space for current task:31
the new increased space:1, the threshold for new space:31
Ui shape:(40, 31)
activation shape:(720, 6400)
space shape:(720, 504)
threshold for selecting:234719.2452311802
total ranking r = 510
the number of space for current task:510
the new increased space:52, the threshold for new space:504
Ui shape:(720, 510)
activation shape:(720, 6400)
space shape:(720, 515)
threshold for selecting:81745.33500613198
total ranking r = 533
the number of space for current task:533
the new increased space:49, the threshold for new space:515
Ui shape:(720, 533)
activation shape:(720, 1600)
space shape:(720, 413)
threshold for selecting:145119.2650376844
total ranking r = 473
the number of space for current task:473
the new increased space:83, the threshold for new space:413
Ui shape:(720, 473)
activation shape:(1440, 1600)
space shape:(1440, 817)
threshold for selecting:78936.16361242715
total ranking r = 994
the number of space for current task:994
the new increased space:192, the threshold for new space:817
Ui shape:(1440, 994)
activation shape:(80, 1600)
space shape:(80, 61)
threshold for selecting:11058.070421848819
total ranking r = 63
the number of space for current task:63
the new increased space:4, the threshold for new space:61
Ui shape:(80, 63)
activation shape:(1440, 1600)
space shape:(1440, 938)
threshold for selecting:67648.56292396475
total ranking r = 1111
the number of space for current task:1111
the new increased space:176, the threshold for new space:938
Ui shape:(1440, 1111)
activation shape:(1440, 1600)
space shape:(1440, 906)
threshold for selecting:60962.29357094999
total ranking r = 1080
the number of space for current task:1080
the new increased space:182, the threshold for new space:906
Ui shape:(1440, 1080)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.589 , acc= 82.6%
Test: loss=0.589 , acc= 82.7%
Test: loss=0.587 , acc= 82.6%
Test: loss=0.596 , acc= 82.5%
Test: loss=0.597 , acc= 82.5%
current testing task:mnist
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
current testing task:svhn
Test: loss=0.200 , acc= 94.3%
Test: loss=0.199 , acc= 94.4%
Test: loss=0.200 , acc= 94.4%
Test: loss=0.200 , acc= 94.4%
Test: loss=0.199 , acc= 94.5%
Accuracies =
 82.7%   0.0%   0.0%   0.0%   0.0%
 82.8%  99.5%   0.0%   0.0%   0.0%
 82.6%  99.5%  94.4%   0.0%   0.0%
****************************************************************************************************
Task  3 (fashion-mnist)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 6)
Task:0, Layer:0, project_norm:0.05421705368881084, threshold for regime 1:0.027851048856973648
Task:0, layer:1, space shape:(180, 42)
Task:0, Layer:1, project_norm:0.06403346138634375, threshold for regime 1:0.033382486552000046
Task:0, layer:2, space shape:(180, 77)
Task:0, Layer:2, project_norm:0.06188259473798513, threshold for regime 1:0.03195623308420181
Task:0, layer:3, space shape:(180, 65)
Task:0, Layer:3, project_norm:0.06770478113602194, threshold for regime 1:0.03490480035543442
Task:0, layer:4, space shape:(180, 99)
Task:0, Layer:4, project_norm:0.06447278641754631, threshold for regime 1:0.03285161778330803
Task:0, layer:5, space shape:(180, 73)
Task:0, Layer:5, project_norm:0.07024702121038125, threshold for regime 1:0.036042287945747375
Task:0, layer:6, space shape:(360, 199)
Task:0, Layer:6, project_norm:0.09890754292920347, threshold for regime 1:0.050759270787239075
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.05120615158845014, threshold for regime 1:0.026646548882126808
Task:0, layer:8, space shape:(360, 204)
Task:0, Layer:8, project_norm:0.10205951934195076, threshold for regime 1:0.05206705257296562
Task:0, layer:9, space shape:(360, 211)
Task:0, Layer:9, project_norm:0.12028678114385988, threshold for regime 1:0.06084016337990761
Task:0, layer:10, space shape:(360, 194)
Task:0, Layer:10, project_norm:0.14658517426548065, threshold for regime 1:0.0748206228017807
Task:0, layer:11, space shape:(720, 417)
Task:0, Layer:11, project_norm:0.2120682226815001, threshold for regime 1:0.10942330956459045
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.10217120446962878, threshold for regime 1:0.0525711290538311
Task:0, layer:13, space shape:(720, 443)
Task:0, Layer:13, project_norm:0.20863236682546848, threshold for regime 1:0.10697364062070847
Task:0, layer:14, space shape:(720, 444)
Task:0, Layer:14, project_norm:0.23618483995146752, threshold for regime 1:0.12221136689186096
Task:0, layer:15, space shape:(720, 324)
Task:0, Layer:15, project_norm:0.3118152279352503, threshold for regime 1:0.1653410941362381
Task:0, layer:16, space shape:(1440, 581)
Task:0, Layer:16, project_norm:0.4501203692761744, threshold for regime 1:0.24720081686973572
Task:0, layer:17, space shape:(80, 56)
Task:0, Layer:17, project_norm:0.20032554540643854, threshold for regime 1:0.10411281138658524
Task:0, layer:18, space shape:(1440, 688)
Task:0, Layer:18, project_norm:0.4752306351629132, threshold for regime 1:0.2622280716896057
Task:0, layer:19, space shape:(1440, 660)
Task:0, Layer:19, project_norm:0.7032410354095593, threshold for regime 1:0.3875320255756378
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:1, layer:0, space shape:(27, 6)
Task:1, Layer:0, project_norm:0.05539180887194064, threshold for regime 1:0.027851048856973648
Task:1, layer:1, space shape:(180, 48)
Task:1, Layer:1, project_norm:0.06488068737286819, threshold for regime 1:0.033382486552000046
Task:1, layer:2, space shape:(180, 83)
Task:1, Layer:2, project_norm:0.06243550615365836, threshold for regime 1:0.03195623308420181
Task:1, layer:3, space shape:(180, 72)
Task:1, Layer:3, project_norm:0.06851908695665748, threshold for regime 1:0.03490480035543442
Task:1, layer:4, space shape:(180, 105)
Task:1, Layer:4, project_norm:0.0647221598946156, threshold for regime 1:0.03285161778330803
Task:1, layer:5, space shape:(180, 78)
Task:1, Layer:5, project_norm:0.07060238607097395, threshold for regime 1:0.036042287945747375
Task:1, layer:6, space shape:(360, 210)
Task:1, Layer:6, project_norm:0.0997679930551861, threshold for regime 1:0.050759270787239075
Task:1, layer:7, space shape:(20, 15)
Task:1, Layer:7, project_norm:0.052141532286268936, threshold for regime 1:0.026646548882126808
Task:1, layer:8, space shape:(360, 215)
Task:1, Layer:8, project_norm:0.10288897014182626, threshold for regime 1:0.05206705257296562
Task:1, layer:9, space shape:(360, 219)
Task:1, Layer:9, project_norm:0.12060208942667924, threshold for regime 1:0.06084016337990761
Task:1, layer:10, space shape:(360, 208)
Task:1, Layer:10, project_norm:0.14754686466478797, threshold for regime 1:0.0748206228017807
Task:1, layer:11, space shape:(720, 462)
Task:1, Layer:11, project_norm:0.21554654372773047, threshold for regime 1:0.10942330956459045
Task:1, layer:12, space shape:(40, 30)
Task:1, Layer:12, project_norm:0.1026657809555703, threshold for regime 1:0.0525711290538311
Task:1, layer:13, space shape:(720, 479)
Task:1, Layer:13, project_norm:0.21092185084068651, threshold for regime 1:0.10697364062070847
Task:1, layer:14, space shape:(720, 503)
Task:1, Layer:14, project_norm:0.24045433792214674, threshold for regime 1:0.12221136689186096
Task:1, layer:15, space shape:(720, 406)
Task:1, Layer:15, project_norm:0.32431131753632475, threshold for regime 1:0.1653410941362381
Task:1, layer:16, space shape:(1440, 818)
Task:1, Layer:16, project_norm:0.4852544102878508, threshold for regime 1:0.24720081686973572
Task:1, layer:17, space shape:(80, 61)
Task:1, Layer:17, project_norm:0.2035061258847376, threshold for regime 1:0.10411281138658524
Task:1, layer:18, space shape:(1440, 939)
Task:1, Layer:18, project_norm:0.5146813943357222, threshold for regime 1:0.2622280716896057
Task:1, layer:19, space shape:(1440, 907)
Task:1, Layer:19, project_norm:0.7615601137537548, threshold for regime 1:0.3875320255756378
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:2, layer:0, space shape:(27, 4)
Task:2, Layer:0, project_norm:0.05381189904750688, threshold for regime 1:0.027851048856973648
Task:2, layer:1, space shape:(180, 39)
Task:2, Layer:1, project_norm:0.06357183502906072, threshold for regime 1:0.033382486552000046
Task:2, layer:2, space shape:(180, 74)
Task:2, Layer:2, project_norm:0.06166839788503282, threshold for regime 1:0.03195623308420181
Task:2, layer:3, space shape:(180, 65)
Task:2, Layer:3, project_norm:0.0676790820732326, threshold for regime 1:0.03490480035543442
Task:2, layer:4, space shape:(180, 99)
Task:2, Layer:4, project_norm:0.06435678419490114, threshold for regime 1:0.03285161778330803
Task:2, layer:5, space shape:(180, 76)
Task:2, Layer:5, project_norm:0.07029780835967699, threshold for regime 1:0.036042287945747375
Task:2, layer:6, space shape:(360, 226)
Task:2, Layer:6, project_norm:0.09958428022778121, threshold for regime 1:0.050759270787239075
Task:2, layer:7, space shape:(20, 15)
Task:2, Layer:7, project_norm:0.05191255380768177, threshold for regime 1:0.026646548882126808
Task:2, layer:8, space shape:(360, 233)
Task:2, Layer:8, project_norm:0.10281594677647123, threshold for regime 1:0.05206705257296562
Task:2, layer:9, space shape:(360, 224)
Task:2, Layer:9, project_norm:0.12051335141689826, threshold for regime 1:0.06084016337990761
Task:2, layer:10, space shape:(360, 218)
Task:2, Layer:10, project_norm:0.14704842298591672, threshold for regime 1:0.0748206228017807
Task:2, layer:11, space shape:(720, 514)
Task:2, Layer:11, project_norm:0.21562463745484348, threshold for regime 1:0.10942330956459045
Task:2, layer:12, space shape:(40, 31)
Task:2, Layer:12, project_norm:0.10284732231806132, threshold for regime 1:0.0525711290538311
Task:2, layer:13, space shape:(720, 510)
Task:2, Layer:13, project_norm:0.21054030755018494, threshold for regime 1:0.10697364062070847
Task:2, layer:14, space shape:(720, 533)
Task:2, Layer:14, project_norm:0.24067211192042293, threshold for regime 1:0.12221136689186096
Task:2, layer:15, space shape:(720, 473)
Task:2, Layer:15, project_norm:0.3249538445403798, threshold for regime 1:0.1653410941362381
Task:2, layer:16, space shape:(1440, 994)
Task:2, Layer:16, project_norm:0.4875877829289536, threshold for regime 1:0.24720081686973572
Task:2, layer:17, space shape:(80, 63)
Task:2, Layer:17, project_norm:0.20268967270951257, threshold for regime 1:0.10411281138658524
Task:2, layer:18, space shape:(1440, 1111)
Task:2, Layer:18, project_norm:0.518174187021887, threshold for regime 1:0.2622280716896057
Task:2, layer:19, space shape:(1440, 1080)
Task:2, Layer:19, project_norm:0.7660033634461633, threshold for regime 1:0.3875320255756378
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Layer:0, selected task ID:[0 1]
Layer:1, selected task ID:[0 1]
Layer:2, selected task ID:[0 1]
Layer:3, selected task ID:[0 1]
Layer:4, selected task ID:[0 1]
Layer:5, selected task ID:[2 1]
Layer:6, selected task ID:[2 1]
Layer:7, selected task ID:[2 1]
Layer:8, selected task ID:[2 1]
Layer:9, selected task ID:[2 1]
Layer:10, selected task ID:[2 1]
Layer:11, selected task ID:[1 2]
Layer:12, selected task ID:[1 2]
Layer:13, selected task ID:[2 1]
Layer:14, selected task ID:[1 2]
Layer:15, selected task ID:[1 2]
Layer:16, selected task ID:[1 2]
Layer:17, selected task ID:[2 1]
Layer:18, selected task ID:[1 2]
Layer:19, selected task ID:[1 2]
space1 is not None!
space2 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.019, acc= 99.7% | time=329821.1ms |
 Valid: loss=0.036, acc= 99.0% |
Epoch   2 | Train: loss=0.010, acc= 99.8% | time=346176.9ms |
 Valid: loss=0.028, acc= 99.1% |
Epoch   3 | Train: loss=0.007, acc= 99.9% | time=355325.6ms |
 Valid: loss=0.027, acc= 99.2% |
Epoch   4 | Train: loss=0.007, acc= 99.9% | time=342154.4ms |
 Valid: loss=0.024, acc= 99.2% |
Epoch   5 | Train: loss=0.004, acc= 99.9% | time=340238.3ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch   6 | Train: loss=0.004, acc= 99.9% | time=326330.3ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch   7 | Train: loss=0.002, acc=100.0% | time=345731.9ms |
 Valid: loss=0.019, acc= 99.3% |
Epoch   8 | Train: loss=0.002, acc=100.0% | time=332398.7ms |
 Valid: loss=0.020, acc= 99.2% |
Epoch   9 | Train: loss=0.002, acc=100.0% | time=327912.9ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  10 | Train: loss=0.001, acc=100.0% | time=314048.8ms |
 Valid: loss=0.023, acc= 99.3% |
Epoch  11 | Train: loss=0.001, acc=100.0% | time=330640.1ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  12 | Train: loss=0.001, acc=100.0% | time=337092.4ms |
 Valid: loss=0.021, acc= 99.3% |
 lr=3.3e-02
Epoch  13 | Train: loss=0.001, acc=100.0% | time=337057.9ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  14 | Train: loss=0.000, acc=100.0% | time=322179.5ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  15 | Train: loss=0.000, acc=100.0% | time=329972.2ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  16 | Train: loss=0.000, acc=100.0% | time=321375.9ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  17 | Train: loss=0.000, acc=100.0% | time=318381.7ms |
 Valid: loss=0.019, acc= 99.5% |
Epoch  18 | Train: loss=0.000, acc=100.0% | time=311751.1ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  19 | Train: loss=0.000, acc=100.0% | time=317805.0ms |
 Valid: loss=0.016, acc= 99.4% |
Epoch  20 | Train: loss=0.000, acc=100.0% | time=306120.1ms |
 Valid: loss=0.018, acc= 99.3% |
Epoch  21 | Train: loss=0.000, acc=100.0% | time=321576.0ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  22 | Train: loss=0.000, acc=100.0% | time=323399.6ms |
 Valid: loss=0.019, acc= 99.3% |
Epoch  23 | Train: loss=0.000, acc=100.0% | time=318082.8ms |
 Valid: loss=0.018, acc= 99.5% |
Epoch  24 | Train: loss=0.000, acc=100.0% | time=336225.6ms |
 Valid: loss=0.020, acc= 99.3% |
 lr=1.1e-02
Epoch  25 | Train: loss=0.000, acc=100.0% | time=319444.2ms |
 Valid: loss=0.017, acc= 99.5% |
Epoch  26 | Train: loss=0.000, acc=100.0% | time=330110.6ms |
 Valid: loss=0.017, acc= 99.4% |
Epoch  27 | Train: loss=0.000, acc=100.0% | time=323614.3ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  28 | Train: loss=0.000, acc=100.0% | time=327247.9ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  29 | Train: loss=0.000, acc=100.0% | time=328514.4ms |
 Valid: loss=0.020, acc= 99.4% |
 lr=3.7e-03
Epoch  30 | Train: loss=0.000, acc=100.0% | time=312918.9ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  31 | Train: loss=0.000, acc=100.0% | time=320226.8ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  32 | Train: loss=0.000, acc=100.0% | time=330502.5ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  33 | Train: loss=0.000, acc=100.0% | time=351723.3ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  34 | Train: loss=0.000, acc=100.0% | time=324799.9ms |
 Valid: loss=0.019, acc= 99.4% |
 lr=1.2e-03
Epoch  35 | Train: loss=0.000, acc=100.0% | time=318421.4ms |
 Valid: loss=0.019, acc= 99.3% |
Epoch  36 | Train: loss=0.000, acc=100.0% | time=339336.6ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  37 | Train: loss=0.000, acc=100.0% | time=313740.5ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  38 | Train: loss=0.000, acc=100.0% | time=327501.0ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  39 | Train: loss=0.000, acc=100.0% | time=339921.5ms |
 Valid: loss=0.019, acc= 99.3% |
 lr=4.1e-04
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.015 , acc= 99.6%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.014 , acc= 99.6%
Test: loss=0.014 , acc= 99.5%
Average acc= 99.5%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 7)
threshold for selecting:7340.874905104793
total ranking r = 5
the number of space for current task:5
the new increased space:0, the threshold for new space:7
Ui shape:(27, 5)
activation shape:(180, 10240)
space shape:(180, 51)
threshold for selecting:47786.28352745974
total ranking r = 49
the number of space for current task:49
the new increased space:0, the threshold for new space:51
Ui shape:(180, 49)
activation shape:(180, 10240)
space shape:(180, 88)
threshold for selecting:22473.017982104364
total ranking r = 84
the number of space for current task:84
the new increased space:1, the threshold for new space:88
Ui shape:(180, 84)
activation shape:(180, 10240)
space shape:(180, 78)
threshold for selecting:99342.50477481187
total ranking r = 73
the number of space for current task:73
the new increased space:1, the threshold for new space:78
Ui shape:(180, 73)
activation shape:(180, 10240)
space shape:(180, 112)
threshold for selecting:17349.774448023967
total ranking r = 105
the number of space for current task:105
the new increased space:1, the threshold for new space:112
Ui shape:(180, 105)
activation shape:(180, 2560)
space shape:(180, 89)
threshold for selecting:37194.87939037639
total ranking r = 81
the number of space for current task:81
the new increased space:2, the threshold for new space:89
Ui shape:(180, 81)
activation shape:(360, 2560)
space shape:(360, 253)
threshold for selecting:10843.341397876904
total ranking r = 219
the number of space for current task:219
the new increased space:5, the threshold for new space:253
Ui shape:(360, 219)
activation shape:(20, 2560)
space shape:(20, 15)
threshold for selecting:4664.107996092578
total ranking r = 15
the number of space for current task:15
the new increased space:0, the threshold for new space:15
Ui shape:(20, 15)
activation shape:(360, 2560)
space shape:(360, 256)
threshold for selecting:35202.220923944216
total ranking r = 220
the number of space for current task:220
the new increased space:4, the threshold for new space:256
Ui shape:(360, 220)
activation shape:(360, 12800)
space shape:(360, 247)
threshold for selecting:55410.13520330918
total ranking r = 220
the number of space for current task:220
the new increased space:0, the threshold for new space:247
Ui shape:(360, 220)
activation shape:(360, 3200)
space shape:(360, 244)
threshold for selecting:66767.36962608871
total ranking r = 212
the number of space for current task:212
the new increased space:3, the threshold for new space:244
Ui shape:(360, 212)
activation shape:(720, 3200)
space shape:(720, 551)
threshold for selecting:24615.065767823144
total ranking r = 480
the number of space for current task:480
the new increased space:8, the threshold for new space:551
Ui shape:(720, 480)
activation shape:(40, 3200)
space shape:(40, 32)
threshold for selecting:8689.10070308818
total ranking r = 30
the number of space for current task:30
the new increased space:0, the threshold for new space:32
Ui shape:(40, 30)
activation shape:(720, 6400)
space shape:(720, 556)
threshold for selecting:139215.1421557313
total ranking r = 488
the number of space for current task:488
the new increased space:2, the threshold for new space:556
Ui shape:(720, 488)
activation shape:(720, 6400)
space shape:(720, 564)
threshold for selecting:49791.73846309999
total ranking r = 515
the number of space for current task:515
the new increased space:4, the threshold for new space:564
Ui shape:(720, 515)
activation shape:(720, 1600)
space shape:(720, 496)
threshold for selecting:72192.52183907229
total ranking r = 444
the number of space for current task:444
the new increased space:27, the threshold for new space:496
Ui shape:(720, 444)
activation shape:(1440, 1600)
space shape:(1440, 1009)
threshold for selecting:37053.45686917177
total ranking r = 967
the number of space for current task:967
the new increased space:113, the threshold for new space:1009
Ui shape:(1440, 967)
activation shape:(80, 1600)
space shape:(80, 65)
threshold for selecting:8155.289236273902
total ranking r = 61
the number of space for current task:61
the new increased space:1, the threshold for new space:65
Ui shape:(80, 61)
activation shape:(1440, 1600)
space shape:(1440, 1114)
threshold for selecting:30310.726726868983
total ranking r = 1085
the number of space for current task:1085
the new increased space:94, the threshold for new space:1114
Ui shape:(1440, 1085)
activation shape:(1440, 1600)
space shape:(1440, 1088)
threshold for selecting:25533.148398874648
total ranking r = 1051
the number of space for current task:1051
the new increased space:97, the threshold for new space:1088
Ui shape:(1440, 1051)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.592 , acc= 82.6%
Test: loss=0.594 , acc= 82.3%
Test: loss=0.594 , acc= 82.8%
Test: loss=0.591 , acc= 82.7%
Test: loss=0.594 , acc= 82.8%
current testing task:mnist
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
current testing task:svhn
Test: loss=0.199 , acc= 94.4%
Test: loss=0.199 , acc= 94.4%
Test: loss=0.200 , acc= 94.4%
Test: loss=0.199 , acc= 94.4%
Test: loss=0.199 , acc= 94.4%
current testing task:fashion-mnist
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.6%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Accuracies =
 82.7%   0.0%   0.0%   0.0%   0.0%
 82.8%  99.5%   0.0%   0.0%   0.0%
 82.6%  99.5%  94.4%   0.0%   0.0%
 82.6%  99.5%  94.4%  99.5%   0.0%
****************************************************************************************************
Task  4 (notmnist)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 6)
Task:0, Layer:0, project_norm:0.08468853053020584, threshold for regime 1:0.04304550215601921
Task:0, layer:1, space shape:(180, 42)
Task:0, Layer:1, project_norm:0.07846616345233234, threshold for regime 1:0.04027000069618225
Task:0, layer:2, space shape:(180, 77)
Task:0, Layer:2, project_norm:0.07391651806878378, threshold for regime 1:0.03795656934380531
Task:0, layer:3, space shape:(180, 65)
Task:0, Layer:3, project_norm:0.0853048962081034, threshold for regime 1:0.04350707679986954
Task:0, layer:4, space shape:(180, 99)
Task:0, Layer:4, project_norm:0.0697622107812565, threshold for regime 1:0.03535023331642151
Task:0, layer:5, space shape:(180, 73)
Task:0, Layer:5, project_norm:0.07994962600732122, threshold for regime 1:0.040636979043483734
Task:0, layer:6, space shape:(360, 199)
Task:0, Layer:6, project_norm:0.10366621790237993, threshold for regime 1:0.05286232382059097
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.0551839880416958, threshold for regime 1:0.029062656685709953
Task:0, layer:8, space shape:(360, 204)
Task:0, Layer:8, project_norm:0.0995418614065807, threshold for regime 1:0.05062573775649071
Task:0, layer:9, space shape:(360, 211)
Task:0, Layer:9, project_norm:0.10248328387196673, threshold for regime 1:0.051817428320646286
Task:0, layer:10, space shape:(360, 194)
Task:0, Layer:10, project_norm:0.13610013728630035, threshold for regime 1:0.06920699775218964
Task:0, layer:11, space shape:(720, 417)
Task:0, Layer:11, project_norm:0.19457166246209215, threshold for regime 1:0.0996985137462616
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.09610807554239587, threshold for regime 1:0.0492648109793663
Task:0, layer:13, space shape:(720, 443)
Task:0, Layer:13, project_norm:0.21560270609411644, threshold for regime 1:0.10961095988750458
Task:0, layer:14, space shape:(720, 444)
Task:0, Layer:14, project_norm:0.23746771603218841, threshold for regime 1:0.12164204567670822
Task:0, layer:15, space shape:(720, 324)
Task:0, Layer:15, project_norm:0.29754696730189417, threshold for regime 1:0.15537826716899872
Task:0, layer:16, space shape:(1440, 581)
Task:0, Layer:16, project_norm:0.43213505668573543, threshold for regime 1:0.23367223143577576
Task:0, layer:17, space shape:(80, 56)
Task:0, Layer:17, project_norm:0.20843808078300807, threshold for regime 1:0.10756107419729233
Task:0, layer:18, space shape:(1440, 688)
Task:0, Layer:18, project_norm:0.4362369146543371, threshold for regime 1:0.23807483911514282
Task:0, layer:19, space shape:(1440, 660)
Task:0, Layer:19, project_norm:0.6624549741606427, threshold for regime 1:0.36064285039901733
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:1, layer:0, space shape:(27, 6)
Task:1, Layer:0, project_norm:0.08581231977023894, threshold for regime 1:0.04304550215601921
Task:1, layer:1, space shape:(180, 48)
Task:1, Layer:1, project_norm:0.0789978064320313, threshold for regime 1:0.04027000069618225
Task:1, layer:2, space shape:(180, 83)
Task:1, Layer:2, project_norm:0.07415708900296678, threshold for regime 1:0.03795656934380531
Task:1, layer:3, space shape:(180, 72)
Task:1, Layer:3, project_norm:0.08550047046258456, threshold for regime 1:0.04350707679986954
Task:1, layer:4, space shape:(180, 105)
Task:1, Layer:4, project_norm:0.06991171323285178, threshold for regime 1:0.03535023331642151
Task:1, layer:5, space shape:(180, 78)
Task:1, Layer:5, project_norm:0.08003323826096487, threshold for regime 1:0.040636979043483734
Task:1, layer:6, space shape:(360, 210)
Task:1, Layer:6, project_norm:0.10395792436860805, threshold for regime 1:0.05286232382059097
Task:1, layer:7, space shape:(20, 15)
Task:1, Layer:7, project_norm:0.05641529807570757, threshold for regime 1:0.029062656685709953
Task:1, layer:8, space shape:(360, 215)
Task:1, Layer:8, project_norm:0.09990361832165777, threshold for regime 1:0.05062573775649071
Task:1, layer:9, space shape:(360, 219)
Task:1, Layer:9, project_norm:0.10260439232579892, threshold for regime 1:0.051817428320646286
Task:1, layer:10, space shape:(360, 208)
Task:1, Layer:10, project_norm:0.13643927627515492, threshold for regime 1:0.06920699775218964
Task:1, layer:11, space shape:(720, 462)
Task:1, Layer:11, project_norm:0.19565514656818253, threshold for regime 1:0.0996985137462616
Task:1, layer:12, space shape:(40, 30)
Task:1, Layer:12, project_norm:0.09645904756814083, threshold for regime 1:0.0492648109793663
Task:1, layer:13, space shape:(720, 479)
Task:1, Layer:13, project_norm:0.21627300157108703, threshold for regime 1:0.10961095988750458
Task:1, layer:14, space shape:(720, 503)
Task:1, Layer:14, project_norm:0.23915104393004277, threshold for regime 1:0.12164204567670822
Task:1, layer:15, space shape:(720, 406)
Task:1, Layer:15, project_norm:0.30163972751754214, threshold for regime 1:0.15537826716899872
Task:1, layer:16, space shape:(1440, 818)
Task:1, Layer:16, project_norm:0.4459952981512884, threshold for regime 1:0.23367223143577576
Task:1, layer:17, space shape:(80, 61)
Task:1, Layer:17, project_norm:0.21007999045266504, threshold for regime 1:0.10756107419729233
Task:1, layer:18, space shape:(1440, 939)
Task:1, Layer:18, project_norm:0.4537705808208244, threshold for regime 1:0.23807483911514282
Task:1, layer:19, space shape:(1440, 907)
Task:1, Layer:19, project_norm:0.6877831442193157, threshold for regime 1:0.36064285039901733
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:2, layer:0, space shape:(27, 4)
Task:2, Layer:0, project_norm:0.08401598196401552, threshold for regime 1:0.04304550215601921
Task:2, layer:1, space shape:(180, 39)
Task:2, Layer:1, project_norm:0.07789925880352844, threshold for regime 1:0.04027000069618225
Task:2, layer:2, space shape:(180, 74)
Task:2, Layer:2, project_norm:0.07404377519787243, threshold for regime 1:0.03795656934380531
Task:2, layer:3, space shape:(180, 65)
Task:2, Layer:3, project_norm:0.08542395909474683, threshold for regime 1:0.04350707679986954
Task:2, layer:4, space shape:(180, 99)
Task:2, Layer:4, project_norm:0.06972883506265916, threshold for regime 1:0.03535023331642151
Task:2, layer:5, space shape:(180, 76)
Task:2, Layer:5, project_norm:0.08006925656685013, threshold for regime 1:0.040636979043483734
Task:2, layer:6, space shape:(360, 226)
Task:2, Layer:6, project_norm:0.10427792198558813, threshold for regime 1:0.05286232382059097
Task:2, layer:7, space shape:(20, 15)
Task:2, Layer:7, project_norm:0.05666277662241932, threshold for regime 1:0.029062656685709953
Task:2, layer:8, space shape:(360, 233)
Task:2, Layer:8, project_norm:0.10024331615211408, threshold for regime 1:0.05062573775649071
Task:2, layer:9, space shape:(360, 224)
Task:2, Layer:9, project_norm:0.10271421556284623, threshold for regime 1:0.051817428320646286
Task:2, layer:10, space shape:(360, 218)
Task:2, Layer:10, project_norm:0.136618024962001, threshold for regime 1:0.06920699775218964
Task:2, layer:11, space shape:(720, 514)
Task:2, Layer:11, project_norm:0.19678492291704125, threshold for regime 1:0.0996985137462616
Task:2, layer:12, space shape:(40, 31)
Task:2, Layer:12, project_norm:0.09658220090604039, threshold for regime 1:0.0492648109793663
Task:2, layer:13, space shape:(720, 510)
Task:2, Layer:13, project_norm:0.21682532753372286, threshold for regime 1:0.10961095988750458
Task:2, layer:14, space shape:(720, 533)
Task:2, Layer:14, project_norm:0.2401241309499301, threshold for regime 1:0.12164204567670822
Task:2, layer:15, space shape:(720, 473)
Task:2, Layer:15, project_norm:0.30452824309270676, threshold for regime 1:0.15537826716899872
Task:2, layer:16, space shape:(1440, 994)
Task:2, Layer:16, project_norm:0.4543269511818085, threshold for regime 1:0.23367223143577576
Task:2, layer:17, space shape:(80, 63)
Task:2, Layer:17, project_norm:0.21058011589966558, threshold for regime 1:0.10756107419729233
Task:2, layer:18, space shape:(1440, 1111)
Task:2, Layer:18, project_norm:0.4638410365966083, threshold for regime 1:0.23807483911514282
Task:2, layer:19, space shape:(1440, 1080)
Task:2, Layer:19, project_norm:0.7022232222154742, threshold for regime 1:0.36064285039901733
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:3, layer:0, space shape:(27, 5)
Task:3, Layer:0, project_norm:0.08523254138760947, threshold for regime 1:0.04304550215601921
Task:3, layer:1, space shape:(180, 49)
Task:3, Layer:1, project_norm:0.07907100633802482, threshold for regime 1:0.04027000069618225
Task:3, layer:2, space shape:(180, 84)
Task:3, Layer:2, project_norm:0.07423086194865848, threshold for regime 1:0.03795656934380531
Task:3, layer:3, space shape:(180, 73)
Task:3, Layer:3, project_norm:0.08553235186662926, threshold for regime 1:0.04350707679986954
Task:3, layer:4, space shape:(180, 105)
Task:3, Layer:4, project_norm:0.06991272997043833, threshold for regime 1:0.03535023331642151
Task:3, layer:5, space shape:(180, 81)
Task:3, Layer:5, project_norm:0.08012265196778094, threshold for regime 1:0.040636979043483734
Task:3, layer:6, space shape:(360, 219)
Task:3, Layer:6, project_norm:0.10415248901779263, threshold for regime 1:0.05286232382059097
Task:3, layer:7, space shape:(20, 15)
Task:3, Layer:7, project_norm:0.05669803693050235, threshold for regime 1:0.029062656685709953
Task:3, layer:8, space shape:(360, 220)
Task:3, Layer:8, project_norm:0.09998398982504492, threshold for regime 1:0.05062573775649071
Task:3, layer:9, space shape:(360, 220)
Task:3, Layer:9, project_norm:0.10261715499766651, threshold for regime 1:0.051817428320646286
Task:3, layer:10, space shape:(360, 212)
Task:3, Layer:10, project_norm:0.1365216580004091, threshold for regime 1:0.06920699775218964
Task:3, layer:11, space shape:(720, 480)
Task:3, Layer:11, project_norm:0.19602848696693861, threshold for regime 1:0.0996985137462616
Task:3, layer:12, space shape:(40, 30)
Task:3, Layer:12, project_norm:0.09640708646355409, threshold for regime 1:0.0492648109793663
Task:3, layer:13, space shape:(720, 488)
Task:3, Layer:13, project_norm:0.21644193716061416, threshold for regime 1:0.10961095988750458
Task:3, layer:14, space shape:(720, 515)
Task:3, Layer:14, project_norm:0.23947764448844003, threshold for regime 1:0.12164204567670822
Task:3, layer:15, space shape:(720, 444)
Task:3, Layer:15, project_norm:0.3031027104086521, threshold for regime 1:0.15537826716899872
Task:3, layer:16, space shape:(1440, 967)
Task:3, Layer:16, project_norm:0.4522034440690782, threshold for regime 1:0.23367223143577576
Task:3, layer:17, space shape:(80, 61)
Task:3, Layer:17, project_norm:0.21016580730839424, threshold for regime 1:0.10756107419729233
Task:3, layer:18, space shape:(1440, 1085)
Task:3, Layer:18, project_norm:0.4615217211352398, threshold for regime 1:0.23807483911514282
Task:3, layer:19, space shape:(1440, 1051)
Task:3, Layer:19, project_norm:0.6985864147363687, threshold for regime 1:0.36064285039901733
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Layer:0, selected task ID:[3 1]
Layer:1, selected task ID:[1 3]
Layer:2, selected task ID:[1 3]
Layer:3, selected task ID:[1 3]
Layer:4, selected task ID:[1 3]
Layer:5, selected task ID:[2 3]
Layer:6, selected task ID:[3 2]
Layer:7, selected task ID:[2 3]
Layer:8, selected task ID:[3 2]
Layer:9, selected task ID:[3 2]
Layer:10, selected task ID:[3 2]
Layer:11, selected task ID:[3 2]
Layer:12, selected task ID:[1 2]
Layer:13, selected task ID:[3 2]
Layer:14, selected task ID:[3 2]
Layer:15, selected task ID:[3 2]
Layer:16, selected task ID:[3 2]
Layer:17, selected task ID:[3 2]
Layer:18, selected task ID:[3 2]
Layer:19, selected task ID:[3 2]
space1 is not None!
space2 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.152, acc= 96.0% | time=93873.2ms |
 Valid: loss=0.193, acc= 93.7% |
Epoch   2 | Train: loss=0.176, acc= 95.0% | time=92675.9ms |
 Valid: loss=0.244, acc= 92.3% |
Epoch   3 | Train: loss=0.120, acc= 96.5% | time=95513.3ms |
 Valid: loss=0.184, acc= 93.5% |
Epoch   4 | Train: loss=0.075, acc= 97.9% | time=103034.4ms |
 Valid: loss=0.150, acc= 95.0% |
Epoch   5 | Train: loss=0.087, acc= 97.3% | time=90583.6ms |
 Valid: loss=0.180, acc= 94.3% |
Epoch   6 | Train: loss=0.069, acc= 98.9% | time=98494.6ms |
 Valid: loss=0.159, acc= 95.6% |
Epoch   7 | Train: loss=0.050, acc= 98.8% | time=92493.4ms |
 Valid: loss=0.144, acc= 95.7% |
Epoch   8 | Train: loss=0.020, acc= 99.7% | time=96454.5ms |
 Valid: loss=0.115, acc= 95.6% |
Epoch   9 | Train: loss=0.017, acc= 99.7% | time=97901.7ms |
 Valid: loss=0.119, acc= 96.0% |
Epoch  10 | Train: loss=0.027, acc= 99.5% | time=101348.0ms |
 Valid: loss=0.146, acc= 95.2% |
Epoch  11 | Train: loss=0.028, acc= 99.2% | time=98007.9ms |
 Valid: loss=0.156, acc= 95.2% |
Epoch  12 | Train: loss=0.040, acc= 98.8% | time=90088.3ms |
 Valid: loss=0.156, acc= 94.8% |
Epoch  13 | Train: loss=0.011, acc= 99.9% | time=96409.0ms |
 Valid: loss=0.138, acc= 95.6% |
 lr=3.3e-02
Epoch  14 | Train: loss=0.007, acc= 99.9% | time=92218.6ms |
 Valid: loss=0.128, acc= 96.0% |
Epoch  15 | Train: loss=0.006, acc= 99.9% | time=88761.4ms |
 Valid: loss=0.123, acc= 96.2% |
Epoch  16 | Train: loss=0.008, acc= 99.9% | time=100419.3ms |
 Valid: loss=0.126, acc= 95.6% |
Epoch  17 | Train: loss=0.006, acc= 99.9% | time=100773.9ms |
 Valid: loss=0.113, acc= 96.3% |
Epoch  18 | Train: loss=0.005, acc= 99.9% | time=98306.5ms |
 Valid: loss=0.120, acc= 96.1% |
Epoch  19 | Train: loss=0.005, acc= 99.9% | time=102354.4ms |
 Valid: loss=0.123, acc= 96.2% |
Epoch  20 | Train: loss=0.005, acc= 99.9% | time=92519.0ms |
 Valid: loss=0.119, acc= 96.8% |
Epoch  21 | Train: loss=0.005, acc= 99.9% | time=93840.9ms |
 Valid: loss=0.121, acc= 96.0% |
Epoch  22 | Train: loss=0.005, acc= 99.9% | time=94490.6ms |
 Valid: loss=0.119, acc= 96.1% |
 lr=1.1e-02
Epoch  23 | Train: loss=0.004, acc= 99.9% | time=90050.2ms |
 Valid: loss=0.124, acc= 96.2% |
Epoch  24 | Train: loss=0.004, acc= 99.9% | time=104229.4ms |
 Valid: loss=0.120, acc= 96.3% |
Epoch  25 | Train: loss=0.004, acc= 99.9% | time=93910.5ms |
 Valid: loss=0.119, acc= 96.3% |
Epoch  26 | Train: loss=0.004, acc= 99.9% | time=91237.2ms |
 Valid: loss=0.118, acc= 96.3% |
Epoch  27 | Train: loss=0.004, acc= 99.9% | time=93957.2ms |
 Valid: loss=0.121, acc= 96.4% |
 lr=3.7e-03
Epoch  28 | Train: loss=0.004, acc= 99.9% | time=94780.0ms |
 Valid: loss=0.125, acc= 96.6% |
Epoch  29 | Train: loss=0.004, acc= 99.9% | time=93090.2ms |
 Valid: loss=0.123, acc= 96.0% |
Epoch  30 | Train: loss=0.004, acc= 99.9% | time=87779.3ms |
 Valid: loss=0.118, acc= 96.2% |
Epoch  31 | Train: loss=0.004, acc= 99.9% | time=99514.4ms |
 Valid: loss=0.125, acc= 95.8% |
Epoch  32 | Train: loss=0.004, acc= 99.9% | time=95001.1ms |
 Valid: loss=0.128, acc= 95.8% |
 lr=1.2e-03
Epoch  33 | Train: loss=0.004, acc= 99.9% | time=90758.7ms |
 Valid: loss=0.119, acc= 96.1% |
Epoch  34 | Train: loss=0.004, acc= 99.9% | time=96165.4ms |
 Valid: loss=0.123, acc= 96.1% |
Epoch  35 | Train: loss=0.004, acc= 99.9% | time=97147.3ms |
 Valid: loss=0.119, acc= 96.4% |
Epoch  36 | Train: loss=0.004, acc= 99.9% | time=93785.3ms |
 Valid: loss=0.128, acc= 96.0% |
Epoch  37 | Train: loss=0.004, acc= 99.9% | time=96330.1ms |
 Valid: loss=0.124, acc= 96.3% |
 lr=4.1e-04
Test: loss=0.155 , acc= 95.7%
Test: loss=0.158 , acc= 95.4%
Test: loss=0.154 , acc= 95.6%
Test: loss=0.154 , acc= 95.6%
Test: loss=0.154 , acc= 95.5%
Test: loss=0.155 , acc= 95.5%
Test: loss=0.153 , acc= 95.6%
Test: loss=0.156 , acc= 95.6%
Test: loss=0.155 , acc= 95.5%
Test: loss=0.154 , acc= 95.2%
Average acc= 95.5%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 7)
threshold for selecting:4770.544944862422
total ranking r = 3
the number of space for current task:3
the new increased space:0, the threshold for new space:7
Ui shape:(27, 3)
activation shape:(180, 10240)
space shape:(180, 51)
threshold for selecting:30215.065368050917
total ranking r = 42
the number of space for current task:42
the new increased space:0, the threshold for new space:51
Ui shape:(180, 42)
activation shape:(180, 10240)
space shape:(180, 89)
threshold for selecting:20928.259999999493
total ranking r = 75
the number of space for current task:75
the new increased space:3, the threshold for new space:89
Ui shape:(180, 75)
activation shape:(180, 10240)
space shape:(180, 79)
threshold for selecting:73217.04122996941
total ranking r = 63
the number of space for current task:63
the new increased space:1, the threshold for new space:79
Ui shape:(180, 63)
activation shape:(180, 10240)
space shape:(180, 113)
threshold for selecting:14663.467045829588
total ranking r = 97
the number of space for current task:97
the new increased space:3, the threshold for new space:113
Ui shape:(180, 97)
activation shape:(180, 2560)
space shape:(180, 91)
threshold for selecting:27586.64443421913
total ranking r = 70
the number of space for current task:70
the new increased space:0, the threshold for new space:91
Ui shape:(180, 70)
activation shape:(360, 2560)
space shape:(360, 258)
threshold for selecting:9488.952399977448
total ranking r = 214
the number of space for current task:214
the new increased space:6, the threshold for new space:258
Ui shape:(360, 214)
activation shape:(20, 2560)
space shape:(20, 15)
threshold for selecting:4364.699741116796
total ranking r = 15
the number of space for current task:15
the new increased space:0, the threshold for new space:15
Ui shape:(20, 15)
activation shape:(360, 2560)
space shape:(360, 260)
threshold for selecting:30373.73044632141
total ranking r = 217
the number of space for current task:217
the new increased space:7, the threshold for new space:260
Ui shape:(360, 217)
activation shape:(360, 12800)
space shape:(360, 247)
threshold for selecting:48371.62601322414
total ranking r = 211
the number of space for current task:211
the new increased space:2, the threshold for new space:247
Ui shape:(360, 211)
activation shape:(360, 3200)
space shape:(360, 247)
threshold for selecting:62218.14227006417
total ranking r = 206
the number of space for current task:206
the new increased space:6, the threshold for new space:247
Ui shape:(360, 206)
activation shape:(720, 3200)
space shape:(720, 559)
threshold for selecting:24831.586195323973
total ranking r = 497
the number of space for current task:497
the new increased space:23, the threshold for new space:559
Ui shape:(720, 497)
activation shape:(40, 3200)
space shape:(40, 32)
threshold for selecting:8778.965743859204
total ranking r = 30
the number of space for current task:30
the new increased space:0, the threshold for new space:32
Ui shape:(40, 30)
activation shape:(720, 6400)
space shape:(720, 558)
threshold for selecting:134582.4925889028
total ranking r = 486
the number of space for current task:486
the new increased space:18, the threshold for new space:558
Ui shape:(720, 486)
activation shape:(720, 6400)
space shape:(720, 568)
threshold for selecting:47260.336746539884
total ranking r = 519
the number of space for current task:519
the new increased space:15, the threshold for new space:568
Ui shape:(720, 519)
activation shape:(720, 1600)
space shape:(720, 523)
threshold for selecting:71938.58431873407
total ranking r = 481
the number of space for current task:481
the new increased space:39, the threshold for new space:523
Ui shape:(720, 481)
activation shape:(1440, 1600)
space shape:(1440, 1122)
threshold for selecting:32668.579365909267
total ranking r = 1092
the number of space for current task:1092
the new increased space:87, the threshold for new space:1122
Ui shape:(1440, 1092)
activation shape:(80, 1600)
space shape:(80, 66)
threshold for selecting:7230.653516261125
total ranking r = 62
the number of space for current task:62
the new increased space:0, the threshold for new space:66
Ui shape:(80, 62)
activation shape:(1440, 1600)
space shape:(1440, 1208)
threshold for selecting:32980.607195620934
total ranking r = 1182
the number of space for current task:1182
the new increased space:68, the threshold for new space:1208
Ui shape:(1440, 1182)
activation shape:(1440, 1600)
space shape:(1440, 1185)
threshold for selecting:24909.96176651241
total ranking r = 1158
the number of space for current task:1158
the new increased space:76, the threshold for new space:1185
Ui shape:(1440, 1158)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.596 , acc= 82.5%
Test: loss=0.590 , acc= 82.5%
Test: loss=0.598 , acc= 82.5%
Test: loss=0.593 , acc= 82.3%
Test: loss=0.596 , acc= 82.6%
current testing task:mnist
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
current testing task:svhn
Test: loss=0.199 , acc= 94.4%
Test: loss=0.200 , acc= 94.3%
Test: loss=0.199 , acc= 94.4%
Test: loss=0.200 , acc= 94.4%
Test: loss=0.198 , acc= 94.4%
current testing task:fashion-mnist
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
current testing task:notmnist
Test: loss=0.154 , acc= 95.4%
Test: loss=0.157 , acc= 95.5%
Test: loss=0.153 , acc= 95.6%
Test: loss=0.155 , acc= 95.3%
Test: loss=0.152 , acc= 95.5%
Accuracies =
 82.7%   0.0%   0.0%   0.0%   0.0%
 82.8%  99.5%   0.0%   0.0%   0.0%
 82.6%  99.5%  94.4%   0.0%   0.0%
 82.6%  99.5%  94.4%  99.5%   0.0%
 82.5%  99.5%  94.4%  99.5%  95.4%
--------------------------------------------------
Task Order : [0 1 2 3 4]
Final Avg Accuracy: 94.25%
Backward transfer: -0.08%
[Elapsed time = 50885619.1 ms]
--------------------------------------------------
====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=64, gpm_thro=0.96, lr=0.1, lr_factor=3, lr_min=0.001, lr_patience=5, mixup_alpha=1, mixup_weight=0.01, momentum=0.9, n_epochs=100, pc_valid=0.05, savename='./log/DFTRGP/', seed=2)
====================================================================================================
****************************************************************************************************
Task  0 (cifar10)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.1
----------------------------------------
(0, 'conv1.weight', torch.Size([20, 3, 3, 3]))
(1, 'conv1.scale1', torch.Size([27, 27]))
(2, 'conv1.scale2', torch.Size([27, 27]))
(3, 'bn1.weight', torch.Size([20]))
(4, 'bn1.bias', torch.Size([20]))
(5, 'layer1.0.conv1.weight', torch.Size([20, 20, 3, 3]))
(6, 'layer1.0.conv1.scale1', torch.Size([180, 180]))
(7, 'layer1.0.conv1.scale2', torch.Size([180, 180]))
(8, 'layer1.0.bn1.weight', torch.Size([20]))
(9, 'layer1.0.bn1.bias', torch.Size([20]))
(10, 'layer1.0.conv2.weight', torch.Size([20, 20, 3, 3]))
(11, 'layer1.0.conv2.scale1', torch.Size([180, 180]))
(12, 'layer1.0.conv2.scale2', torch.Size([180, 180]))
(13, 'layer1.0.bn2.weight', torch.Size([20]))
(14, 'layer1.0.bn2.bias', torch.Size([20]))
(15, 'layer1.1.conv1.weight', torch.Size([20, 20, 3, 3]))
(16, 'layer1.1.conv1.scale1', torch.Size([180, 180]))
(17, 'layer1.1.conv1.scale2', torch.Size([180, 180]))
(18, 'layer1.1.bn1.weight', torch.Size([20]))
(19, 'layer1.1.bn1.bias', torch.Size([20]))
(20, 'layer1.1.conv2.weight', torch.Size([20, 20, 3, 3]))
(21, 'layer1.1.conv2.scale1', torch.Size([180, 180]))
(22, 'layer1.1.conv2.scale2', torch.Size([180, 180]))
(23, 'layer1.1.bn2.weight', torch.Size([20]))
(24, 'layer1.1.bn2.bias', torch.Size([20]))
(25, 'layer2.0.conv1.weight', torch.Size([40, 20, 3, 3]))
(26, 'layer2.0.conv1.scale1', torch.Size([180, 180]))
(27, 'layer2.0.conv1.scale2', torch.Size([180, 180]))
(28, 'layer2.0.bn1.weight', torch.Size([40]))
(29, 'layer2.0.bn1.bias', torch.Size([40]))
(30, 'layer2.0.conv2.weight', torch.Size([40, 40, 3, 3]))
(31, 'layer2.0.conv2.scale1', torch.Size([360, 360]))
(32, 'layer2.0.conv2.scale2', torch.Size([360, 360]))
(33, 'layer2.0.bn2.weight', torch.Size([40]))
(34, 'layer2.0.bn2.bias', torch.Size([40]))
(35, 'layer2.0.shortcut.0.weight', torch.Size([40, 20, 1, 1]))
(36, 'layer2.0.shortcut.0.scale1', torch.Size([20, 20]))
(37, 'layer2.0.shortcut.0.scale2', torch.Size([20, 20]))
(38, 'layer2.0.shortcut.1.weight', torch.Size([40]))
(39, 'layer2.0.shortcut.1.bias', torch.Size([40]))
(40, 'layer2.1.conv1.weight', torch.Size([40, 40, 3, 3]))
(41, 'layer2.1.conv1.scale1', torch.Size([360, 360]))
(42, 'layer2.1.conv1.scale2', torch.Size([360, 360]))
(43, 'layer2.1.bn1.weight', torch.Size([40]))
(44, 'layer2.1.bn1.bias', torch.Size([40]))
(45, 'layer2.1.conv2.weight', torch.Size([40, 40, 3, 3]))
(46, 'layer2.1.conv2.scale1', torch.Size([360, 360]))
(47, 'layer2.1.conv2.scale2', torch.Size([360, 360]))
(48, 'layer2.1.bn2.weight', torch.Size([40]))
(49, 'layer2.1.bn2.bias', torch.Size([40]))
(50, 'layer3.0.conv1.weight', torch.Size([80, 40, 3, 3]))
(51, 'layer3.0.conv1.scale1', torch.Size([360, 360]))
(52, 'layer3.0.conv1.scale2', torch.Size([360, 360]))
(53, 'layer3.0.bn1.weight', torch.Size([80]))
(54, 'layer3.0.bn1.bias', torch.Size([80]))
(55, 'layer3.0.conv2.weight', torch.Size([80, 80, 3, 3]))
(56, 'layer3.0.conv2.scale1', torch.Size([720, 720]))
(57, 'layer3.0.conv2.scale2', torch.Size([720, 720]))
(58, 'layer3.0.bn2.weight', torch.Size([80]))
(59, 'layer3.0.bn2.bias', torch.Size([80]))
(60, 'layer3.0.shortcut.0.weight', torch.Size([80, 40, 1, 1]))
(61, 'layer3.0.shortcut.0.scale1', torch.Size([40, 40]))
(62, 'layer3.0.shortcut.0.scale2', torch.Size([40, 40]))
(63, 'layer3.0.shortcut.1.weight', torch.Size([80]))
(64, 'layer3.0.shortcut.1.bias', torch.Size([80]))
(65, 'layer3.1.conv1.weight', torch.Size([80, 80, 3, 3]))
(66, 'layer3.1.conv1.scale1', torch.Size([720, 720]))
(67, 'layer3.1.conv1.scale2', torch.Size([720, 720]))
(68, 'layer3.1.bn1.weight', torch.Size([80]))
(69, 'layer3.1.bn1.bias', torch.Size([80]))
(70, 'layer3.1.conv2.weight', torch.Size([80, 80, 3, 3]))
(71, 'layer3.1.conv2.scale1', torch.Size([720, 720]))
(72, 'layer3.1.conv2.scale2', torch.Size([720, 720]))
(73, 'layer3.1.bn2.weight', torch.Size([80]))
(74, 'layer3.1.bn2.bias', torch.Size([80]))
(75, 'layer4.0.conv1.weight', torch.Size([160, 80, 3, 3]))
(76, 'layer4.0.conv1.scale1', torch.Size([720, 720]))
(77, 'layer4.0.conv1.scale2', torch.Size([720, 720]))
(78, 'layer4.0.bn1.weight', torch.Size([160]))
(79, 'layer4.0.bn1.bias', torch.Size([160]))
(80, 'layer4.0.conv2.weight', torch.Size([160, 160, 3, 3]))
(81, 'layer4.0.conv2.scale1', torch.Size([1440, 1440]))
(82, 'layer4.0.conv2.scale2', torch.Size([1440, 1440]))
(83, 'layer4.0.bn2.weight', torch.Size([160]))
(84, 'layer4.0.bn2.bias', torch.Size([160]))
(85, 'layer4.0.shortcut.0.weight', torch.Size([160, 80, 1, 1]))
(86, 'layer4.0.shortcut.0.scale1', torch.Size([80, 80]))
(87, 'layer4.0.shortcut.0.scale2', torch.Size([80, 80]))
(88, 'layer4.0.shortcut.1.weight', torch.Size([160]))
(89, 'layer4.0.shortcut.1.bias', torch.Size([160]))
(90, 'layer4.1.conv1.weight', torch.Size([160, 160, 3, 3]))
(91, 'layer4.1.conv1.scale1', torch.Size([1440, 1440]))
(92, 'layer4.1.conv1.scale2', torch.Size([1440, 1440]))
(93, 'layer4.1.bn1.weight', torch.Size([160]))
(94, 'layer4.1.bn1.bias', torch.Size([160]))
(95, 'layer4.1.conv2.weight', torch.Size([160, 160, 3, 3]))
(96, 'layer4.1.conv2.scale1', torch.Size([1440, 1440]))
(97, 'layer4.1.conv2.scale2', torch.Size([1440, 1440]))
(98, 'layer4.1.bn2.weight', torch.Size([160]))
(99, 'layer4.1.bn2.bias', torch.Size([160]))
(100, 'linear.0.weight', torch.Size([10, 640]))
(101, 'linear.1.weight', torch.Size([10, 640]))
(102, 'linear.2.weight', torch.Size([10, 640]))
(103, 'linear.3.weight', torch.Size([10, 640]))
(104, 'linear.4.weight', torch.Size([10, 640]))
Model parameters ---
(0, 'conv1.weight', torch.Size([20, 3, 3, 3]))
(5, 'layer1.0.conv1.weight', torch.Size([20, 20, 3, 3]))
(10, 'layer1.0.conv2.weight', torch.Size([20, 20, 3, 3]))
(15, 'layer1.1.conv1.weight', torch.Size([20, 20, 3, 3]))
(20, 'layer1.1.conv2.weight', torch.Size([20, 20, 3, 3]))
(25, 'layer2.0.conv1.weight', torch.Size([40, 20, 3, 3]))
(30, 'layer2.0.conv2.weight', torch.Size([40, 40, 3, 3]))
(35, 'layer2.0.shortcut.0.weight', torch.Size([40, 20, 1, 1]))
(40, 'layer2.1.conv1.weight', torch.Size([40, 40, 3, 3]))
(45, 'layer2.1.conv2.weight', torch.Size([40, 40, 3, 3]))
(50, 'layer3.0.conv1.weight', torch.Size([80, 40, 3, 3]))
(55, 'layer3.0.conv2.weight', torch.Size([80, 80, 3, 3]))
(60, 'layer3.0.shortcut.0.weight', torch.Size([80, 40, 1, 1]))
(65, 'layer3.1.conv1.weight', torch.Size([80, 80, 3, 3]))
(70, 'layer3.1.conv2.weight', torch.Size([80, 80, 3, 3]))
(75, 'layer4.0.conv1.weight', torch.Size([160, 80, 3, 3]))
(80, 'layer4.0.conv2.weight', torch.Size([160, 160, 3, 3]))
(85, 'layer4.0.shortcut.0.weight', torch.Size([160, 80, 1, 1]))
(90, 'layer4.1.conv1.weight', torch.Size([160, 160, 3, 3]))
(95, 'layer4.1.conv2.weight', torch.Size([160, 160, 3, 3]))
----------------------------------------
Epoch   1 | Train: loss=1.477, acc= 46.2% | time=88948.2ms |
 Valid: loss=1.534, acc= 44.3% |
 *
Epoch   2 | Train: loss=1.290, acc= 51.0% | time=74973.0ms |
 Valid: loss=1.343, acc= 51.1% |
 *
Epoch   3 | Train: loss=0.983, acc= 63.9% | time=75569.8ms |
 Valid: loss=1.061, acc= 61.2% |
 *
Epoch   4 | Train: loss=0.706, acc= 75.2% | time=72268.1ms |
 Valid: loss=0.808, acc= 71.3% |
 *
Epoch   5 | Train: loss=0.624, acc= 77.9% | time=87105.7ms |
 Valid: loss=0.763, acc= 72.5% |
 *
Epoch   6 | Train: loss=0.698, acc= 75.1% | time=79786.7ms |
 Valid: loss=0.863, acc= 68.9% |
Epoch   7 | Train: loss=0.449, acc= 84.9% | time=83066.7ms |
 Valid: loss=0.663, acc= 76.8% |
 *
Epoch   8 | Train: loss=0.446, acc= 84.6% | time=75091.5ms |
 Valid: loss=0.696, acc= 74.6% |
Epoch   9 | Train: loss=0.392, acc= 85.6% | time=79536.5ms |
 Valid: loss=0.727, acc= 75.8% |
Epoch  10 | Train: loss=0.297, acc= 89.9% | time=91972.6ms |
 Valid: loss=0.731, acc= 76.9% |
Epoch  11 | Train: loss=0.179, acc= 95.4% | time=93455.8ms |
 Valid: loss=0.633, acc= 78.0% |
 *
Epoch  12 | Train: loss=0.165, acc= 94.6% | time=70381.2ms |
 Valid: loss=0.720, acc= 78.0% |
Epoch  13 | Train: loss=0.192, acc= 94.3% | time=73079.6ms |
 Valid: loss=0.706, acc= 77.4% |
Epoch  14 | Train: loss=0.137, acc= 96.1% | time=76136.0ms |
 Valid: loss=0.688, acc= 78.4% |
Epoch  15 | Train: loss=0.135, acc= 96.5% | time=70951.5ms |
 Valid: loss=0.734, acc= 78.0% |
Epoch  16 | Train: loss=0.091, acc= 97.2% | time=77578.8ms |
 Valid: loss=0.758, acc= 78.6% |
 lr=3.3e-02
Epoch  17 | Train: loss=0.013, acc=100.0% | time=93352.8ms |
 Valid: loss=0.599, acc= 81.9% |
 *
Epoch  18 | Train: loss=0.009, acc=100.0% | time=83761.0ms |
 Valid: loss=0.573, acc= 82.8% |
 *
Epoch  19 | Train: loss=0.009, acc=100.0% | time=75917.4ms |
 Valid: loss=0.591, acc= 82.5% |
Epoch  20 | Train: loss=0.006, acc=100.0% | time=74545.8ms |
 Valid: loss=0.594, acc= 82.6% |
Epoch  21 | Train: loss=0.004, acc=100.0% | time=72716.7ms |
 Valid: loss=0.566, acc= 83.6% |
 *
Epoch  22 | Train: loss=0.011, acc= 99.9% | time=80184.8ms |
 Valid: loss=0.649, acc= 81.9% |
Epoch  23 | Train: loss=0.006, acc=100.0% | time=71791.5ms |
 Valid: loss=0.591, acc= 82.7% |
Epoch  24 | Train: loss=0.004, acc=100.0% | time=74347.1ms |
 Valid: loss=0.582, acc= 82.8% |
Epoch  25 | Train: loss=0.004, acc=100.0% | time=68051.5ms |
 Valid: loss=0.573, acc= 83.2% |
Epoch  26 | Train: loss=0.004, acc=100.0% | time=85727.4ms |
 Valid: loss=0.569, acc= 83.0% |
 lr=1.1e-02
Epoch  27 | Train: loss=0.003, acc=100.0% | time=65621.0ms |
 Valid: loss=0.581, acc= 83.0% |
Epoch  28 | Train: loss=0.003, acc=100.0% | time=72694.1ms |
 Valid: loss=0.574, acc= 83.4% |
Epoch  29 | Train: loss=0.004, acc=100.0% | time=79600.9ms |
 Valid: loss=0.570, acc= 83.0% |
Epoch  30 | Train: loss=0.004, acc=100.0% | time=95332.9ms |
 Valid: loss=0.584, acc= 82.6% |
Epoch  31 | Train: loss=0.004, acc=100.0% | time=74640.5ms |
 Valid: loss=0.583, acc= 83.0% |
 lr=3.7e-03
Epoch  32 | Train: loss=0.003, acc=100.0% | time=76859.2ms |
 Valid: loss=0.577, acc= 83.3% |
Epoch  33 | Train: loss=0.004, acc=100.0% | time=72690.1ms |
 Valid: loss=0.570, acc= 83.0% |
Epoch  34 | Train: loss=0.003, acc=100.0% | time=73944.3ms |
 Valid: loss=0.573, acc= 83.2% |
Epoch  35 | Train: loss=0.004, acc=100.0% | time=74582.8ms |
 Valid: loss=0.573, acc= 83.1% |
Epoch  36 | Train: loss=0.004, acc=100.0% | time=72761.6ms |
 Valid: loss=0.576, acc= 82.9% |
 lr=1.2e-03
Epoch  37 | Train: loss=0.003, acc=100.0% | time=74516.7ms |
 Valid: loss=0.574, acc= 83.1% |
Epoch  38 | Train: loss=0.004, acc=100.0% | time=76067.0ms |
 Valid: loss=0.567, acc= 83.2% |
Epoch  39 | Train: loss=0.003, acc=100.0% | time=76292.4ms |
 Valid: loss=0.575, acc= 83.4% |
Epoch  40 | Train: loss=0.003, acc=100.0% | time=72210.7ms |
 Valid: loss=0.575, acc= 83.0% |
Epoch  41 | Train: loss=0.004, acc=100.0% | time=77681.7ms |
 Valid: loss=0.574, acc= 82.9% |
 lr=4.1e-04
----------------------------------------
Test: loss=0.616 , acc= 82.2%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.623 , acc= 82.0%
Test: loss=0.621 , acc= 82.2%
Test: loss=0.622 , acc= 81.9%
Test: loss=0.623 , acc= 82.3%
Test: loss=0.622 , acc= 82.3%
Accuracies =
 82.2%   0.0%   0.0%   0.0%   0.0%
****************************************************************************************************
Task  1 (mnist)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 5)
Task:0, Layer:0, project_norm:0.06650863391663818, threshold for regime 1:0.034670520573854446
Task:0, layer:1, space shape:(180, 37)
Task:0, Layer:1, project_norm:0.05426056727491931, threshold for regime 1:0.02844042144715786
Task:0, layer:2, space shape:(180, 77)
Task:0, Layer:2, project_norm:0.058505339644117214, threshold for regime 1:0.03001953475177288
Task:0, layer:3, space shape:(180, 59)
Task:0, Layer:3, project_norm:0.059535050693922544, threshold for regime 1:0.030480120331048965
Task:0, layer:4, space shape:(180, 85)
Task:0, Layer:4, project_norm:0.057030285779786444, threshold for regime 1:0.029015464708209038
Task:0, layer:5, space shape:(180, 66)
Task:0, Layer:5, project_norm:0.06863574290067204, threshold for regime 1:0.03515488654375076
Task:0, layer:6, space shape:(360, 201)
Task:0, Layer:6, project_norm:0.10096947821940955, threshold for regime 1:0.051697276532649994
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.048839157459910756, threshold for regime 1:0.025385448709130287
Task:0, layer:8, space shape:(360, 203)
Task:0, Layer:8, project_norm:0.08474150064236519, threshold for regime 1:0.0433010496199131
Task:0, layer:9, space shape:(360, 221)
Task:0, Layer:9, project_norm:0.09291570814264354, threshold for regime 1:0.04706132039427757
Task:0, layer:10, space shape:(360, 201)
Task:0, Layer:10, project_norm:0.12313659978299753, threshold for regime 1:0.06301897019147873
Task:0, layer:11, space shape:(720, 435)
Task:0, Layer:11, project_norm:0.18720851678464964, threshold for regime 1:0.09652747958898544
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.08955006121793303, threshold for regime 1:0.046197131276130676
Task:0, layer:13, space shape:(720, 466)
Task:0, Layer:13, project_norm:0.18126506574926463, threshold for regime 1:0.09230818599462509
Task:0, layer:14, space shape:(720, 479)
Task:0, Layer:14, project_norm:0.2007876696627983, threshold for regime 1:0.10281641781330109
Task:0, layer:15, space shape:(720, 351)
Task:0, Layer:15, project_norm:0.27060092638903865, threshold for regime 1:0.1419687122106552
Task:0, layer:16, space shape:(1440, 628)
Task:0, Layer:16, project_norm:0.4065193927555441, threshold for regime 1:0.22230415046215057
Task:0, layer:17, space shape:(80, 59)
Task:0, Layer:17, project_norm:0.20107241933869271, threshold for regime 1:0.10360131412744522
Task:0, layer:18, space shape:(1440, 693)
Task:0, Layer:18, project_norm:0.42085298320086767, threshold for regime 1:0.23076991736888885
Task:0, layer:19, space shape:(1440, 663)
Task:0, Layer:19, project_norm:0.6347606704272963, threshold for regime 1:0.34721487760543823
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
space1 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.031, acc= 99.4% | time=228266.2ms |
 Valid: loss=0.043, acc= 98.8% |
Epoch   2 | Train: loss=0.022, acc= 99.6% | time=235016.2ms |
 Valid: loss=0.041, acc= 98.9% |
Epoch   3 | Train: loss=0.015, acc= 99.8% | time=220843.4ms |
 Valid: loss=0.030, acc= 99.2% |
Epoch   4 | Train: loss=0.013, acc= 99.8% | time=227685.8ms |
 Valid: loss=0.027, acc= 99.1% |
Epoch   5 | Train: loss=0.011, acc= 99.8% | time=235664.0ms |
 Valid: loss=0.030, acc= 99.0% |
Epoch   6 | Train: loss=0.008, acc= 99.9% | time=228671.2ms |
 Valid: loss=0.026, acc= 99.3% |
Epoch   7 | Train: loss=0.006, acc= 99.9% | time=225384.3ms |
 Valid: loss=0.025, acc= 99.3% |
Epoch   8 | Train: loss=0.004, acc= 99.9% | time=231287.0ms |
 Valid: loss=0.023, acc= 99.2% |
Epoch   9 | Train: loss=0.007, acc= 99.9% | time=228798.9ms |
 Valid: loss=0.025, acc= 99.1% |
Epoch  10 | Train: loss=0.003, acc=100.0% | time=229438.5ms |
 Valid: loss=0.024, acc= 99.4% |
Epoch  11 | Train: loss=0.002, acc=100.0% | time=237380.0ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  12 | Train: loss=0.002, acc=100.0% | time=235332.8ms |
 Valid: loss=0.024, acc= 99.4% |
Epoch  13 | Train: loss=0.002, acc=100.0% | time=231202.9ms |
 Valid: loss=0.024, acc= 99.3% |
Epoch  14 | Train: loss=0.001, acc=100.0% | time=228402.3ms |
 Valid: loss=0.021, acc= 99.5% |
Epoch  15 | Train: loss=0.001, acc=100.0% | time=226719.1ms |
 Valid: loss=0.021, acc= 99.5% |
Epoch  16 | Train: loss=0.001, acc=100.0% | time=213862.8ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  17 | Train: loss=0.001, acc=100.0% | time=233206.3ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  18 | Train: loss=0.001, acc=100.0% | time=231601.2ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  19 | Train: loss=0.001, acc=100.0% | time=232364.5ms |
 Valid: loss=0.023, acc= 99.4% |
Epoch  20 | Train: loss=0.000, acc=100.0% | time=230196.3ms |
 Valid: loss=0.023, acc= 99.4% |
Epoch  21 | Train: loss=0.000, acc=100.0% | time=223225.7ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  22 | Train: loss=0.000, acc=100.0% | time=226923.5ms |
 Valid: loss=0.022, acc= 99.4% |
Epoch  23 | Train: loss=0.000, acc=100.0% | time=220177.3ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  24 | Train: loss=0.000, acc=100.0% | time=220925.4ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  25 | Train: loss=0.000, acc=100.0% | time=216021.3ms |
 Valid: loss=0.022, acc= 99.5% |
Epoch  26 | Train: loss=0.000, acc=100.0% | time=219156.9ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  27 | Train: loss=0.000, acc=100.0% | time=216431.5ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  28 | Train: loss=0.000, acc=100.0% | time=197253.9ms |
 Valid: loss=0.021, acc= 99.5% |
Epoch  29 | Train: loss=0.000, acc=100.0% | time=222479.3ms |
 Valid: loss=0.021, acc= 99.5% |
Epoch  30 | Train: loss=0.000, acc=100.0% | time=207638.7ms |
 Valid: loss=0.022, acc= 99.5% |
Epoch  31 | Train: loss=0.000, acc=100.0% | time=211213.7ms |
 Valid: loss=0.021, acc= 99.5% |
Epoch  32 | Train: loss=0.000, acc=100.0% | time=219453.3ms |
 Valid: loss=0.021, acc= 99.4% |
 lr=3.3e-02
Epoch  33 | Train: loss=0.000, acc=100.0% | time=216357.9ms |
 Valid: loss=0.021, acc= 99.5% |
Epoch  34 | Train: loss=0.000, acc=100.0% | time=222382.3ms |
 Valid: loss=0.022, acc= 99.4% |
Epoch  35 | Train: loss=0.000, acc=100.0% | time=208671.9ms |
 Valid: loss=0.021, acc= 99.5% |
Epoch  36 | Train: loss=0.000, acc=100.0% | time=206175.0ms |
 Valid: loss=0.022, acc= 99.5% |
Epoch  37 | Train: loss=0.000, acc=100.0% | time=216474.1ms |
 Valid: loss=0.022, acc= 99.4% |
 lr=1.1e-02
Epoch  38 | Train: loss=0.000, acc=100.0% | time=214461.8ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  39 | Train: loss=0.000, acc=100.0% | time=215997.9ms |
 Valid: loss=0.022, acc= 99.4% |
Epoch  40 | Train: loss=0.000, acc=100.0% | time=217305.0ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  41 | Train: loss=0.000, acc=100.0% | time=232261.7ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  42 | Train: loss=0.000, acc=100.0% | time=221763.9ms |
 Valid: loss=0.022, acc= 99.4% |
 lr=3.7e-03
Epoch  43 | Train: loss=0.000, acc=100.0% | time=220250.8ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  44 | Train: loss=0.000, acc=100.0% | time=219416.6ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  45 | Train: loss=0.000, acc=100.0% | time=230566.6ms |
 Valid: loss=0.022, acc= 99.5% |
Epoch  46 | Train: loss=0.000, acc=100.0% | time=240868.6ms |
 Valid: loss=0.021, acc= 99.5% |
Epoch  47 | Train: loss=0.000, acc=100.0% | time=241219.7ms |
 Valid: loss=0.021, acc= 99.3% |
 lr=1.2e-03
Epoch  48 | Train: loss=0.000, acc=100.0% | time=308682.5ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  49 | Train: loss=0.000, acc=100.0% | time=305865.8ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  50 | Train: loss=0.000, acc=100.0% | time=256611.5ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  51 | Train: loss=0.000, acc=100.0% | time=297980.1ms |
 Valid: loss=0.022, acc= 99.4% |
Epoch  52 | Train: loss=0.000, acc=100.0% | time=323078.1ms |
 Valid: loss=0.022, acc= 99.5% |
Epoch  53 | Train: loss=0.000, acc=100.0% | time=264846.7ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  54 | Train: loss=0.000, acc=100.0% | time=309048.9ms |
 Valid: loss=0.022, acc= 99.4% |
Epoch  55 | Train: loss=0.000, acc=100.0% | time=324221.8ms |
 Valid: loss=0.021, acc= 99.4% |
 lr=4.1e-04
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Average acc= 99.5%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 5)
threshold for selecting:19465.03851680754
total ranking r = 5
the number of space for current task:5
the new increased space:0, the threshold for new space:5
Ui shape:(27, 5)
activation shape:(180, 10240)
space shape:(180, 37)
threshold for selecting:86219.97326608929
total ranking r = 44
the number of space for current task:44
the new increased space:8, the threshold for new space:37
Ui shape:(180, 44)
activation shape:(180, 10240)
space shape:(180, 77)
threshold for selecting:35733.46370858854
total ranking r = 82
the number of space for current task:82
the new increased space:7, the threshold for new space:77
Ui shape:(180, 82)
activation shape:(180, 10240)
space shape:(180, 59)
threshold for selecting:154114.6977823876
total ranking r = 67
the number of space for current task:67
the new increased space:8, the threshold for new space:59
Ui shape:(180, 67)
activation shape:(180, 10240)
space shape:(180, 85)
threshold for selecting:29625.467055402012
total ranking r = 92
the number of space for current task:92
the new increased space:8, the threshold for new space:85
Ui shape:(180, 92)
activation shape:(180, 2560)
space shape:(180, 66)
threshold for selecting:55202.9752583634
total ranking r = 73
the number of space for current task:73
the new increased space:10, the threshold for new space:66
Ui shape:(180, 73)
activation shape:(360, 2560)
space shape:(360, 201)
threshold for selecting:24174.76496217933
total ranking r = 220
the number of space for current task:220
the new increased space:29, the threshold for new space:201
Ui shape:(360, 220)
activation shape:(20, 2560)
space shape:(20, 13)
threshold for selecting:7134.717831569014
total ranking r = 15
the number of space for current task:15
the new increased space:1, the threshold for new space:13
Ui shape:(20, 15)
activation shape:(360, 2560)
space shape:(360, 203)
threshold for selecting:82371.58913583423
total ranking r = 224
the number of space for current task:224
the new increased space:32, the threshold for new space:203
Ui shape:(360, 224)
activation shape:(360, 12800)
space shape:(360, 221)
threshold for selecting:79951.36416911872
total ranking r = 223
the number of space for current task:223
the new increased space:19, the threshold for new space:221
Ui shape:(360, 223)
activation shape:(360, 3200)
space shape:(360, 201)
threshold for selecting:116032.7384645835
total ranking r = 216
the number of space for current task:216
the new increased space:28, the threshold for new space:201
Ui shape:(360, 216)
activation shape:(720, 3200)
space shape:(720, 435)
threshold for selecting:62759.55919428345
total ranking r = 483
the number of space for current task:483
the new increased space:66, the threshold for new space:435
Ui shape:(720, 483)
activation shape:(40, 3200)
space shape:(40, 29)
threshold for selecting:12417.491065400241
total ranking r = 31
the number of space for current task:31
the new increased space:1, the threshold for new space:29
Ui shape:(40, 31)
activation shape:(720, 6400)
space shape:(720, 466)
threshold for selecting:316884.71948258666
total ranking r = 492
the number of space for current task:492
the new increased space:56, the threshold for new space:466
Ui shape:(720, 492)
activation shape:(720, 6400)
space shape:(720, 479)
threshold for selecting:99808.4931584081
total ranking r = 510
the number of space for current task:510
the new increased space:56, the threshold for new space:479
Ui shape:(720, 510)
activation shape:(720, 1600)
space shape:(720, 351)
threshold for selecting:208014.86951882564
total ranking r = 420
the number of space for current task:420
the new increased space:84, the threshold for new space:351
Ui shape:(720, 420)
activation shape:(1440, 1600)
space shape:(1440, 628)
threshold for selecting:114424.13662235848
total ranking r = 848
the number of space for current task:848
the new increased space:219, the threshold for new space:628
Ui shape:(1440, 848)
activation shape:(80, 1600)
space shape:(80, 59)
threshold for selecting:13312.935402675103
total ranking r = 62
the number of space for current task:62
the new increased space:4, the threshold for new space:59
Ui shape:(80, 62)
activation shape:(1440, 1600)
space shape:(1440, 693)
threshold for selecting:145818.52477742697
total ranking r = 940
the number of space for current task:940
the new increased space:246, the threshold for new space:693
Ui shape:(1440, 940)
activation shape:(1440, 1600)
space shape:(1440, 663)
threshold for selecting:101236.96363223594
total ranking r = 910
the number of space for current task:910
the new increased space:246, the threshold for new space:663
Ui shape:(1440, 910)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.628 , acc= 82.0%
Test: loss=0.625 , acc= 81.9%
Test: loss=0.632 , acc= 82.1%
Test: loss=0.628 , acc= 82.1%
Test: loss=0.628 , acc= 82.1%
current testing task:mnist
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Accuracies =
 82.2%   0.0%   0.0%   0.0%   0.0%
 82.0%  99.5%   0.0%   0.0%   0.0%
****************************************************************************************************
Task  2 (svhn)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 5)
Task:0, Layer:0, project_norm:0.05578658150610684, threshold for regime 1:0.02818709798157215
Task:0, layer:1, space shape:(180, 37)
Task:0, Layer:1, project_norm:0.05483311152780353, threshold for regime 1:0.028112975880503654
Task:0, layer:2, space shape:(180, 77)
Task:0, Layer:2, project_norm:0.04922426301688308, threshold for regime 1:0.02526511251926422
Task:0, layer:3, space shape:(180, 59)
Task:0, Layer:3, project_norm:0.05056691679655627, threshold for regime 1:0.0259412731975317
Task:0, layer:4, space shape:(180, 85)
Task:0, Layer:4, project_norm:0.03832634978145533, threshold for regime 1:0.019754430279135704
Task:0, layer:5, space shape:(180, 66)
Task:0, Layer:5, project_norm:0.04722226554889975, threshold for regime 1:0.02437041513621807
Task:0, layer:6, space shape:(360, 201)
Task:0, Layer:6, project_norm:0.058012984704710634, threshold for regime 1:0.029802678152918816
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.031093962688591707, threshold for regime 1:0.016527149826288223
Task:0, layer:8, space shape:(360, 203)
Task:0, Layer:8, project_norm:0.053664749353858114, threshold for regime 1:0.027419425547122955
Task:0, layer:9, space shape:(360, 221)
Task:0, Layer:9, project_norm:0.06135984726736022, threshold for regime 1:0.0310017392039299
Task:0, layer:10, space shape:(360, 201)
Task:0, Layer:10, project_norm:0.08051977539848235, threshold for regime 1:0.041046302765607834
Task:0, layer:11, space shape:(720, 435)
Task:0, Layer:11, project_norm:0.11126525905849602, threshold for regime 1:0.05711625888943672
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.05475057698112557, threshold for regime 1:0.02800580859184265
Task:0, layer:13, space shape:(720, 466)
Task:0, Layer:13, project_norm:0.10204506204216758, threshold for regime 1:0.05192301422357559
Task:0, layer:14, space shape:(720, 479)
Task:0, Layer:14, project_norm:0.10818991922132654, threshold for regime 1:0.05521783232688904
Task:0, layer:15, space shape:(720, 351)
Task:0, Layer:15, project_norm:0.13182374915433176, threshold for regime 1:0.06893135607242584
Task:0, layer:16, space shape:(1440, 628)
Task:0, Layer:16, project_norm:0.2060945329161917, threshold for regime 1:0.10978540778160095
Task:0, layer:17, space shape:(80, 59)
Task:0, Layer:17, project_norm:0.10917651912701856, threshold for regime 1:0.056015800684690475
Task:0, layer:18, space shape:(1440, 693)
Task:0, Layer:18, project_norm:0.2135214510900467, threshold for regime 1:0.11460497230291367
Task:0, layer:19, space shape:(1440, 663)
Task:0, Layer:19, project_norm:0.32423564092375673, threshold for regime 1:0.1734338253736496
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:1, layer:0, space shape:(27, 5)
Task:1, Layer:0, project_norm:0.05265520245711772, threshold for regime 1:0.02818709798157215
Task:1, layer:1, space shape:(180, 44)
Task:1, Layer:1, project_norm:0.054870064749259664, threshold for regime 1:0.028112975880503654
Task:1, layer:2, space shape:(180, 82)
Task:1, Layer:2, project_norm:0.04947193048871885, threshold for regime 1:0.02526511251926422
Task:1, layer:3, space shape:(180, 67)
Task:1, Layer:3, project_norm:0.050911148579615595, threshold for regime 1:0.0259412731975317
Task:1, layer:4, space shape:(180, 92)
Task:1, Layer:4, project_norm:0.038591802738569055, threshold for regime 1:0.019754430279135704
Task:1, layer:5, space shape:(180, 73)
Task:1, Layer:5, project_norm:0.047369392500018946, threshold for regime 1:0.02437041513621807
Task:1, layer:6, space shape:(360, 220)
Task:1, Layer:6, project_norm:0.05824570094908636, threshold for regime 1:0.029802678152918816
Task:1, layer:7, space shape:(20, 15)
Task:1, Layer:7, project_norm:0.03179260663045939, threshold for regime 1:0.016527149826288223
Task:1, layer:8, space shape:(360, 224)
Task:1, Layer:8, project_norm:0.05392847281465741, threshold for regime 1:0.027419425547122955
Task:1, layer:9, space shape:(360, 223)
Task:1, Layer:9, project_norm:0.06134107187364388, threshold for regime 1:0.0310017392039299
Task:1, layer:10, space shape:(360, 216)
Task:1, Layer:10, project_norm:0.08068355036989901, threshold for regime 1:0.041046302765607834
Task:1, layer:11, space shape:(720, 483)
Task:1, Layer:11, project_norm:0.11181144263548633, threshold for regime 1:0.05711625888943672
Task:1, layer:12, space shape:(40, 31)
Task:1, Layer:12, project_norm:0.05506933349004354, threshold for regime 1:0.02800580859184265
Task:1, layer:13, space shape:(720, 492)
Task:1, Layer:13, project_norm:0.10221244801465625, threshold for regime 1:0.05192301422357559
Task:1, layer:14, space shape:(720, 510)
Task:1, Layer:14, project_norm:0.1085002976731924, threshold for regime 1:0.05521783232688904
Task:1, layer:15, space shape:(720, 420)
Task:1, Layer:15, project_norm:0.13325523164599434, threshold for regime 1:0.06893135607242584
Task:1, layer:16, space shape:(1440, 848)
Task:1, Layer:16, project_norm:0.21079210843009338, threshold for regime 1:0.10978540778160095
Task:1, layer:17, space shape:(80, 62)
Task:1, Layer:17, project_norm:0.10949537952779016, threshold for regime 1:0.056015800684690475
Task:1, layer:18, space shape:(1440, 940)
Task:1, Layer:18, project_norm:0.220079389580862, threshold for regime 1:0.11460497230291367
Task:1, layer:19, space shape:(1440, 910)
Task:1, Layer:19, project_norm:0.33406716347850784, threshold for regime 1:0.1734338253736496
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Layer:0, selected task ID:[1]
Layer:1, selected task ID:[1]
Layer:2, selected task ID:[1]
Layer:3, selected task ID:[1]
Layer:4, selected task ID:[1]
Layer:5, selected task ID:[1]
Layer:6, selected task ID:[1]
Layer:7, selected task ID:[1]
Layer:8, selected task ID:[1]
Layer:9, selected task ID:[1]
Layer:10, selected task ID:[1]
Layer:11, selected task ID:[1]
Layer:12, selected task ID:[1]
Layer:13, selected task ID:[1]
Layer:14, selected task ID:[1]
Layer:15, selected task ID:[1]
Layer:16, selected task ID:[1]
Layer:17, selected task ID:[1]
Layer:18, selected task ID:[1]
Layer:19, selected task ID:[1]
space1 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.278, acc= 91.9% | time=364837.6ms |
 Valid: loss=0.331, acc= 91.0% |
Epoch   2 | Train: loss=0.209, acc= 94.4% | time=388692.1ms |
 Valid: loss=0.283, acc= 92.2% |
Epoch   3 | Train: loss=0.168, acc= 95.8% | time=332714.0ms |
 Valid: loss=0.252, acc= 93.2% |
Epoch   4 | Train: loss=0.143, acc= 96.6% | time=434117.4ms |
 Valid: loss=0.247, acc= 93.3% |
Epoch   5 | Train: loss=0.122, acc= 97.2% | time=329110.8ms |
 Valid: loss=0.245, acc= 92.9% |
Epoch   6 | Train: loss=0.100, acc= 98.0% | time=392761.9ms |
 Valid: loss=0.235, acc= 93.6% |
Epoch   7 | Train: loss=0.086, acc= 98.3% | time=351464.4ms |
 Valid: loss=0.239, acc= 93.5% |
Epoch   8 | Train: loss=0.068, acc= 98.8% | time=333737.2ms |
 Valid: loss=0.231, acc= 93.6% |
Epoch   9 | Train: loss=0.052, acc= 99.1% | time=403570.8ms |
 Valid: loss=0.234, acc= 93.8% |
Epoch  10 | Train: loss=0.037, acc= 99.4% | time=317315.1ms |
 Valid: loss=0.232, acc= 93.7% |
Epoch  11 | Train: loss=0.037, acc= 99.4% | time=402052.0ms |
 Valid: loss=0.240, acc= 93.5% |
Epoch  12 | Train: loss=0.029, acc= 99.7% | time=335625.8ms |
 Valid: loss=0.252, acc= 93.1% |
Epoch  13 | Train: loss=0.023, acc= 99.7% | time=356874.4ms |
 Valid: loss=0.248, acc= 93.8% |
 lr=3.3e-02
Epoch  14 | Train: loss=0.011, acc= 99.9% | time=368244.9ms |
 Valid: loss=0.237, acc= 94.1% |
Epoch  15 | Train: loss=0.009, acc= 99.9% | time=293374.8ms |
 Valid: loss=0.240, acc= 94.2% |
Epoch  16 | Train: loss=0.008, acc= 99.9% | time=344824.3ms |
 Valid: loss=0.242, acc= 94.0% |
Epoch  17 | Train: loss=0.007, acc=100.0% | time=327731.6ms |
 Valid: loss=0.244, acc= 93.9% |
Epoch  18 | Train: loss=0.007, acc=100.0% | time=304340.3ms |
 Valid: loss=0.245, acc= 94.0% |
 lr=1.1e-02
Epoch  19 | Train: loss=0.006, acc=100.0% | time=374651.6ms |
 Valid: loss=0.244, acc= 93.8% |
Epoch  20 | Train: loss=0.006, acc=100.0% | time=310713.4ms |
 Valid: loss=0.247, acc= 93.9% |
Epoch  21 | Train: loss=0.006, acc=100.0% | time=334190.1ms |
 Valid: loss=0.248, acc= 94.0% |
Epoch  22 | Train: loss=0.005, acc=100.0% | time=329090.0ms |
 Valid: loss=0.248, acc= 94.1% |
Epoch  23 | Train: loss=0.005, acc=100.0% | time=281003.9ms |
 Valid: loss=0.244, acc= 94.2% |
 lr=3.7e-03
Epoch  24 | Train: loss=0.005, acc=100.0% | time=286790.3ms |
 Valid: loss=0.245, acc= 94.0% |
Epoch  25 | Train: loss=0.005, acc=100.0% | time=314770.3ms |
 Valid: loss=0.246, acc= 93.9% |
Epoch  26 | Train: loss=0.005, acc=100.0% | time=278466.1ms |
 Valid: loss=0.248, acc= 94.0% |
Epoch  27 | Train: loss=0.005, acc=100.0% | time=270046.2ms |
 Valid: loss=0.248, acc= 94.0% |
Epoch  28 | Train: loss=0.005, acc=100.0% | time=307502.5ms |
 Valid: loss=0.246, acc= 94.1% |
 lr=1.2e-03
Epoch  29 | Train: loss=0.005, acc=100.0% | time=276237.3ms |
 Valid: loss=0.246, acc= 94.0% |
Epoch  30 | Train: loss=0.005, acc=100.0% | time=279912.3ms |
 Valid: loss=0.250, acc= 94.2% |
Epoch  31 | Train: loss=0.005, acc=100.0% | time=301271.4ms |
 Valid: loss=0.249, acc= 93.9% |
Epoch  32 | Train: loss=0.005, acc=100.0% | time=276303.5ms |
 Valid: loss=0.248, acc= 94.0% |
Epoch  33 | Train: loss=0.005, acc=100.0% | time=258111.4ms |
 Valid: loss=0.249, acc= 94.1% |
 lr=4.1e-04
Test: loss=0.205 , acc= 94.3%
Test: loss=0.205 , acc= 94.2%
Test: loss=0.206 , acc= 94.2%
Test: loss=0.205 , acc= 94.2%
Test: loss=0.205 , acc= 94.3%
Test: loss=0.205 , acc= 94.2%
Test: loss=0.205 , acc= 94.2%
Test: loss=0.205 , acc= 94.3%
Test: loss=0.205 , acc= 94.2%
Test: loss=0.205 , acc= 94.1%
Average acc= 94.2%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 5)
threshold for selecting:6866.514655876177
total ranking r = 4
the number of space for current task:4
the new increased space:0, the threshold for new space:5
Ui shape:(27, 4)
activation shape:(180, 10240)
space shape:(180, 45)
threshold for selecting:38992.74826310464
total ranking r = 34
the number of space for current task:34
the new increased space:1, the threshold for new space:45
Ui shape:(180, 34)
activation shape:(180, 10240)
space shape:(180, 84)
threshold for selecting:21661.10241741761
total ranking r = 75
the number of space for current task:75
the new increased space:4, the threshold for new space:84
Ui shape:(180, 75)
activation shape:(180, 10240)
space shape:(180, 67)
threshold for selecting:108822.28667572748
total ranking r = 62
the number of space for current task:62
the new increased space:6, the threshold for new space:67
Ui shape:(180, 62)
activation shape:(180, 10240)
space shape:(180, 93)
threshold for selecting:24666.669809606134
total ranking r = 89
the number of space for current task:89
the new increased space:5, the threshold for new space:93
Ui shape:(180, 89)
activation shape:(180, 2560)
space shape:(180, 76)
threshold for selecting:40256.84323976183
total ranking r = 70
the number of space for current task:70
the new increased space:6, the threshold for new space:76
Ui shape:(180, 70)
activation shape:(360, 2560)
space shape:(360, 230)
threshold for selecting:15813.742175426292
total ranking r = 224
the number of space for current task:224
the new increased space:20, the threshold for new space:230
Ui shape:(360, 224)
activation shape:(20, 2560)
space shape:(20, 14)
threshold for selecting:5611.854913756919
total ranking r = 15
the number of space for current task:15
the new increased space:1, the threshold for new space:14
Ui shape:(20, 15)
activation shape:(360, 2560)
space shape:(360, 235)
threshold for selecting:47738.1430960192
total ranking r = 222
the number of space for current task:222
the new increased space:18, the threshold for new space:235
Ui shape:(360, 222)
activation shape:(360, 12800)
space shape:(360, 240)
threshold for selecting:57885.57196604593
total ranking r = 216
the number of space for current task:216
the new increased space:5, the threshold for new space:240
Ui shape:(360, 216)
activation shape:(360, 3200)
space shape:(360, 229)
threshold for selecting:82175.6719161123
total ranking r = 212
the number of space for current task:212
the new increased space:15, the threshold for new space:229
Ui shape:(360, 212)
activation shape:(720, 3200)
space shape:(720, 501)
threshold for selecting:41842.1591570337
total ranking r = 512
the number of space for current task:512
the new increased space:56, the threshold for new space:501
Ui shape:(720, 512)
activation shape:(40, 3200)
space shape:(40, 30)
threshold for selecting:11251.697204883138
total ranking r = 30
the number of space for current task:30
the new increased space:1, the threshold for new space:30
Ui shape:(40, 30)
activation shape:(720, 6400)
space shape:(720, 522)
threshold for selecting:218033.92493408138
total ranking r = 520
the number of space for current task:520
the new increased space:47, the threshold for new space:522
Ui shape:(720, 520)
activation shape:(720, 6400)
space shape:(720, 535)
threshold for selecting:71821.25837601366
total ranking r = 540
the number of space for current task:540
the new increased space:45, the threshold for new space:535
Ui shape:(720, 540)
activation shape:(720, 1600)
space shape:(720, 435)
threshold for selecting:138279.34753434092
total ranking r = 490
the number of space for current task:490
the new increased space:81, the threshold for new space:435
Ui shape:(720, 490)
activation shape:(1440, 1600)
space shape:(1440, 847)
threshold for selecting:73651.32375613408
total ranking r = 1029
the number of space for current task:1029
the new increased space:192, the threshold for new space:847
Ui shape:(1440, 1029)
activation shape:(80, 1600)
space shape:(80, 63)
threshold for selecting:10695.667505731659
total ranking r = 64
the number of space for current task:64
the new increased space:3, the threshold for new space:63
Ui shape:(80, 64)
activation shape:(1440, 1600)
space shape:(1440, 939)
threshold for selecting:78338.38513309656
total ranking r = 1120
the number of space for current task:1120
the new increased space:182, the threshold for new space:939
Ui shape:(1440, 1120)
activation shape:(1440, 1600)
space shape:(1440, 909)
threshold for selecting:63723.300520108605
total ranking r = 1086
the number of space for current task:1086
the new increased space:181, the threshold for new space:909
Ui shape:(1440, 1086)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.641 , acc= 82.0%
Test: loss=0.635 , acc= 81.7%
Test: loss=0.637 , acc= 81.8%
Test: loss=0.639 , acc= 81.6%
Test: loss=0.638 , acc= 81.7%
current testing task:mnist
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.017 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.017 , acc= 99.4%
current testing task:svhn
Test: loss=0.206 , acc= 94.2%
Test: loss=0.205 , acc= 94.3%
Test: loss=0.205 , acc= 94.2%
Test: loss=0.205 , acc= 94.2%
Test: loss=0.205 , acc= 94.2%
Accuracies =
 82.2%   0.0%   0.0%   0.0%   0.0%
 82.0%  99.5%   0.0%   0.0%   0.0%
 81.7%  99.5%  94.2%   0.0%   0.0%
****************************************************************************************************
Task  3 (fashion-mnist)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 5)
Task:0, Layer:0, project_norm:0.04046725688679583, threshold for regime 1:0.021839633584022522
Task:0, layer:1, space shape:(180, 37)
Task:0, Layer:1, project_norm:0.05558639588368238, threshold for regime 1:0.028979744762182236
Task:0, layer:2, space shape:(180, 77)
Task:0, Layer:2, project_norm:0.061209464286865356, threshold for regime 1:0.03133856877684593
Task:0, layer:3, space shape:(180, 59)
Task:0, Layer:3, project_norm:0.05850206959548295, threshold for regime 1:0.030226578935980797
Task:0, layer:4, space shape:(180, 85)
Task:0, Layer:4, project_norm:0.05565162736901307, threshold for regime 1:0.028408441692590714
Task:0, layer:5, space shape:(180, 66)
Task:0, Layer:5, project_norm:0.06947694035329603, threshold for regime 1:0.035672783851623535
Task:0, layer:6, space shape:(360, 201)
Task:0, Layer:6, project_norm:0.1087193887080051, threshold for regime 1:0.05571403354406357
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.05504668807358687, threshold for regime 1:0.028757842257618904
Task:0, layer:8, space shape:(360, 203)
Task:0, Layer:8, project_norm:0.10309394607281314, threshold for regime 1:0.052523624151945114
Task:0, layer:9, space shape:(360, 221)
Task:0, Layer:9, project_norm:0.10203942028280263, threshold for regime 1:0.05165880173444748
Task:0, layer:10, space shape:(360, 201)
Task:0, Layer:10, project_norm:0.13130640988819367, threshold for regime 1:0.06723611801862717
Task:0, layer:11, space shape:(720, 435)
Task:0, Layer:11, project_norm:0.20713813354599372, threshold for regime 1:0.10662470757961273
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.1006170816859638, threshold for regime 1:0.051767535507678986
Task:0, layer:13, space shape:(720, 466)
Task:0, Layer:13, project_norm:0.19577672440873184, threshold for regime 1:0.09977153688669205
Task:0, layer:14, space shape:(720, 479)
Task:0, Layer:14, project_norm:0.21981924169345846, threshold for regime 1:0.11265473812818527
Task:0, layer:15, space shape:(720, 351)
Task:0, Layer:15, project_norm:0.2997495212294582, threshold for regime 1:0.15720801055431366
Task:0, layer:16, space shape:(1440, 628)
Task:0, Layer:16, project_norm:0.44511335799762086, threshold for regime 1:0.242460235953331
Task:0, layer:17, space shape:(80, 59)
Task:0, Layer:17, project_norm:0.21484054480267414, threshold for regime 1:0.11068524420261383
Task:0, layer:18, space shape:(1440, 693)
Task:0, Layer:18, project_norm:0.46728156196535436, threshold for regime 1:0.25693392753601074
Task:0, layer:19, space shape:(1440, 663)
Task:0, Layer:19, project_norm:0.6815693099337184, threshold for regime 1:0.3744054436683655
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:1, layer:0, space shape:(27, 5)
Task:1, Layer:0, project_norm:0.04284478755991261, threshold for regime 1:0.021839633584022522
Task:1, layer:1, space shape:(180, 44)
Task:1, Layer:1, project_norm:0.05629263691497984, threshold for regime 1:0.028979744762182236
Task:1, layer:2, space shape:(180, 82)
Task:1, Layer:2, project_norm:0.06165926811019587, threshold for regime 1:0.03133856877684593
Task:1, layer:3, space shape:(180, 67)
Task:1, Layer:3, project_norm:0.05917167553412508, threshold for regime 1:0.030226578935980797
Task:1, layer:4, space shape:(180, 92)
Task:1, Layer:4, project_norm:0.056010878571244836, threshold for regime 1:0.028408441692590714
Task:1, layer:5, space shape:(180, 73)
Task:1, Layer:5, project_norm:0.06997660778971813, threshold for regime 1:0.035672783851623535
Task:1, layer:6, space shape:(360, 220)
Task:1, Layer:6, project_norm:0.10994713965892926, threshold for regime 1:0.05571403354406357
Task:1, layer:7, space shape:(20, 15)
Task:1, Layer:7, project_norm:0.056445263561884645, threshold for regime 1:0.028757842257618904
Task:1, layer:8, space shape:(360, 224)
Task:1, Layer:8, project_norm:0.10398174202601035, threshold for regime 1:0.052523624151945114
Task:1, layer:9, space shape:(360, 223)
Task:1, Layer:9, project_norm:0.10220765342075022, threshold for regime 1:0.05165880173444748
Task:1, layer:10, space shape:(360, 216)
Task:1, Layer:10, project_norm:0.13230197946488534, threshold for regime 1:0.06723611801862717
Task:1, layer:11, space shape:(720, 483)
Task:1, Layer:11, project_norm:0.2102795754633993, threshold for regime 1:0.10662470757961273
Task:1, layer:12, space shape:(40, 31)
Task:1, Layer:12, project_norm:0.1015380577690479, threshold for regime 1:0.051767535507678986
Task:1, layer:13, space shape:(720, 492)
Task:1, Layer:13, project_norm:0.19714403842825493, threshold for regime 1:0.09977153688669205
Task:1, layer:14, space shape:(720, 510)
Task:1, Layer:14, project_norm:0.22198603041922144, threshold for regime 1:0.11265473812818527
Task:1, layer:15, space shape:(720, 420)
Task:1, Layer:15, project_norm:0.3085108416516219, threshold for regime 1:0.15720801055431366
Task:1, layer:16, space shape:(1440, 848)
Task:1, Layer:16, project_norm:0.47578346933073257, threshold for regime 1:0.242460235953331
Task:1, layer:17, space shape:(80, 62)
Task:1, Layer:17, project_norm:0.2170260671075868, threshold for regime 1:0.11068524420261383
Task:1, layer:18, space shape:(1440, 940)
Task:1, Layer:18, project_norm:0.5042341525934805, threshold for regime 1:0.25693392753601074
Task:1, layer:19, space shape:(1440, 910)
Task:1, Layer:19, project_norm:0.7354010615840568, threshold for regime 1:0.3744054436683655
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:2, layer:0, space shape:(27, 4)
Task:2, Layer:0, project_norm:0.03992740915721593, threshold for regime 1:0.021839633584022522
Task:2, layer:1, space shape:(180, 34)
Task:2, Layer:1, project_norm:0.054936655149434827, threshold for regime 1:0.028979744762182236
Task:2, layer:2, space shape:(180, 75)
Task:2, Layer:2, project_norm:0.06110106232460912, threshold for regime 1:0.03133856877684593
Task:2, layer:3, space shape:(180, 62)
Task:2, Layer:3, project_norm:0.05864416551343668, threshold for regime 1:0.030226578935980797
Task:2, layer:4, space shape:(180, 89)
Task:2, Layer:4, project_norm:0.05578098971975604, threshold for regime 1:0.028408441692590714
Task:2, layer:5, space shape:(180, 70)
Task:2, Layer:5, project_norm:0.06956583331080173, threshold for regime 1:0.035672783851623535
Task:2, layer:6, space shape:(360, 224)
Task:2, Layer:6, project_norm:0.10942834462096152, threshold for regime 1:0.05571403354406357
Task:2, layer:7, space shape:(20, 15)
Task:2, Layer:7, project_norm:0.055630448659592616, threshold for regime 1:0.028757842257618904
Task:2, layer:8, space shape:(360, 222)
Task:2, Layer:8, project_norm:0.10374174966023295, threshold for regime 1:0.052523624151945114
Task:2, layer:9, space shape:(360, 216)
Task:2, Layer:9, project_norm:0.1019282535615642, threshold for regime 1:0.05165880173444748
Task:2, layer:10, space shape:(360, 212)
Task:2, Layer:10, project_norm:0.13159582232413114, threshold for regime 1:0.06723611801862717
Task:2, layer:11, space shape:(720, 512)
Task:2, Layer:11, project_norm:0.20960879876205127, threshold for regime 1:0.10662470757961273
Task:2, layer:12, space shape:(40, 30)
Task:2, Layer:12, project_norm:0.10075676436859933, threshold for regime 1:0.051767535507678986
Task:2, layer:13, space shape:(720, 520)
Task:2, Layer:13, project_norm:0.19679801585074025, threshold for regime 1:0.09977153688669205
Task:2, layer:14, space shape:(720, 540)
Task:2, Layer:14, project_norm:0.22174045054126568, threshold for regime 1:0.11265473812818527
Task:2, layer:15, space shape:(720, 490)
Task:2, Layer:15, project_norm:0.30939215328587566, threshold for regime 1:0.15720801055431366
Task:2, layer:16, space shape:(1440, 1029)
Task:2, Layer:16, project_norm:0.4784177934186809, threshold for regime 1:0.242460235953331
Task:2, layer:17, space shape:(80, 64)
Task:2, Layer:17, project_norm:0.21655812621358306, threshold for regime 1:0.11068524420261383
Task:2, layer:18, space shape:(1440, 1120)
Task:2, Layer:18, project_norm:0.5079633379631916, threshold for regime 1:0.25693392753601074
Task:2, layer:19, space shape:(1440, 1086)
Task:2, Layer:19, project_norm:0.7404032635961294, threshold for regime 1:0.3744054436683655
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Layer:0, selected task ID:[0 1]
Layer:1, selected task ID:[0 1]
Layer:2, selected task ID:[0 1]
Layer:3, selected task ID:[2 1]
Layer:4, selected task ID:[2 1]
Layer:5, selected task ID:[2 1]
Layer:6, selected task ID:[2 1]
Layer:7, selected task ID:[2 1]
Layer:8, selected task ID:[2 1]
Layer:9, selected task ID:[0 1]
Layer:10, selected task ID:[2 1]
Layer:11, selected task ID:[2 1]
Layer:12, selected task ID:[2 1]
Layer:13, selected task ID:[2 1]
Layer:14, selected task ID:[2 1]
Layer:15, selected task ID:[1 2]
Layer:16, selected task ID:[1 2]
Layer:17, selected task ID:[2 1]
Layer:18, selected task ID:[1 2]
Layer:19, selected task ID:[1 2]
space1 is not None!
space2 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.021, acc= 99.7% | time=336825.2ms |
 Valid: loss=0.042, acc= 99.1% |
Epoch   2 | Train: loss=0.011, acc= 99.8% | time=339268.5ms |
 Valid: loss=0.032, acc= 99.1% |
Epoch   3 | Train: loss=0.006, acc= 99.9% | time=340932.8ms |
 Valid: loss=0.023, acc= 99.3% |
Epoch   4 | Train: loss=0.005, acc= 99.9% | time=321501.1ms |
 Valid: loss=0.023, acc= 99.2% |
Epoch   5 | Train: loss=0.003, acc=100.0% | time=314470.3ms |
 Valid: loss=0.022, acc= 99.4% |
Epoch   6 | Train: loss=0.002, acc=100.0% | time=296050.0ms |
 Valid: loss=0.024, acc= 99.3% |
Epoch   7 | Train: loss=0.002, acc=100.0% | time=275994.6ms |
 Valid: loss=0.024, acc= 99.4% |
Epoch   8 | Train: loss=0.002, acc=100.0% | time=282974.8ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch   9 | Train: loss=0.001, acc=100.0% | time=292432.1ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  10 | Train: loss=0.002, acc=100.0% | time=304478.1ms |
 Valid: loss=0.022, acc= 99.4% |
Epoch  11 | Train: loss=0.001, acc=100.0% | time=303499.8ms |
 Valid: loss=0.021, acc= 99.5% |
Epoch  12 | Train: loss=0.001, acc=100.0% | time=284116.4ms |
 Valid: loss=0.022, acc= 99.2% |
Epoch  13 | Train: loss=0.000, acc=100.0% | time=292278.8ms |
 Valid: loss=0.022, acc= 99.3% |
 lr=3.3e-02
Epoch  14 | Train: loss=0.000, acc=100.0% | time=283154.5ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  15 | Train: loss=0.000, acc=100.0% | time=295804.2ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  16 | Train: loss=0.000, acc=100.0% | time=281571.8ms |
 Valid: loss=0.023, acc= 99.4% |
Epoch  17 | Train: loss=0.000, acc=100.0% | time=262272.7ms |
 Valid: loss=0.024, acc= 99.3% |
Epoch  18 | Train: loss=0.000, acc=100.0% | time=274771.5ms |
 Valid: loss=0.023, acc= 99.3% |
 lr=1.1e-02
Epoch  19 | Train: loss=0.000, acc=100.0% | time=294248.2ms |
 Valid: loss=0.023, acc= 99.3% |
Epoch  20 | Train: loss=0.000, acc=100.0% | time=299990.1ms |
 Valid: loss=0.025, acc= 99.3% |
Epoch  21 | Train: loss=0.000, acc=100.0% | time=281017.1ms |
 Valid: loss=0.023, acc= 99.3% |
Epoch  22 | Train: loss=0.000, acc=100.0% | time=265764.9ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  23 | Train: loss=0.000, acc=100.0% | time=277494.0ms |
 Valid: loss=0.021, acc= 99.4% |
 lr=3.7e-03
Epoch  24 | Train: loss=0.000, acc=100.0% | time=288058.0ms |
 Valid: loss=0.022, acc= 99.4% |
Epoch  25 | Train: loss=0.000, acc=100.0% | time=299725.5ms |
 Valid: loss=0.023, acc= 99.3% |
Epoch  26 | Train: loss=0.000, acc=100.0% | time=288062.1ms |
 Valid: loss=0.022, acc= 99.4% |
Epoch  27 | Train: loss=0.000, acc=100.0% | time=293579.4ms |
 Valid: loss=0.023, acc= 99.4% |
Epoch  28 | Train: loss=0.000, acc=100.0% | time=316739.6ms |
 Valid: loss=0.022, acc= 99.4% |
 lr=1.2e-03
Epoch  29 | Train: loss=0.000, acc=100.0% | time=291551.8ms |
 Valid: loss=0.023, acc= 99.4% |
Epoch  30 | Train: loss=0.000, acc=100.0% | time=273625.1ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  31 | Train: loss=0.000, acc=100.0% | time=309036.9ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  32 | Train: loss=0.000, acc=100.0% | time=288219.8ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  33 | Train: loss=0.000, acc=100.0% | time=304507.1ms |
 Valid: loss=0.020, acc= 99.4% |
 lr=4.1e-04
Test: loss=0.015 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Average acc= 99.5%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 5)
threshold for selecting:10478.038249082207
total ranking r = 5
the number of space for current task:5
the new increased space:1, the threshold for new space:5
Ui shape:(27, 5)
activation shape:(180, 10240)
space shape:(180, 46)
threshold for selecting:42514.95114102361
total ranking r = 43
the number of space for current task:43
the new increased space:2, the threshold for new space:46
Ui shape:(180, 43)
activation shape:(180, 10240)
space shape:(180, 88)
threshold for selecting:19497.850697885387
total ranking r = 82
the number of space for current task:82
the new increased space:2, the threshold for new space:88
Ui shape:(180, 82)
activation shape:(180, 10240)
space shape:(180, 73)
threshold for selecting:78146.6704262107
total ranking r = 65
the number of space for current task:65
the new increased space:0, the threshold for new space:73
Ui shape:(180, 65)
activation shape:(180, 10240)
space shape:(180, 98)
threshold for selecting:17176.348305143678
total ranking r = 92
the number of space for current task:92
the new increased space:1, the threshold for new space:98
Ui shape:(180, 92)
activation shape:(180, 2560)
space shape:(180, 82)
threshold for selecting:29789.535946963137
total ranking r = 72
the number of space for current task:72
the new increased space:2, the threshold for new space:82
Ui shape:(180, 72)
activation shape:(360, 2560)
space shape:(360, 250)
threshold for selecting:9727.697055986824
total ranking r = 226
the number of space for current task:226
the new increased space:5, the threshold for new space:250
Ui shape:(360, 226)
activation shape:(20, 2560)
space shape:(20, 15)
threshold for selecting:4224.089207073356
total ranking r = 14
the number of space for current task:14
the new increased space:0, the threshold for new space:15
Ui shape:(20, 14)
activation shape:(360, 2560)
space shape:(360, 253)
threshold for selecting:32174.333310176702
total ranking r = 228
the number of space for current task:228
the new increased space:4, the threshold for new space:253
Ui shape:(360, 228)
activation shape:(360, 12800)
space shape:(360, 245)
threshold for selecting:51875.79674953497
total ranking r = 224
the number of space for current task:224
the new increased space:3, the threshold for new space:245
Ui shape:(360, 224)
activation shape:(360, 3200)
space shape:(360, 244)
threshold for selecting:60765.17461941468
total ranking r = 220
the number of space for current task:220
the new increased space:5, the threshold for new space:244
Ui shape:(360, 220)
activation shape:(720, 3200)
space shape:(720, 557)
threshold for selecting:22970.873830305056
total ranking r = 495
the number of space for current task:495
the new increased space:7, the threshold for new space:557
Ui shape:(720, 495)
activation shape:(40, 3200)
space shape:(40, 31)
threshold for selecting:9213.082804195607
total ranking r = 31
the number of space for current task:31
the new increased space:0, the threshold for new space:31
Ui shape:(40, 31)
activation shape:(720, 6400)
space shape:(720, 569)
threshold for selecting:135190.48308796645
total ranking r = 500
the number of space for current task:500
the new increased space:5, the threshold for new space:569
Ui shape:(720, 500)
activation shape:(720, 6400)
space shape:(720, 580)
threshold for selecting:41380.22900476946
total ranking r = 517
the number of space for current task:517
the new increased space:3, the threshold for new space:580
Ui shape:(720, 517)
activation shape:(720, 1600)
space shape:(720, 516)
threshold for selecting:67544.82230280266
total ranking r = 453
the number of space for current task:453
the new increased space:23, the threshold for new space:516
Ui shape:(720, 453)
activation shape:(1440, 1600)
space shape:(1440, 1039)
threshold for selecting:29555.656269527826
total ranking r = 980
the number of space for current task:980
the new increased space:100, the threshold for new space:1039
Ui shape:(1440, 980)
activation shape:(80, 1600)
space shape:(80, 66)
threshold for selecting:7879.001769690189
total ranking r = 62
the number of space for current task:62
the new increased space:0, the threshold for new space:66
Ui shape:(80, 62)
activation shape:(1440, 1600)
space shape:(1440, 1121)
threshold for selecting:33869.57996167123
total ranking r = 1072
the number of space for current task:1072
the new increased space:91, the threshold for new space:1121
Ui shape:(1440, 1072)
activation shape:(1440, 1600)
space shape:(1440, 1090)
threshold for selecting:23887.080562759013
total ranking r = 1029
the number of space for current task:1029
the new increased space:91, the threshold for new space:1090
Ui shape:(1440, 1029)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.640 , acc= 81.6%
Test: loss=0.636 , acc= 81.6%
Test: loss=0.641 , acc= 81.7%
Test: loss=0.639 , acc= 81.8%
Test: loss=0.638 , acc= 81.7%
current testing task:mnist
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
current testing task:svhn
Test: loss=0.206 , acc= 94.2%
Test: loss=0.205 , acc= 94.2%
Test: loss=0.206 , acc= 94.2%
Test: loss=0.205 , acc= 94.2%
Test: loss=0.205 , acc= 94.1%
current testing task:fashion-mnist
Test: loss=0.014 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Accuracies =
 82.2%   0.0%   0.0%   0.0%   0.0%
 82.0%  99.5%   0.0%   0.0%   0.0%
 81.7%  99.5%  94.2%   0.0%   0.0%
 81.7%  99.5%  94.2%  99.5%   0.0%
****************************************************************************************************
Task  4 (notmnist)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 5)
Task:0, Layer:0, project_norm:0.22278576500509067, threshold for regime 1:0.11173839867115021
Task:0, layer:1, space shape:(180, 37)
Task:0, Layer:1, project_norm:0.08100861938118482, threshold for regime 1:0.04148193076252937
Task:0, layer:2, space shape:(180, 77)
Task:0, Layer:2, project_norm:0.09151892299207509, threshold for regime 1:0.04654289036989212
Task:0, layer:3, space shape:(180, 59)
Task:0, Layer:3, project_norm:0.07445243320886985, threshold for regime 1:0.03809509798884392
Task:0, layer:4, space shape:(180, 85)
Task:0, Layer:4, project_norm:0.06905045144024456, threshold for regime 1:0.03518623113632202
Task:0, layer:5, space shape:(180, 66)
Task:0, Layer:5, project_norm:0.07310864917192172, threshold for regime 1:0.03744669258594513
Task:0, layer:6, space shape:(360, 201)
Task:0, Layer:6, project_norm:0.10786384268691292, threshold for regime 1:0.05501756817102432
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.06086981079437935, threshold for regime 1:0.03214811161160469
Task:0, layer:8, space shape:(360, 203)
Task:0, Layer:8, project_norm:0.09813900510707696, threshold for regime 1:0.049871865659952164
Task:0, layer:9, space shape:(360, 221)
Task:0, Layer:9, project_norm:0.10570475197086851, threshold for regime 1:0.05336147919297218
Task:0, layer:10, space shape:(360, 201)
Task:0, Layer:10, project_norm:0.1389856358774009, threshold for regime 1:0.07057381421327591
Task:0, layer:11, space shape:(720, 435)
Task:0, Layer:11, project_norm:0.1983953562474606, threshold for regime 1:0.10156187415122986
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.09638661866084432, threshold for regime 1:0.049559738487005234
Task:0, layer:13, space shape:(720, 466)
Task:0, Layer:13, project_norm:0.18747000373084824, threshold for regime 1:0.09540245682001114
Task:0, layer:14, space shape:(720, 479)
Task:0, Layer:14, project_norm:0.2168252608557466, threshold for regime 1:0.11058834940195084
Task:0, layer:15, space shape:(720, 351)
Task:0, Layer:15, project_norm:0.2832715860485431, threshold for regime 1:0.14741985499858856
Task:0, layer:16, space shape:(1440, 628)
Task:0, Layer:16, project_norm:0.42136026099209684, threshold for regime 1:0.2270125448703766
Task:0, layer:17, space shape:(80, 59)
Task:0, Layer:17, project_norm:0.20251705646529342, threshold for regime 1:0.10424170643091202
Task:0, layer:18, space shape:(1440, 693)
Task:0, Layer:18, project_norm:0.4178253805848375, threshold for regime 1:0.2281588464975357
Task:0, layer:19, space shape:(1440, 663)
Task:0, Layer:19, project_norm:0.6402273654226392, threshold for regime 1:0.3483067750930786
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:1, layer:0, space shape:(27, 5)
Task:1, Layer:0, project_norm:0.2228915633337268, threshold for regime 1:0.11173839867115021
Task:1, layer:1, space shape:(180, 44)
Task:1, Layer:1, project_norm:0.08127980945702269, threshold for regime 1:0.04148193076252937
Task:1, layer:2, space shape:(180, 82)
Task:1, Layer:2, project_norm:0.09169754606323338, threshold for regime 1:0.04654289036989212
Task:1, layer:3, space shape:(180, 67)
Task:1, Layer:3, project_norm:0.07489392550365012, threshold for regime 1:0.03809509798884392
Task:1, layer:4, space shape:(180, 92)
Task:1, Layer:4, project_norm:0.06937708633984203, threshold for regime 1:0.03518623113632202
Task:1, layer:5, space shape:(180, 73)
Task:1, Layer:5, project_norm:0.07336369155651107, threshold for regime 1:0.03744669258594513
Task:1, layer:6, space shape:(360, 220)
Task:1, Layer:6, project_norm:0.10839212572790309, threshold for regime 1:0.05501756817102432
Task:1, layer:7, space shape:(20, 15)
Task:1, Layer:7, project_norm:0.0618644851442995, threshold for regime 1:0.03214811161160469
Task:1, layer:8, space shape:(360, 224)
Task:1, Layer:8, project_norm:0.0985469638096324, threshold for regime 1:0.049871865659952164
Task:1, layer:9, space shape:(360, 223)
Task:1, Layer:9, project_norm:0.10565957147646472, threshold for regime 1:0.05336147919297218
Task:1, layer:10, space shape:(360, 216)
Task:1, Layer:10, project_norm:0.13924514335792598, threshold for regime 1:0.07057381421327591
Task:1, layer:11, space shape:(720, 483)
Task:1, Layer:11, project_norm:0.19946463135378562, threshold for regime 1:0.10156187415122986
Task:1, layer:12, space shape:(40, 31)
Task:1, Layer:12, project_norm:0.09696703450897241, threshold for regime 1:0.049559738487005234
Task:1, layer:13, space shape:(720, 492)
Task:1, Layer:13, project_norm:0.18788693680889978, threshold for regime 1:0.09540245682001114
Task:1, layer:14, space shape:(720, 510)
Task:1, Layer:14, project_norm:0.2173705569165082, threshold for regime 1:0.11058834940195084
Task:1, layer:15, space shape:(720, 420)
Task:1, Layer:15, project_norm:0.28617591251851116, threshold for regime 1:0.14741985499858856
Task:1, layer:16, space shape:(1440, 848)
Task:1, Layer:16, project_norm:0.4331232285990831, threshold for regime 1:0.2270125448703766
Task:1, layer:17, space shape:(80, 62)
Task:1, Layer:17, project_norm:0.20341107040190665, threshold for regime 1:0.10424170643091202
Task:1, layer:18, space shape:(1440, 940)
Task:1, Layer:18, project_norm:0.4349560509223587, threshold for regime 1:0.2281588464975357
Task:1, layer:19, space shape:(1440, 910)
Task:1, Layer:19, project_norm:0.6641397656847942, threshold for regime 1:0.3483067750930786
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:2, layer:0, space shape:(27, 4)
Task:2, Layer:0, project_norm:0.2215991204001884, threshold for regime 1:0.11173839867115021
Task:2, layer:1, space shape:(180, 34)
Task:2, Layer:1, project_norm:0.08074379055955862, threshold for regime 1:0.04148193076252937
Task:2, layer:2, space shape:(180, 75)
Task:2, Layer:2, project_norm:0.0915198474551364, threshold for regime 1:0.04654289036989212
Task:2, layer:3, space shape:(180, 62)
Task:2, Layer:3, project_norm:0.07454714382251366, threshold for regime 1:0.03809509798884392
Task:2, layer:4, space shape:(180, 89)
Task:2, Layer:4, project_norm:0.06926433663960754, threshold for regime 1:0.03518623113632202
Task:2, layer:5, space shape:(180, 70)
Task:2, Layer:5, project_norm:0.07329306215276926, threshold for regime 1:0.03744669258594513
Task:2, layer:6, space shape:(360, 224)
Task:2, Layer:6, project_norm:0.10839178846618717, threshold for regime 1:0.05501756817102432
Task:2, layer:7, space shape:(20, 15)
Task:2, Layer:7, project_norm:0.06199163218101268, threshold for regime 1:0.03214811161160469
Task:2, layer:8, space shape:(360, 222)
Task:2, Layer:8, project_norm:0.09859795898224624, threshold for regime 1:0.049871865659952164
Task:2, layer:9, space shape:(360, 216)
Task:2, Layer:9, project_norm:0.10563892003014921, threshold for regime 1:0.05336147919297218
Task:2, layer:10, space shape:(360, 212)
Task:2, Layer:10, project_norm:0.1392500743949002, threshold for regime 1:0.07057381421327591
Task:2, layer:11, space shape:(720, 512)
Task:2, Layer:11, project_norm:0.20014433866091155, threshold for regime 1:0.10156187415122986
Task:2, layer:12, space shape:(40, 30)
Task:2, Layer:12, project_norm:0.09681832567741525, threshold for regime 1:0.049559738487005234
Task:2, layer:13, space shape:(720, 520)
Task:2, Layer:13, project_norm:0.18850575518221263, threshold for regime 1:0.09540245682001114
Task:2, layer:14, space shape:(720, 540)
Task:2, Layer:14, project_norm:0.2182950256627498, threshold for regime 1:0.11058834940195084
Task:2, layer:15, space shape:(720, 490)
Task:2, Layer:15, project_norm:0.2891382830180098, threshold for regime 1:0.14741985499858856
Task:2, layer:16, space shape:(1440, 1029)
Task:2, Layer:16, project_norm:0.44132856998038067, threshold for regime 1:0.2270125448703766
Task:2, layer:17, space shape:(80, 64)
Task:2, Layer:17, project_norm:0.20427459372737927, threshold for regime 1:0.10424170643091202
Task:2, layer:18, space shape:(1440, 1120)
Task:2, Layer:18, project_norm:0.4444089944742936, threshold for regime 1:0.2281588464975357
Task:2, layer:19, space shape:(1440, 1086)
Task:2, Layer:19, project_norm:0.6783400979775309, threshold for regime 1:0.3483067750930786
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:3, layer:0, space shape:(27, 5)
Task:3, Layer:0, project_norm:0.2221034018313428, threshold for regime 1:0.11173839867115021
Task:3, layer:1, space shape:(180, 43)
Task:3, Layer:1, project_norm:0.08125062213080159, threshold for regime 1:0.04148193076252937
Task:3, layer:2, space shape:(180, 82)
Task:3, Layer:2, project_norm:0.09158060919619498, threshold for regime 1:0.04654289036989212
Task:3, layer:3, space shape:(180, 65)
Task:3, Layer:3, project_norm:0.0747531200021389, threshold for regime 1:0.03809509798884392
Task:3, layer:4, space shape:(180, 92)
Task:3, Layer:4, project_norm:0.06938021320391036, threshold for regime 1:0.03518623113632202
Task:3, layer:5, space shape:(180, 72)
Task:3, Layer:5, project_norm:0.073333659450183, threshold for regime 1:0.03744669258594513
Task:3, layer:6, space shape:(360, 226)
Task:3, Layer:6, project_norm:0.10853211768018689, threshold for regime 1:0.05501756817102432
Task:3, layer:7, space shape:(20, 14)
Task:3, Layer:7, project_norm:0.06145617025583121, threshold for regime 1:0.03214811161160469
Task:3, layer:8, space shape:(360, 228)
Task:3, Layer:8, project_norm:0.09864682006273347, threshold for regime 1:0.049871865659952164
Task:3, layer:9, space shape:(360, 224)
Task:3, Layer:9, project_norm:0.1056902792755027, threshold for regime 1:0.05336147919297218
Task:3, layer:10, space shape:(360, 220)
Task:3, Layer:10, project_norm:0.139285975302397, threshold for regime 1:0.07057381421327591
Task:3, layer:11, space shape:(720, 495)
Task:3, Layer:11, project_norm:0.19975261909391073, threshold for regime 1:0.10156187415122986
Task:3, layer:12, space shape:(40, 31)
Task:3, Layer:12, project_norm:0.09697607459106174, threshold for regime 1:0.049559738487005234
Task:3, layer:13, space shape:(720, 500)
Task:3, Layer:13, project_norm:0.18801459012117858, threshold for regime 1:0.09540245682001114
Task:3, layer:14, space shape:(720, 517)
Task:3, Layer:14, project_norm:0.2175637468213612, threshold for regime 1:0.11058834940195084
Task:3, layer:15, space shape:(720, 453)
Task:3, Layer:15, project_norm:0.2873588307820871, threshold for regime 1:0.14741985499858856
Task:3, layer:16, space shape:(1440, 980)
Task:3, Layer:16, project_norm:0.43849115971028035, threshold for regime 1:0.2270125448703766
Task:3, layer:17, space shape:(80, 62)
Task:3, Layer:17, project_norm:0.20335540403795438, threshold for regime 1:0.10424170643091202
Task:3, layer:18, space shape:(1440, 1072)
Task:3, Layer:18, project_norm:0.44132130020084065, threshold for regime 1:0.2281588464975357
Task:3, layer:19, space shape:(1440, 1029)
Task:3, Layer:19, project_norm:0.672168115050461, threshold for regime 1:0.3483067750930786
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Layer:0, selected task ID:[0 1]
Layer:1, selected task ID:[3 1]
Layer:2, selected task ID:[3 1]
Layer:3, selected task ID:[3 1]
Layer:4, selected task ID:[1 3]
Layer:5, selected task ID:[3 1]
Layer:6, selected task ID:[1 3]
Layer:7, selected task ID:[1 2]
Layer:8, selected task ID:[2 3]
Layer:9, selected task ID:[3 0]
Layer:10, selected task ID:[2 3]
Layer:11, selected task ID:[3 2]
Layer:12, selected task ID:[1 3]
Layer:13, selected task ID:[3 2]
Layer:14, selected task ID:[3 2]
Layer:15, selected task ID:[3 2]
Layer:16, selected task ID:[3 2]
Layer:17, selected task ID:[1 2]
Layer:18, selected task ID:[3 2]
Layer:19, selected task ID:[3 2]
space1 is not None!
space2 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.163, acc= 95.3% | time=80936.0ms |
 Valid: loss=0.200, acc= 93.6% |
Epoch   2 | Train: loss=0.135, acc= 96.3% | time=81801.3ms |
 Valid: loss=0.188, acc= 94.8% |
Epoch   3 | Train: loss=0.078, acc= 98.2% | time=74288.0ms |
 Valid: loss=0.149, acc= 94.5% |
Epoch   4 | Train: loss=0.086, acc= 97.7% | time=83565.5ms |
 Valid: loss=0.167, acc= 94.8% |
Epoch   5 | Train: loss=0.066, acc= 98.5% | time=74896.9ms |
 Valid: loss=0.162, acc= 95.6% |
Epoch   6 | Train: loss=0.100, acc= 96.8% | time=79417.3ms |
 Valid: loss=0.221, acc= 92.5% |
Epoch   7 | Train: loss=0.497, acc= 86.3% | time=77430.4ms |
 Valid: loss=0.673, acc= 83.8% |
Epoch   8 | Train: loss=0.022, acc= 99.6% | time=87971.9ms |
 Valid: loss=0.118, acc= 96.2% |
Epoch   9 | Train: loss=0.016, acc= 99.7% | time=85827.8ms |
 Valid: loss=0.125, acc= 95.7% |
Epoch  10 | Train: loss=0.078, acc= 97.8% | time=82712.5ms |
 Valid: loss=0.303, acc= 92.9% |
Epoch  11 | Train: loss=0.012, acc= 99.8% | time=78403.6ms |
 Valid: loss=0.128, acc= 95.7% |
Epoch  12 | Train: loss=0.009, acc= 99.9% | time=82100.0ms |
 Valid: loss=0.122, acc= 96.6% |
Epoch  13 | Train: loss=0.010, acc= 99.9% | time=77257.3ms |
 Valid: loss=0.138, acc= 95.2% |
 lr=3.3e-02
Epoch  14 | Train: loss=0.006, acc=100.0% | time=85013.2ms |
 Valid: loss=0.114, acc= 96.2% |
Epoch  15 | Train: loss=0.005, acc= 99.9% | time=85905.9ms |
 Valid: loss=0.116, acc= 96.1% |
Epoch  16 | Train: loss=0.005, acc= 99.9% | time=85228.0ms |
 Valid: loss=0.112, acc= 96.2% |
Epoch  17 | Train: loss=0.005, acc= 99.9% | time=76166.2ms |
 Valid: loss=0.118, acc= 96.0% |
Epoch  18 | Train: loss=0.004, acc= 99.9% | time=78879.2ms |
 Valid: loss=0.116, acc= 96.4% |
Epoch  19 | Train: loss=0.006, acc= 99.9% | time=74064.6ms |
 Valid: loss=0.118, acc= 96.4% |
Epoch  20 | Train: loss=0.004, acc= 99.9% | time=82702.2ms |
 Valid: loss=0.124, acc= 96.1% |
Epoch  21 | Train: loss=0.004, acc= 99.9% | time=78308.8ms |
 Valid: loss=0.121, acc= 96.2% |
 lr=1.1e-02
Epoch  22 | Train: loss=0.004, acc= 99.9% | time=69542.9ms |
 Valid: loss=0.126, acc= 96.2% |
Epoch  23 | Train: loss=0.004, acc= 99.9% | time=76467.9ms |
 Valid: loss=0.125, acc= 96.2% |
Epoch  24 | Train: loss=0.004, acc=100.0% | time=80917.7ms |
 Valid: loss=0.119, acc= 96.1% |
Epoch  25 | Train: loss=0.004, acc= 99.9% | time=79328.3ms |
 Valid: loss=0.124, acc= 96.0% |
Epoch  26 | Train: loss=0.004, acc= 99.9% | time=73113.2ms |
 Valid: loss=0.126, acc= 95.7% |
 lr=3.7e-03
Epoch  27 | Train: loss=0.004, acc= 99.9% | time=73675.0ms |
 Valid: loss=0.126, acc= 96.0% |
Epoch  28 | Train: loss=0.004, acc=100.0% | time=79062.3ms |
 Valid: loss=0.122, acc= 96.2% |
Epoch  29 | Train: loss=0.004, acc= 99.9% | time=70362.1ms |
 Valid: loss=0.120, acc= 96.1% |
Epoch  30 | Train: loss=0.004, acc= 99.9% | time=67133.1ms |
 Valid: loss=0.116, acc= 96.3% |
Epoch  31 | Train: loss=0.003, acc= 99.9% | time=80833.6ms |
 Valid: loss=0.114, acc= 96.2% |
 lr=1.2e-03
Epoch  32 | Train: loss=0.003, acc= 99.9% | time=81962.7ms |
 Valid: loss=0.121, acc= 95.8% |
Epoch  33 | Train: loss=0.003, acc= 99.9% | time=79637.1ms |
 Valid: loss=0.117, acc= 96.2% |
Epoch  34 | Train: loss=0.003, acc= 99.9% | time=73454.4ms |
 Valid: loss=0.123, acc= 96.1% |
Epoch  35 | Train: loss=0.003, acc= 99.9% | time=84340.7ms |
 Valid: loss=0.120, acc= 96.2% |
Epoch  36 | Train: loss=0.003, acc=100.0% | time=85626.9ms |
 Valid: loss=0.121, acc= 96.0% |
 lr=4.1e-04
Test: loss=0.151 , acc= 96.0%
Test: loss=0.151 , acc= 95.9%
Test: loss=0.154 , acc= 96.0%
Test: loss=0.155 , acc= 95.7%
Test: loss=0.155 , acc= 95.9%
Test: loss=0.156 , acc= 95.7%
Test: loss=0.152 , acc= 95.8%
Test: loss=0.158 , acc= 95.8%
Test: loss=0.151 , acc= 95.8%
Test: loss=0.153 , acc= 95.7%
Average acc= 95.9%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 6)
threshold for selecting:4073.5802257493715
total ranking r = 3
the number of space for current task:3
the new increased space:0, the threshold for new space:6
Ui shape:(27, 3)
activation shape:(180, 10240)
space shape:(180, 48)
threshold for selecting:27742.638048539076
total ranking r = 36
the number of space for current task:36
the new increased space:0, the threshold for new space:48
Ui shape:(180, 36)
activation shape:(180, 10240)
space shape:(180, 90)
threshold for selecting:16021.772176228476
total ranking r = 73
the number of space for current task:73
the new increased space:1, the threshold for new space:90
Ui shape:(180, 73)
activation shape:(180, 10240)
space shape:(180, 73)
threshold for selecting:76054.48831935004
total ranking r = 58
the number of space for current task:58
the new increased space:1, the threshold for new space:73
Ui shape:(180, 58)
activation shape:(180, 10240)
space shape:(180, 99)
threshold for selecting:15336.563081370265
total ranking r = 85
the number of space for current task:85
the new increased space:0, the threshold for new space:99
Ui shape:(180, 85)
activation shape:(180, 2560)
space shape:(180, 84)
threshold for selecting:25865.38880605113
total ranking r = 63
the number of space for current task:63
the new increased space:0, the threshold for new space:84
Ui shape:(180, 63)
activation shape:(360, 2560)
space shape:(360, 255)
threshold for selecting:8235.447332001844
total ranking r = 213
the number of space for current task:213
the new increased space:6, the threshold for new space:255
Ui shape:(360, 213)
activation shape:(20, 2560)
space shape:(20, 15)
threshold for selecting:3749.5916578993015
total ranking r = 14
the number of space for current task:14
the new increased space:0, the threshold for new space:15
Ui shape:(20, 14)
activation shape:(360, 2560)
space shape:(360, 257)
threshold for selecting:28473.60743561272
total ranking r = 215
the number of space for current task:215
the new increased space:5, the threshold for new space:257
Ui shape:(360, 215)
activation shape:(360, 12800)
space shape:(360, 248)
threshold for selecting:43650.56361780609
total ranking r = 205
the number of space for current task:205
the new increased space:1, the threshold for new space:248
Ui shape:(360, 205)
activation shape:(360, 3200)
space shape:(360, 249)
threshold for selecting:51279.9216078662
total ranking r = 200
the number of space for current task:200
the new increased space:5, the threshold for new space:249
Ui shape:(360, 200)
activation shape:(720, 3200)
space shape:(720, 564)
threshold for selecting:21516.812667838007
total ranking r = 495
the number of space for current task:495
the new increased space:19, the threshold for new space:564
Ui shape:(720, 495)
activation shape:(40, 3200)
space shape:(40, 31)
threshold for selecting:9193.58852841088
total ranking r = 30
the number of space for current task:30
the new increased space:0, the threshold for new space:31
Ui shape:(40, 30)
activation shape:(720, 6400)
space shape:(720, 574)
threshold for selecting:132114.68064290582
total ranking r = 508
the number of space for current task:508
the new increased space:19, the threshold for new space:574
Ui shape:(720, 508)
activation shape:(720, 6400)
space shape:(720, 583)
threshold for selecting:44022.74032877413
total ranking r = 532
the number of space for current task:532
the new increased space:19, the threshold for new space:583
Ui shape:(720, 532)
activation shape:(720, 1600)
space shape:(720, 539)
threshold for selecting:70822.55540457752
total ranking r = 502
the number of space for current task:502
the new increased space:36, the threshold for new space:539
Ui shape:(720, 502)
activation shape:(1440, 1600)
space shape:(1440, 1139)
threshold for selecting:31693.76039236104
total ranking r = 1120
the number of space for current task:1120
the new increased space:88, the threshold for new space:1139
Ui shape:(1440, 1120)
activation shape:(80, 1600)
space shape:(80, 66)
threshold for selecting:8368.458963259922
total ranking r = 63
the number of space for current task:63
the new increased space:2, the threshold for new space:66
Ui shape:(80, 63)
activation shape:(1440, 1600)
space shape:(1440, 1212)
threshold for selecting:40592.32179521483
total ranking r = 1193
the number of space for current task:1193
the new increased space:68, the threshold for new space:1212
Ui shape:(1440, 1193)
activation shape:(1440, 1600)
space shape:(1440, 1181)
threshold for selecting:27367.649394338878
total ranking r = 1166
the number of space for current task:1166
the new increased space:78, the threshold for new space:1181
Ui shape:(1440, 1166)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.638 , acc= 81.7%
Test: loss=0.637 , acc= 81.7%
Test: loss=0.635 , acc= 81.8%
Test: loss=0.635 , acc= 81.7%
Test: loss=0.635 , acc= 81.8%
current testing task:mnist
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
current testing task:svhn
Test: loss=0.205 , acc= 94.3%
Test: loss=0.206 , acc= 94.2%
Test: loss=0.205 , acc= 94.2%
Test: loss=0.206 , acc= 94.2%
Test: loss=0.206 , acc= 94.2%
current testing task:fashion-mnist
Test: loss=0.014 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.4%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
current testing task:notmnist
Test: loss=0.158 , acc= 95.8%
Test: loss=0.152 , acc= 96.0%
Test: loss=0.154 , acc= 95.9%
Test: loss=0.153 , acc= 95.8%
Test: loss=0.155 , acc= 95.6%
Accuracies =
 82.2%   0.0%   0.0%   0.0%   0.0%
 82.0%  99.5%   0.0%   0.0%   0.0%
 81.7%  99.5%  94.2%   0.0%   0.0%
 81.7%  99.5%  94.2%  99.5%   0.0%
 81.7%  99.5%  94.2%  99.5%  95.8%
--------------------------------------------------
Task Order : [0 1 2 3 4]
Final Avg Accuracy: 94.14%
Backward transfer: -0.12%
[Elapsed time = 46827261.4 ms]
--------------------------------------------------
====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=64, gpm_thro=0.96, lr=0.1, lr_factor=3, lr_min=0.001, lr_patience=5, mixup_alpha=1, mixup_weight=0.01, momentum=0.9, n_epochs=100, pc_valid=0.05, savename='./log/DFTRGP/', seed=3)
====================================================================================================
****************************************************************************************************
Task  0 (cifar10)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.1
----------------------------------------
(0, 'conv1.weight', torch.Size([20, 3, 3, 3]))
(1, 'conv1.scale1', torch.Size([27, 27]))
(2, 'conv1.scale2', torch.Size([27, 27]))
(3, 'bn1.weight', torch.Size([20]))
(4, 'bn1.bias', torch.Size([20]))
(5, 'layer1.0.conv1.weight', torch.Size([20, 20, 3, 3]))
(6, 'layer1.0.conv1.scale1', torch.Size([180, 180]))
(7, 'layer1.0.conv1.scale2', torch.Size([180, 180]))
(8, 'layer1.0.bn1.weight', torch.Size([20]))
(9, 'layer1.0.bn1.bias', torch.Size([20]))
(10, 'layer1.0.conv2.weight', torch.Size([20, 20, 3, 3]))
(11, 'layer1.0.conv2.scale1', torch.Size([180, 180]))
(12, 'layer1.0.conv2.scale2', torch.Size([180, 180]))
(13, 'layer1.0.bn2.weight', torch.Size([20]))
(14, 'layer1.0.bn2.bias', torch.Size([20]))
(15, 'layer1.1.conv1.weight', torch.Size([20, 20, 3, 3]))
(16, 'layer1.1.conv1.scale1', torch.Size([180, 180]))
(17, 'layer1.1.conv1.scale2', torch.Size([180, 180]))
(18, 'layer1.1.bn1.weight', torch.Size([20]))
(19, 'layer1.1.bn1.bias', torch.Size([20]))
(20, 'layer1.1.conv2.weight', torch.Size([20, 20, 3, 3]))
(21, 'layer1.1.conv2.scale1', torch.Size([180, 180]))
(22, 'layer1.1.conv2.scale2', torch.Size([180, 180]))
(23, 'layer1.1.bn2.weight', torch.Size([20]))
(24, 'layer1.1.bn2.bias', torch.Size([20]))
(25, 'layer2.0.conv1.weight', torch.Size([40, 20, 3, 3]))
(26, 'layer2.0.conv1.scale1', torch.Size([180, 180]))
(27, 'layer2.0.conv1.scale2', torch.Size([180, 180]))
(28, 'layer2.0.bn1.weight', torch.Size([40]))
(29, 'layer2.0.bn1.bias', torch.Size([40]))
(30, 'layer2.0.conv2.weight', torch.Size([40, 40, 3, 3]))
(31, 'layer2.0.conv2.scale1', torch.Size([360, 360]))
(32, 'layer2.0.conv2.scale2', torch.Size([360, 360]))
(33, 'layer2.0.bn2.weight', torch.Size([40]))
(34, 'layer2.0.bn2.bias', torch.Size([40]))
(35, 'layer2.0.shortcut.0.weight', torch.Size([40, 20, 1, 1]))
(36, 'layer2.0.shortcut.0.scale1', torch.Size([20, 20]))
(37, 'layer2.0.shortcut.0.scale2', torch.Size([20, 20]))
(38, 'layer2.0.shortcut.1.weight', torch.Size([40]))
(39, 'layer2.0.shortcut.1.bias', torch.Size([40]))
(40, 'layer2.1.conv1.weight', torch.Size([40, 40, 3, 3]))
(41, 'layer2.1.conv1.scale1', torch.Size([360, 360]))
(42, 'layer2.1.conv1.scale2', torch.Size([360, 360]))
(43, 'layer2.1.bn1.weight', torch.Size([40]))
(44, 'layer2.1.bn1.bias', torch.Size([40]))
(45, 'layer2.1.conv2.weight', torch.Size([40, 40, 3, 3]))
(46, 'layer2.1.conv2.scale1', torch.Size([360, 360]))
(47, 'layer2.1.conv2.scale2', torch.Size([360, 360]))
(48, 'layer2.1.bn2.weight', torch.Size([40]))
(49, 'layer2.1.bn2.bias', torch.Size([40]))
(50, 'layer3.0.conv1.weight', torch.Size([80, 40, 3, 3]))
(51, 'layer3.0.conv1.scale1', torch.Size([360, 360]))
(52, 'layer3.0.conv1.scale2', torch.Size([360, 360]))
(53, 'layer3.0.bn1.weight', torch.Size([80]))
(54, 'layer3.0.bn1.bias', torch.Size([80]))
(55, 'layer3.0.conv2.weight', torch.Size([80, 80, 3, 3]))
(56, 'layer3.0.conv2.scale1', torch.Size([720, 720]))
(57, 'layer3.0.conv2.scale2', torch.Size([720, 720]))
(58, 'layer3.0.bn2.weight', torch.Size([80]))
(59, 'layer3.0.bn2.bias', torch.Size([80]))
(60, 'layer3.0.shortcut.0.weight', torch.Size([80, 40, 1, 1]))
(61, 'layer3.0.shortcut.0.scale1', torch.Size([40, 40]))
(62, 'layer3.0.shortcut.0.scale2', torch.Size([40, 40]))
(63, 'layer3.0.shortcut.1.weight', torch.Size([80]))
(64, 'layer3.0.shortcut.1.bias', torch.Size([80]))
(65, 'layer3.1.conv1.weight', torch.Size([80, 80, 3, 3]))
(66, 'layer3.1.conv1.scale1', torch.Size([720, 720]))
(67, 'layer3.1.conv1.scale2', torch.Size([720, 720]))
(68, 'layer3.1.bn1.weight', torch.Size([80]))
(69, 'layer3.1.bn1.bias', torch.Size([80]))
(70, 'layer3.1.conv2.weight', torch.Size([80, 80, 3, 3]))
(71, 'layer3.1.conv2.scale1', torch.Size([720, 720]))
(72, 'layer3.1.conv2.scale2', torch.Size([720, 720]))
(73, 'layer3.1.bn2.weight', torch.Size([80]))
(74, 'layer3.1.bn2.bias', torch.Size([80]))
(75, 'layer4.0.conv1.weight', torch.Size([160, 80, 3, 3]))
(76, 'layer4.0.conv1.scale1', torch.Size([720, 720]))
(77, 'layer4.0.conv1.scale2', torch.Size([720, 720]))
(78, 'layer4.0.bn1.weight', torch.Size([160]))
(79, 'layer4.0.bn1.bias', torch.Size([160]))
(80, 'layer4.0.conv2.weight', torch.Size([160, 160, 3, 3]))
(81, 'layer4.0.conv2.scale1', torch.Size([1440, 1440]))
(82, 'layer4.0.conv2.scale2', torch.Size([1440, 1440]))
(83, 'layer4.0.bn2.weight', torch.Size([160]))
(84, 'layer4.0.bn2.bias', torch.Size([160]))
(85, 'layer4.0.shortcut.0.weight', torch.Size([160, 80, 1, 1]))
(86, 'layer4.0.shortcut.0.scale1', torch.Size([80, 80]))
(87, 'layer4.0.shortcut.0.scale2', torch.Size([80, 80]))
(88, 'layer4.0.shortcut.1.weight', torch.Size([160]))
(89, 'layer4.0.shortcut.1.bias', torch.Size([160]))
(90, 'layer4.1.conv1.weight', torch.Size([160, 160, 3, 3]))
(91, 'layer4.1.conv1.scale1', torch.Size([1440, 1440]))
(92, 'layer4.1.conv1.scale2', torch.Size([1440, 1440]))
(93, 'layer4.1.bn1.weight', torch.Size([160]))
(94, 'layer4.1.bn1.bias', torch.Size([160]))
(95, 'layer4.1.conv2.weight', torch.Size([160, 160, 3, 3]))
(96, 'layer4.1.conv2.scale1', torch.Size([1440, 1440]))
(97, 'layer4.1.conv2.scale2', torch.Size([1440, 1440]))
(98, 'layer4.1.bn2.weight', torch.Size([160]))
(99, 'layer4.1.bn2.bias', torch.Size([160]))
(100, 'linear.0.weight', torch.Size([10, 640]))
(101, 'linear.1.weight', torch.Size([10, 640]))
(102, 'linear.2.weight', torch.Size([10, 640]))
(103, 'linear.3.weight', torch.Size([10, 640]))
(104, 'linear.4.weight', torch.Size([10, 640]))
Model parameters ---
(0, 'conv1.weight', torch.Size([20, 3, 3, 3]))
(5, 'layer1.0.conv1.weight', torch.Size([20, 20, 3, 3]))
(10, 'layer1.0.conv2.weight', torch.Size([20, 20, 3, 3]))
(15, 'layer1.1.conv1.weight', torch.Size([20, 20, 3, 3]))
(20, 'layer1.1.conv2.weight', torch.Size([20, 20, 3, 3]))
(25, 'layer2.0.conv1.weight', torch.Size([40, 20, 3, 3]))
(30, 'layer2.0.conv2.weight', torch.Size([40, 40, 3, 3]))
(35, 'layer2.0.shortcut.0.weight', torch.Size([40, 20, 1, 1]))
(40, 'layer2.1.conv1.weight', torch.Size([40, 40, 3, 3]))
(45, 'layer2.1.conv2.weight', torch.Size([40, 40, 3, 3]))
(50, 'layer3.0.conv1.weight', torch.Size([80, 40, 3, 3]))
(55, 'layer3.0.conv2.weight', torch.Size([80, 80, 3, 3]))
(60, 'layer3.0.shortcut.0.weight', torch.Size([80, 40, 1, 1]))
(65, 'layer3.1.conv1.weight', torch.Size([80, 80, 3, 3]))
(70, 'layer3.1.conv2.weight', torch.Size([80, 80, 3, 3]))
(75, 'layer4.0.conv1.weight', torch.Size([160, 80, 3, 3]))
(80, 'layer4.0.conv2.weight', torch.Size([160, 160, 3, 3]))
(85, 'layer4.0.shortcut.0.weight', torch.Size([160, 80, 1, 1]))
(90, 'layer4.1.conv1.weight', torch.Size([160, 160, 3, 3]))
(95, 'layer4.1.conv2.weight', torch.Size([160, 160, 3, 3]))
----------------------------------------
Epoch   1 | Train: loss=1.509, acc= 44.1% | time=51611.5ms |
 Valid: loss=1.556, acc= 43.0% |
 *
Epoch   2 | Train: loss=1.221, acc= 55.2% | time=53886.1ms |
 Valid: loss=1.245, acc= 53.8% |
 *
Epoch   3 | Train: loss=1.185, acc= 58.1% | time=62099.9ms |
 Valid: loss=1.231, acc= 57.4% |
 *
Epoch   4 | Train: loss=0.659, acc= 77.3% | time=59656.0ms |
 Valid: loss=0.752, acc= 73.4% |
 *
Epoch   5 | Train: loss=0.670, acc= 76.2% | time=62366.9ms |
 Valid: loss=0.812, acc= 71.8% |
Epoch   6 | Train: loss=0.492, acc= 82.9% | time=56924.6ms |
 Valid: loss=0.681, acc= 76.0% |
 *
Epoch   7 | Train: loss=0.511, acc= 81.5% | time=58168.1ms |
 Valid: loss=0.768, acc= 72.5% |
Epoch   8 | Train: loss=0.325, acc= 89.3% | time=53979.2ms |
 Valid: loss=0.652, acc= 77.5% |
 *
Epoch   9 | Train: loss=0.292, acc= 90.2% | time=51851.2ms |
 Valid: loss=0.671, acc= 76.6% |
Epoch  10 | Train: loss=0.218, acc= 93.2% | time=54969.6ms |
 Valid: loss=0.646, acc= 78.5% |
 *
Epoch  11 | Train: loss=0.182, acc= 94.3% | time=54720.1ms |
 Valid: loss=0.663, acc= 78.7% |
Epoch  12 | Train: loss=0.210, acc= 93.4% | time=50005.6ms |
 Valid: loss=0.717, acc= 76.8% |
Epoch  13 | Train: loss=0.172, acc= 93.7% | time=52420.8ms |
 Valid: loss=0.751, acc= 77.4% |
Epoch  14 | Train: loss=0.301, acc= 89.9% | time=56072.1ms |
 Valid: loss=0.953, acc= 74.0% |
Epoch  15 | Train: loss=0.097, acc= 97.3% | time=51391.4ms |
 Valid: loss=0.696, acc= 79.5% |
 lr=3.3e-02
Epoch  16 | Train: loss=0.013, acc=100.0% | time=60616.4ms |
 Valid: loss=0.542, acc= 83.0% |
 *
Epoch  17 | Train: loss=0.008, acc=100.0% | time=52738.9ms |
 Valid: loss=0.546, acc= 83.1% |
Epoch  18 | Train: loss=0.008, acc=100.0% | time=51395.3ms |
 Valid: loss=0.569, acc= 83.0% |
Epoch  19 | Train: loss=0.006, acc=100.0% | time=53399.1ms |
 Valid: loss=0.562, acc= 83.2% |
Epoch  20 | Train: loss=0.009, acc=100.0% | time=48651.0ms |
 Valid: loss=0.594, acc= 82.0% |
Epoch  21 | Train: loss=0.010, acc= 99.9% | time=51510.9ms |
 Valid: loss=0.600, acc= 81.7% |
 lr=1.1e-02
Epoch  22 | Train: loss=0.005, acc=100.0% | time=49445.3ms |
 Valid: loss=0.558, acc= 83.0% |
Epoch  23 | Train: loss=0.005, acc=100.0% | time=56612.3ms |
 Valid: loss=0.554, acc= 82.6% |
Epoch  24 | Train: loss=0.005, acc=100.0% | time=53463.4ms |
 Valid: loss=0.548, acc= 83.0% |
Epoch  25 | Train: loss=0.004, acc=100.0% | time=51871.0ms |
 Valid: loss=0.552, acc= 82.6% |
Epoch  26 | Train: loss=0.004, acc=100.0% | time=61034.0ms |
 Valid: loss=0.540, acc= 84.0% |
 *
Epoch  27 | Train: loss=0.004, acc=100.0% | time=54716.8ms |
 Valid: loss=0.549, acc= 83.5% |
Epoch  28 | Train: loss=0.004, acc=100.0% | time=61463.9ms |
 Valid: loss=0.558, acc= 82.9% |
Epoch  29 | Train: loss=0.004, acc=100.0% | time=54734.7ms |
 Valid: loss=0.555, acc= 83.1% |
Epoch  30 | Train: loss=0.004, acc=100.0% | time=50406.0ms |
 Valid: loss=0.552, acc= 83.1% |
Epoch  31 | Train: loss=0.004, acc=100.0% | time=51664.5ms |
 Valid: loss=0.559, acc= 83.0% |
 lr=3.7e-03
Epoch  32 | Train: loss=0.004, acc=100.0% | time=57193.3ms |
 Valid: loss=0.562, acc= 83.2% |
Epoch  33 | Train: loss=0.004, acc=100.0% | time=50560.6ms |
 Valid: loss=0.555, acc= 82.8% |
Epoch  34 | Train: loss=0.004, acc=100.0% | time=51647.7ms |
 Valid: loss=0.559, acc= 83.2% |
Epoch  35 | Train: loss=0.004, acc=100.0% | time=55085.4ms |
 Valid: loss=0.560, acc= 83.2% |
Epoch  36 | Train: loss=0.004, acc=100.0% | time=54120.3ms |
 Valid: loss=0.550, acc= 84.0% |
 lr=1.2e-03
Epoch  37 | Train: loss=0.004, acc=100.0% | time=57852.9ms |
 Valid: loss=0.548, acc= 83.4% |
Epoch  38 | Train: loss=0.004, acc=100.0% | time=51479.1ms |
 Valid: loss=0.559, acc= 82.4% |
Epoch  39 | Train: loss=0.004, acc=100.0% | time=59297.1ms |
 Valid: loss=0.558, acc= 83.5% |
Epoch  40 | Train: loss=0.004, acc=100.0% | time=50446.0ms |
 Valid: loss=0.556, acc= 83.1% |
Epoch  41 | Train: loss=0.004, acc=100.0% | time=55663.1ms |
 Valid: loss=0.560, acc= 83.3% |
 lr=4.1e-04
----------------------------------------
Test: loss=0.592 , acc= 82.5%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.597 , acc= 82.3%
Test: loss=0.597 , acc= 82.3%
Test: loss=0.598 , acc= 82.6%
Test: loss=0.595 , acc= 82.5%
Test: loss=0.595 , acc= 82.6%
Accuracies =
 82.5%   0.0%   0.0%   0.0%   0.0%
****************************************************************************************************
Task  1 (mnist)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 4)
Task:0, Layer:0, project_norm:0.043618082694745784, threshold for regime 1:0.022467276081442833
Task:0, layer:1, space shape:(180, 39)
Task:0, Layer:1, project_norm:0.05703671811973221, threshold for regime 1:0.029844166710972786
Task:0, layer:2, space shape:(180, 73)
Task:0, Layer:2, project_norm:0.0495003721041341, threshold for regime 1:0.025608671829104424
Task:0, layer:3, space shape:(180, 61)
Task:0, Layer:3, project_norm:0.05227548214473502, threshold for regime 1:0.027162814512848854
Task:0, layer:4, space shape:(180, 89)
Task:0, Layer:4, project_norm:0.05663685556300952, threshold for regime 1:0.028890784829854965
Task:0, layer:5, space shape:(180, 66)
Task:0, Layer:5, project_norm:0.0617146727609878, threshold for regime 1:0.031854093074798584
Task:0, layer:6, space shape:(360, 192)
Task:0, Layer:6, project_norm:0.09455171358287597, threshold for regime 1:0.04842988774180412
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.04471298551242492, threshold for regime 1:0.023662880063056946
Task:0, layer:8, space shape:(360, 196)
Task:0, Layer:8, project_norm:0.09775032446358856, threshold for regime 1:0.04972890391945839
Task:0, layer:9, space shape:(360, 220)
Task:0, Layer:9, project_norm:0.08877977046106716, threshold for regime 1:0.04499863088130951
Task:0, layer:10, space shape:(360, 191)
Task:0, Layer:10, project_norm:0.11827226696039292, threshold for regime 1:0.06042001396417618
Task:0, layer:11, space shape:(720, 422)
Task:0, Layer:11, project_norm:0.174899576206665, threshold for regime 1:0.08995063602924347
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.08748885721423008, threshold for regime 1:0.04475240409374237
Task:0, layer:13, space shape:(720, 453)
Task:0, Layer:13, project_norm:0.15568987099091264, threshold for regime 1:0.07947501540184021
Task:0, layer:14, space shape:(720, 471)
Task:0, Layer:14, project_norm:0.17534815994705621, threshold for regime 1:0.08993951976299286
Task:0, layer:15, space shape:(720, 340)
Task:0, Layer:15, project_norm:0.2389349891034626, threshold for regime 1:0.125718891620636
Task:0, layer:16, space shape:(1440, 613)
Task:0, Layer:16, project_norm:0.3515944521717318, threshold for regime 1:0.19210770726203918
Task:0, layer:17, space shape:(80, 58)
Task:0, Layer:17, project_norm:0.16908632637051152, threshold for regime 1:0.08751580864191055
Task:0, layer:18, space shape:(1440, 691)
Task:0, Layer:18, project_norm:0.3910365709530695, threshold for regime 1:0.21525464951992035
Task:0, layer:19, space shape:(1440, 671)
Task:0, Layer:19, project_norm:0.5968280695146583, threshold for regime 1:0.32796815037727356
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
space1 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.034, acc= 99.3% | time=179421.1ms |
 Valid: loss=0.045, acc= 98.7% |
Epoch   2 | Train: loss=0.020, acc= 99.7% | time=165383.0ms |
 Valid: loss=0.034, acc= 99.1% |
Epoch   3 | Train: loss=0.016, acc= 99.7% | time=175433.5ms |
 Valid: loss=0.030, acc= 99.1% |
Epoch   4 | Train: loss=0.012, acc= 99.8% | time=183116.8ms |
 Valid: loss=0.028, acc= 99.1% |
Epoch   5 | Train: loss=0.010, acc= 99.9% | time=180675.7ms |
 Valid: loss=0.026, acc= 99.1% |
Epoch   6 | Train: loss=0.008, acc= 99.9% | time=183875.1ms |
 Valid: loss=0.024, acc= 99.2% |
Epoch   7 | Train: loss=0.007, acc= 99.9% | time=183760.6ms |
 Valid: loss=0.026, acc= 99.1% |
Epoch   8 | Train: loss=0.005, acc= 99.9% | time=180779.8ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch   9 | Train: loss=0.004, acc=100.0% | time=182773.7ms |
 Valid: loss=0.023, acc= 99.1% |
Epoch  10 | Train: loss=0.003, acc=100.0% | time=189219.2ms |
 Valid: loss=0.019, acc= 99.3% |
Epoch  11 | Train: loss=0.002, acc=100.0% | time=190036.4ms |
 Valid: loss=0.022, acc= 99.4% |
Epoch  12 | Train: loss=0.002, acc=100.0% | time=185604.8ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  13 | Train: loss=0.002, acc=100.0% | time=194356.2ms |
 Valid: loss=0.028, acc= 99.1% |
Epoch  14 | Train: loss=0.001, acc=100.0% | time=181922.1ms |
 Valid: loss=0.022, acc= 99.2% |
Epoch  15 | Train: loss=0.001, acc=100.0% | time=178924.3ms |
 Valid: loss=0.022, acc= 99.3% |
 lr=3.3e-02
Epoch  16 | Train: loss=0.001, acc=100.0% | time=195210.3ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  17 | Train: loss=0.001, acc=100.0% | time=188157.0ms |
 Valid: loss=0.018, acc= 99.4% |
Epoch  18 | Train: loss=0.001, acc=100.0% | time=183021.8ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  19 | Train: loss=0.001, acc=100.0% | time=202731.7ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  20 | Train: loss=0.001, acc=100.0% | time=189929.4ms |
 Valid: loss=0.019, acc= 99.4% |
Epoch  21 | Train: loss=0.001, acc=100.0% | time=154424.6ms |
 Valid: loss=0.023, acc= 99.3% |
Epoch  22 | Train: loss=0.000, acc=100.0% | time=139429.5ms |
 Valid: loss=0.021, acc= 99.4% |
 lr=1.1e-02
Epoch  23 | Train: loss=0.000, acc=100.0% | time=155412.4ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  24 | Train: loss=0.000, acc=100.0% | time=156868.8ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  25 | Train: loss=0.000, acc=100.0% | time=144473.2ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  26 | Train: loss=0.000, acc=100.0% | time=141696.5ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  27 | Train: loss=0.000, acc=100.0% | time=135952.3ms |
 Valid: loss=0.022, acc= 99.4% |
 lr=3.7e-03
Epoch  28 | Train: loss=0.000, acc=100.0% | time=141641.4ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  29 | Train: loss=0.000, acc=100.0% | time=142728.8ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  30 | Train: loss=0.000, acc=100.0% | time=136785.8ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  31 | Train: loss=0.000, acc=100.0% | time=158677.2ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  32 | Train: loss=0.000, acc=100.0% | time=140548.9ms |
 Valid: loss=0.020, acc= 99.4% |
 lr=1.2e-03
Epoch  33 | Train: loss=0.000, acc=100.0% | time=148170.3ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  34 | Train: loss=0.000, acc=100.0% | time=143956.8ms |
 Valid: loss=0.018, acc= 99.3% |
Epoch  35 | Train: loss=0.000, acc=100.0% | time=141459.3ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  36 | Train: loss=0.000, acc=100.0% | time=135558.4ms |
 Valid: loss=0.023, acc= 99.3% |
Epoch  37 | Train: loss=0.000, acc=100.0% | time=137853.8ms |
 Valid: loss=0.021, acc= 99.4% |
 lr=4.1e-04
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Average acc= 99.5%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 4)
threshold for selecting:23564.768566576684
total ranking r = 5
the number of space for current task:5
the new increased space:1, the threshold for new space:4
Ui shape:(27, 5)
activation shape:(180, 10240)
space shape:(180, 39)
threshold for selecting:81642.51913834274
total ranking r = 47
the number of space for current task:47
the new increased space:8, the threshold for new space:39
Ui shape:(180, 47)
activation shape:(180, 10240)
space shape:(180, 73)
threshold for selecting:32267.55228249495
total ranking r = 82
the number of space for current task:82
the new increased space:10, the threshold for new space:73
Ui shape:(180, 82)
activation shape:(180, 10240)
space shape:(180, 61)
threshold for selecting:160008.18959124442
total ranking r = 70
the number of space for current task:70
the new increased space:9, the threshold for new space:61
Ui shape:(180, 70)
activation shape:(180, 10240)
space shape:(180, 89)
threshold for selecting:21336.572901987496
total ranking r = 96
the number of space for current task:96
the new increased space:9, the threshold for new space:89
Ui shape:(180, 96)
activation shape:(180, 2560)
space shape:(180, 66)
threshold for selecting:65442.345995476426
total ranking r = 77
the number of space for current task:77
the new increased space:11, the threshold for new space:66
Ui shape:(180, 77)
activation shape:(360, 2560)
space shape:(360, 192)
threshold for selecting:25348.620680314823
total ranking r = 211
the number of space for current task:211
the new increased space:30, the threshold for new space:192
Ui shape:(360, 211)
activation shape:(20, 2560)
space shape:(20, 13)
threshold for selecting:8169.2488155740675
total ranking r = 15
the number of space for current task:15
the new increased space:2, the threshold for new space:13
Ui shape:(20, 15)
activation shape:(360, 2560)
space shape:(360, 196)
threshold for selecting:69910.77215243498
total ranking r = 211
the number of space for current task:211
the new increased space:29, the threshold for new space:196
Ui shape:(360, 211)
activation shape:(360, 12800)
space shape:(360, 220)
threshold for selecting:76115.99239668962
total ranking r = 222
the number of space for current task:222
the new increased space:19, the threshold for new space:220
Ui shape:(360, 222)
activation shape:(360, 3200)
space shape:(360, 191)
threshold for selecting:125915.1622745056
total ranking r = 203
the number of space for current task:203
the new increased space:27, the threshold for new space:191
Ui shape:(360, 203)
activation shape:(720, 3200)
space shape:(720, 422)
threshold for selecting:70701.02601273094
total ranking r = 471
the number of space for current task:471
the new increased space:73, the threshold for new space:422
Ui shape:(720, 471)
activation shape:(40, 3200)
space shape:(40, 29)
threshold for selecting:12747.194162000951
total ranking r = 30
the number of space for current task:30
the new increased space:3, the threshold for new space:29
Ui shape:(40, 30)
activation shape:(720, 6400)
space shape:(720, 453)
threshold for selecting:308140.7697197879
total ranking r = 480
the number of space for current task:480
the new increased space:56, the threshold for new space:453
Ui shape:(720, 480)
activation shape:(720, 6400)
space shape:(720, 471)
threshold for selecting:92155.89468771422
total ranking r = 496
the number of space for current task:496
the new increased space:56, the threshold for new space:471
Ui shape:(720, 496)
activation shape:(720, 1600)
space shape:(720, 340)
threshold for selecting:201027.49585686755
total ranking r = 405
the number of space for current task:405
the new increased space:80, the threshold for new space:340
Ui shape:(720, 405)
activation shape:(1440, 1600)
space shape:(1440, 613)
threshold for selecting:116879.61764050752
total ranking r = 826
the number of space for current task:826
the new increased space:213, the threshold for new space:613
Ui shape:(1440, 826)
activation shape:(80, 1600)
space shape:(80, 58)
threshold for selecting:13437.775210643415
total ranking r = 60
the number of space for current task:60
the new increased space:5, the threshold for new space:58
Ui shape:(80, 60)
activation shape:(1440, 1600)
space shape:(1440, 691)
threshold for selecting:110303.43667033086
total ranking r = 934
the number of space for current task:934
the new increased space:242, the threshold for new space:691
Ui shape:(1440, 934)
activation shape:(1440, 1600)
space shape:(1440, 671)
threshold for selecting:97765.02812054621
total ranking r = 907
the number of space for current task:907
the new increased space:235, the threshold for new space:671
Ui shape:(1440, 907)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.597 , acc= 82.8%
Test: loss=0.597 , acc= 82.5%
Test: loss=0.596 , acc= 82.3%
Test: loss=0.596 , acc= 82.7%
Test: loss=0.594 , acc= 82.5%
current testing task:mnist
Test: loss=0.015 , acc= 99.5%
Test: loss=0.016 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Accuracies =
 82.5%   0.0%   0.0%   0.0%   0.0%
 82.6%  99.5%   0.0%   0.0%   0.0%
****************************************************************************************************
Task  2 (svhn)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 4)
Task:0, Layer:0, project_norm:0.06965329373419081, threshold for regime 1:0.035276878625154495
Task:0, layer:1, space shape:(180, 39)
Task:0, Layer:1, project_norm:0.06451617038850334, threshold for regime 1:0.03287935629487038
Task:0, layer:2, space shape:(180, 73)
Task:0, Layer:2, project_norm:0.06081837430552194, threshold for regime 1:0.030795976519584656
Task:0, layer:3, space shape:(180, 61)
Task:0, Layer:3, project_norm:0.06310267520648703, threshold for regime 1:0.03207912668585777
Task:0, layer:4, space shape:(180, 89)
Task:0, Layer:4, project_norm:0.054053962686637196, threshold for regime 1:0.027265043929219246
Task:0, layer:5, space shape:(180, 66)
Task:0, Layer:5, project_norm:0.057933304683813594, threshold for regime 1:0.029669547453522682
Task:0, layer:6, space shape:(360, 192)
Task:0, Layer:6, project_norm:0.06478982233897758, threshold for regime 1:0.033162910491228104
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.03178878777836837, threshold for regime 1:0.016674235463142395
Task:0, layer:8, space shape:(360, 196)
Task:0, Layer:8, project_norm:0.06377821853838025, threshold for regime 1:0.03237082064151764
Task:0, layer:9, space shape:(360, 220)
Task:0, Layer:9, project_norm:0.061929350474673246, threshold for regime 1:0.031234288588166237
Task:0, layer:10, space shape:(360, 191)
Task:0, Layer:10, project_norm:0.09338607564339073, threshold for regime 1:0.04740554466843605
Task:0, layer:11, space shape:(720, 422)
Task:0, Layer:11, project_norm:0.11581927598726253, threshold for regime 1:0.059270501136779785
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.053946407447028666, threshold for regime 1:0.027523821219801903
Task:0, layer:13, space shape:(720, 453)
Task:0, Layer:13, project_norm:0.09995601357051022, threshold for regime 1:0.05080025643110275
Task:0, layer:14, space shape:(720, 471)
Task:0, Layer:14, project_norm:0.11114182990908085, threshold for regime 1:0.05655047670006752
Task:0, layer:15, space shape:(720, 340)
Task:0, Layer:15, project_norm:0.15969426327031108, threshold for regime 1:0.0822281762957573
Task:0, layer:16, space shape:(1440, 613)
Task:0, Layer:16, project_norm:0.20728289969876287, threshold for regime 1:0.10980431735515594
Task:0, layer:17, space shape:(80, 58)
Task:0, Layer:17, project_norm:0.10663689248144659, threshold for regime 1:0.05453614145517349
Task:0, layer:18, space shape:(1440, 691)
Task:0, Layer:18, project_norm:0.23172419267683791, threshold for regime 1:0.12319786846637726
Task:0, layer:19, space shape:(1440, 671)
Task:0, Layer:19, project_norm:0.3330404991517598, threshold for regime 1:0.1775721311569214
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:1, layer:0, space shape:(27, 5)
Task:1, Layer:0, project_norm:0.06870581659931291, threshold for regime 1:0.035276878625154495
Task:1, layer:1, space shape:(180, 47)
Task:1, Layer:1, project_norm:0.06451757271202328, threshold for regime 1:0.03287935629487038
Task:1, layer:2, space shape:(180, 82)
Task:1, Layer:2, project_norm:0.06096632703364837, threshold for regime 1:0.030795976519584656
Task:1, layer:3, space shape:(180, 70)
Task:1, Layer:3, project_norm:0.06328976640382922, threshold for regime 1:0.03207912668585777
Task:1, layer:4, space shape:(180, 96)
Task:1, Layer:4, project_norm:0.05411438177448807, threshold for regime 1:0.027265043929219246
Task:1, layer:5, space shape:(180, 77)
Task:1, Layer:5, project_norm:0.05827671392838331, threshold for regime 1:0.029669547453522682
Task:1, layer:6, space shape:(360, 211)
Task:1, Layer:6, project_norm:0.06502269899248325, threshold for regime 1:0.033162910491228104
Task:1, layer:7, space shape:(20, 15)
Task:1, Layer:7, project_norm:0.03196981353306878, threshold for regime 1:0.016674235463142395
Task:1, layer:8, space shape:(360, 211)
Task:1, Layer:8, project_norm:0.06396107150503284, threshold for regime 1:0.03237082064151764
Task:1, layer:9, space shape:(360, 222)
Task:1, Layer:9, project_norm:0.06189165712582394, threshold for regime 1:0.031234288588166237
Task:1, layer:10, space shape:(360, 203)
Task:1, Layer:10, project_norm:0.09346716470151464, threshold for regime 1:0.04740554466843605
Task:1, layer:11, space shape:(720, 471)
Task:1, Layer:11, project_norm:0.11629705579687914, threshold for regime 1:0.059270501136779785
Task:1, layer:12, space shape:(40, 30)
Task:1, Layer:12, project_norm:0.05363827702298283, threshold for regime 1:0.027523821219801903
Task:1, layer:13, space shape:(720, 480)
Task:1, Layer:13, project_norm:0.10011634171960376, threshold for regime 1:0.05080025643110275
Task:1, layer:14, space shape:(720, 496)
Task:1, Layer:14, project_norm:0.11130937144243132, threshold for regime 1:0.05655047670006752
Task:1, layer:15, space shape:(720, 405)
Task:1, Layer:15, project_norm:0.16072335640849186, threshold for regime 1:0.0822281762957573
Task:1, layer:16, space shape:(1440, 826)
Task:1, Layer:16, project_norm:0.2116157806612086, threshold for regime 1:0.10980431735515594
Task:1, layer:17, space shape:(80, 60)
Task:1, Layer:17, project_norm:0.10676479712505743, threshold for regime 1:0.05453614145517349
Task:1, layer:18, space shape:(1440, 934)
Task:1, Layer:18, project_norm:0.23777084687683633, threshold for regime 1:0.12319786846637726
Task:1, layer:19, space shape:(1440, 907)
Task:1, Layer:19, project_norm:0.3424207259081943, threshold for regime 1:0.1775721311569214
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Layer:0, selected task ID:[1]
Layer:1, selected task ID:[1]
Layer:2, selected task ID:[1]
Layer:3, selected task ID:[1]
Layer:4, selected task ID:[1]
Layer:5, selected task ID:[1]
Layer:6, selected task ID:[1]
Layer:7, selected task ID:[1]
Layer:8, selected task ID:[1]
Layer:9, selected task ID:[1]
Layer:10, selected task ID:[1]
Layer:11, selected task ID:[1]
Layer:12, selected task ID:[1]
Layer:13, selected task ID:[1]
Layer:14, selected task ID:[1]
Layer:15, selected task ID:[1]
Layer:16, selected task ID:[1]
Layer:17, selected task ID:[1]
Layer:18, selected task ID:[1]
Layer:19, selected task ID:[1]
space1 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.278, acc= 92.3% | time=165316.3ms |
 Valid: loss=0.326, acc= 90.6% |
Epoch   2 | Train: loss=0.225, acc= 93.7% | time=193777.5ms |
 Valid: loss=0.296, acc= 91.3% |
Epoch   3 | Train: loss=0.168, acc= 95.7% | time=182970.4ms |
 Valid: loss=0.254, acc= 93.2% |
Epoch   4 | Train: loss=0.146, acc= 96.3% | time=170692.9ms |
 Valid: loss=0.245, acc= 92.8% |
Epoch   5 | Train: loss=0.128, acc= 97.1% | time=172408.5ms |
 Valid: loss=0.244, acc= 93.4% |
Epoch   6 | Train: loss=0.101, acc= 97.9% | time=178393.0ms |
 Valid: loss=0.225, acc= 94.0% |
Epoch   7 | Train: loss=0.079, acc= 98.5% | time=170863.2ms |
 Valid: loss=0.225, acc= 93.6% |
Epoch   8 | Train: loss=0.063, acc= 99.0% | time=186299.3ms |
 Valid: loss=0.221, acc= 93.9% |
Epoch   9 | Train: loss=0.052, acc= 99.2% | time=170421.2ms |
 Valid: loss=0.231, acc= 93.7% |
Epoch  10 | Train: loss=0.039, acc= 99.4% | time=184933.0ms |
 Valid: loss=0.225, acc= 93.6% |
Epoch  11 | Train: loss=0.029, acc= 99.6% | time=179965.5ms |
 Valid: loss=0.230, acc= 93.9% |
Epoch  12 | Train: loss=0.023, acc= 99.7% | time=180603.2ms |
 Valid: loss=0.232, acc= 93.7% |
Epoch  13 | Train: loss=0.017, acc= 99.9% | time=174347.2ms |
 Valid: loss=0.236, acc= 93.8% |
 lr=3.3e-02
Epoch  14 | Train: loss=0.011, acc= 99.9% | time=168079.5ms |
 Valid: loss=0.233, acc= 94.1% |
Epoch  15 | Train: loss=0.009, acc= 99.9% | time=168635.0ms |
 Valid: loss=0.230, acc= 93.9% |
Epoch  16 | Train: loss=0.008, acc= 99.9% | time=187757.6ms |
 Valid: loss=0.232, acc= 93.9% |
Epoch  17 | Train: loss=0.007, acc=100.0% | time=177856.8ms |
 Valid: loss=0.235, acc= 93.9% |
Epoch  18 | Train: loss=0.006, acc=100.0% | time=190637.4ms |
 Valid: loss=0.234, acc= 94.2% |
 lr=1.1e-02
Epoch  19 | Train: loss=0.006, acc=100.0% | time=183350.3ms |
 Valid: loss=0.238, acc= 94.2% |
Epoch  20 | Train: loss=0.006, acc=100.0% | time=183575.6ms |
 Valid: loss=0.239, acc= 94.1% |
Epoch  21 | Train: loss=0.006, acc=100.0% | time=182216.6ms |
 Valid: loss=0.239, acc= 94.0% |
Epoch  22 | Train: loss=0.006, acc=100.0% | time=168536.7ms |
 Valid: loss=0.238, acc= 94.1% |
Epoch  23 | Train: loss=0.005, acc=100.0% | time=177503.2ms |
 Valid: loss=0.238, acc= 94.1% |
 lr=3.7e-03
Epoch  24 | Train: loss=0.005, acc=100.0% | time=185106.5ms |
 Valid: loss=0.233, acc= 94.1% |
Epoch  25 | Train: loss=0.005, acc=100.0% | time=178819.8ms |
 Valid: loss=0.242, acc= 93.9% |
Epoch  26 | Train: loss=0.005, acc=100.0% | time=170181.3ms |
 Valid: loss=0.238, acc= 94.0% |
Epoch  27 | Train: loss=0.005, acc=100.0% | time=176690.0ms |
 Valid: loss=0.237, acc= 94.1% |
Epoch  28 | Train: loss=0.005, acc=100.0% | time=184749.3ms |
 Valid: loss=0.240, acc= 93.9% |
 lr=1.2e-03
Epoch  29 | Train: loss=0.005, acc=100.0% | time=176280.9ms |
 Valid: loss=0.237, acc= 94.2% |
Epoch  30 | Train: loss=0.005, acc=100.0% | time=191624.7ms |
 Valid: loss=0.236, acc= 94.1% |
Epoch  31 | Train: loss=0.005, acc=100.0% | time=179145.5ms |
 Valid: loss=0.239, acc= 93.9% |
Epoch  32 | Train: loss=0.005, acc=100.0% | time=178965.5ms |
 Valid: loss=0.240, acc= 93.9% |
Epoch  33 | Train: loss=0.005, acc=100.0% | time=183482.3ms |
 Valid: loss=0.240, acc= 94.0% |
 lr=4.1e-04
Test: loss=0.198 , acc= 94.3%
Test: loss=0.198 , acc= 94.3%
Test: loss=0.198 , acc= 94.4%
Test: loss=0.198 , acc= 94.4%
Test: loss=0.198 , acc= 94.3%
Test: loss=0.199 , acc= 94.3%
Test: loss=0.198 , acc= 94.3%
Test: loss=0.198 , acc= 94.2%
Test: loss=0.198 , acc= 94.3%
Test: loss=0.198 , acc= 94.3%
Average acc= 94.3%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 5)
threshold for selecting:5872.037806914507
total ranking r = 4
the number of space for current task:4
the new increased space:0, the threshold for new space:5
Ui shape:(27, 4)
activation shape:(180, 10240)
space shape:(180, 47)
threshold for selecting:43231.16664444116
total ranking r = 39
the number of space for current task:39
the new increased space:2, the threshold for new space:47
Ui shape:(180, 39)
activation shape:(180, 10240)
space shape:(180, 83)
threshold for selecting:24313.411083794526
total ranking r = 73
the number of space for current task:73
the new increased space:4, the threshold for new space:83
Ui shape:(180, 73)
activation shape:(180, 10240)
space shape:(180, 70)
threshold for selecting:105858.09072020164
total ranking r = 64
the number of space for current task:64
the new increased space:4, the threshold for new space:70
Ui shape:(180, 64)
activation shape:(180, 10240)
space shape:(180, 98)
threshold for selecting:21127.228511271194
total ranking r = 88
the number of space for current task:88
the new increased space:3, the threshold for new space:98
Ui shape:(180, 88)
activation shape:(180, 2560)
space shape:(180, 77)
threshold for selecting:38697.7584032863
total ranking r = 71
the number of space for current task:71
the new increased space:5, the threshold for new space:77
Ui shape:(180, 71)
activation shape:(360, 2560)
space shape:(360, 222)
threshold for selecting:17747.54347343718
total ranking r = 220
the number of space for current task:220
the new increased space:24, the threshold for new space:222
Ui shape:(360, 220)
activation shape:(20, 2560)
space shape:(20, 15)
threshold for selecting:4854.42601899561
total ranking r = 15
the number of space for current task:15
the new increased space:0, the threshold for new space:15
Ui shape:(20, 15)
activation shape:(360, 2560)
space shape:(360, 225)
threshold for selecting:53197.71188416546
total ranking r = 219
the number of space for current task:219
the new increased space:21, the threshold for new space:225
Ui shape:(360, 219)
activation shape:(360, 12800)
space shape:(360, 239)
threshold for selecting:58457.70459798155
total ranking r = 219
the number of space for current task:219
the new increased space:7, the threshold for new space:239
Ui shape:(360, 219)
activation shape:(360, 3200)
space shape:(360, 218)
threshold for selecting:93076.52360218992
total ranking r = 205
the number of space for current task:205
the new increased space:17, the threshold for new space:218
Ui shape:(360, 205)
activation shape:(720, 3200)
space shape:(720, 495)
threshold for selecting:43766.20950065105
total ranking r = 506
the number of space for current task:506
the new increased space:60, the threshold for new space:495
Ui shape:(720, 506)
activation shape:(40, 3200)
space shape:(40, 32)
threshold for selecting:8960.505355193132
total ranking r = 30
the number of space for current task:30
the new increased space:0, the threshold for new space:32
Ui shape:(40, 30)
activation shape:(720, 6400)
space shape:(720, 509)
threshold for selecting:212056.9724969181
total ranking r = 504
the number of space for current task:504
the new increased space:45, the threshold for new space:509
Ui shape:(720, 504)
activation shape:(720, 6400)
space shape:(720, 527)
threshold for selecting:69300.54110802074
total ranking r = 526
the number of space for current task:526
the new increased space:45, the threshold for new space:527
Ui shape:(720, 526)
activation shape:(720, 1600)
space shape:(720, 420)
threshold for selecting:138208.42333043666
total ranking r = 469
the number of space for current task:469
the new increased space:77, the threshold for new space:420
Ui shape:(720, 469)
activation shape:(1440, 1600)
space shape:(1440, 826)
threshold for selecting:75191.62249248123
total ranking r = 1000
the number of space for current task:1000
the new increased space:189, the threshold for new space:826
Ui shape:(1440, 1000)
activation shape:(80, 1600)
space shape:(80, 63)
threshold for selecting:9852.197257008773
total ranking r = 62
the number of space for current task:62
the new increased space:4, the threshold for new space:63
Ui shape:(80, 62)
activation shape:(1440, 1600)
space shape:(1440, 933)
threshold for selecting:58147.786375917465
total ranking r = 1110
the number of space for current task:1110
the new increased space:177, the threshold for new space:933
Ui shape:(1440, 1110)
activation shape:(1440, 1600)
space shape:(1440, 906)
threshold for selecting:61240.5126601317
total ranking r = 1081
the number of space for current task:1081
the new increased space:179, the threshold for new space:906
Ui shape:(1440, 1081)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.602 , acc= 82.1%
Test: loss=0.606 , acc= 82.1%
Test: loss=0.602 , acc= 82.4%
Test: loss=0.605 , acc= 82.2%
Test: loss=0.608 , acc= 82.2%
current testing task:mnist
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
current testing task:svhn
Test: loss=0.198 , acc= 94.3%
Test: loss=0.198 , acc= 94.3%
Test: loss=0.198 , acc= 94.4%
Test: loss=0.198 , acc= 94.3%
Test: loss=0.198 , acc= 94.3%
Accuracies =
 82.5%   0.0%   0.0%   0.0%   0.0%
 82.6%  99.5%   0.0%   0.0%   0.0%
 82.2%  99.5%  94.3%   0.0%   0.0%
****************************************************************************************************
Task  3 (fashion-mnist)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 4)
Task:0, Layer:0, project_norm:0.05745528189348383, threshold for regime 1:0.02972419373691082
Task:0, layer:1, space shape:(180, 39)
Task:0, Layer:1, project_norm:0.06975622032865006, threshold for regime 1:0.03634798526763916
Task:0, layer:2, space shape:(180, 73)
Task:0, Layer:2, project_norm:0.05648981941229995, threshold for regime 1:0.02934250421822071
Task:0, layer:3, space shape:(180, 61)
Task:0, Layer:3, project_norm:0.06697736502855221, threshold for regime 1:0.03471941873431206
Task:0, layer:4, space shape:(180, 89)
Task:0, Layer:4, project_norm:0.0662661396250082, threshold for regime 1:0.03386090695858002
Task:0, layer:5, space shape:(180, 66)
Task:0, Layer:5, project_norm:0.07455947450569197, threshold for regime 1:0.03823773190379143
Task:0, layer:6, space shape:(360, 192)
Task:0, Layer:6, project_norm:0.10139952025715532, threshold for regime 1:0.05190260335803032
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.04963993308372073, threshold for regime 1:0.026497961953282356
Task:0, layer:8, space shape:(360, 196)
Task:0, Layer:8, project_norm:0.10717982485055383, threshold for regime 1:0.05449707806110382
Task:0, layer:9, space shape:(360, 220)
Task:0, Layer:9, project_norm:0.09745401463724408, threshold for regime 1:0.04935052618384361
Task:0, layer:10, space shape:(360, 191)
Task:0, Layer:10, project_norm:0.12189518365534734, threshold for regime 1:0.06226292625069618
Task:0, layer:11, space shape:(720, 422)
Task:0, Layer:11, project_norm:0.1740716525941302, threshold for regime 1:0.08976687490940094
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.0906374444875573, threshold for regime 1:0.04638056829571724
Task:0, layer:13, space shape:(720, 453)
Task:0, Layer:13, project_norm:0.15711282344400038, threshold for regime 1:0.08032026886940002
Task:0, layer:14, space shape:(720, 471)
Task:0, Layer:14, project_norm:0.1766706578591051, threshold for regime 1:0.09079702198505402
Task:0, layer:15, space shape:(720, 340)
Task:0, Layer:15, project_norm:0.2594908225918233, threshold for regime 1:0.13646405935287476
Task:0, layer:16, space shape:(1440, 613)
Task:0, Layer:16, project_norm:0.3727011024499148, threshold for regime 1:0.20385970175266266
Task:0, layer:17, space shape:(80, 58)
Task:0, Layer:17, project_norm:0.18186788316053587, threshold for regime 1:0.09406691044569016
Task:0, layer:18, space shape:(1440, 691)
Task:0, Layer:18, project_norm:0.4253675836937398, threshold for regime 1:0.23378388583660126
Task:0, layer:19, space shape:(1440, 671)
Task:0, Layer:19, project_norm:0.6270968634572375, threshold for regime 1:0.3460300862789154
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:1, layer:0, space shape:(27, 5)
Task:1, Layer:0, project_norm:0.05798248531962367, threshold for regime 1:0.02972419373691082
Task:1, layer:1, space shape:(180, 47)
Task:1, Layer:1, project_norm:0.07110136143451923, threshold for regime 1:0.03634798526763916
Task:1, layer:2, space shape:(180, 82)
Task:1, Layer:2, project_norm:0.057343744783303334, threshold for regime 1:0.02934250421822071
Task:1, layer:3, space shape:(180, 70)
Task:1, Layer:3, project_norm:0.06806523377564674, threshold for regime 1:0.03471941873431206
Task:1, layer:4, space shape:(180, 96)
Task:1, Layer:4, project_norm:0.06670650691526632, threshold for regime 1:0.03386090695858002
Task:1, layer:5, space shape:(180, 77)
Task:1, Layer:5, project_norm:0.07536230818567902, threshold for regime 1:0.03823773190379143
Task:1, layer:6, space shape:(360, 211)
Task:1, Layer:6, project_norm:0.1025061016255672, threshold for regime 1:0.05190260335803032
Task:1, layer:7, space shape:(20, 15)
Task:1, Layer:7, project_norm:0.050989688346671794, threshold for regime 1:0.026497961953282356
Task:1, layer:8, space shape:(360, 211)
Task:1, Layer:8, project_norm:0.1079298024187563, threshold for regime 1:0.05449707806110382
Task:1, layer:9, space shape:(360, 222)
Task:1, Layer:9, project_norm:0.09761273033142884, threshold for regime 1:0.04935052618384361
Task:1, layer:10, space shape:(360, 203)
Task:1, Layer:10, project_norm:0.12261896746405145, threshold for regime 1:0.06226292625069618
Task:1, layer:11, space shape:(720, 471)
Task:1, Layer:11, project_norm:0.17662898145219907, threshold for regime 1:0.08976687490940094
Task:1, layer:12, space shape:(40, 30)
Task:1, Layer:12, project_norm:0.09109829392996252, threshold for regime 1:0.04638056829571724
Task:1, layer:13, space shape:(720, 480)
Task:1, Layer:13, project_norm:0.158479527215064, threshold for regime 1:0.08032026886940002
Task:1, layer:14, space shape:(720, 496)
Task:1, Layer:14, project_norm:0.17831846452500694, threshold for regime 1:0.09079702198505402
Task:1, layer:15, space shape:(720, 405)
Task:1, Layer:15, project_norm:0.26753170909103374, threshold for regime 1:0.13646405935287476
Task:1, layer:16, space shape:(1440, 826)
Task:1, Layer:16, project_norm:0.3995750817784695, threshold for regime 1:0.20385970175266266
Task:1, layer:17, space shape:(80, 60)
Task:1, Layer:17, project_norm:0.18396736672288597, threshold for regime 1:0.09406691044569016
Task:1, layer:18, space shape:(1440, 934)
Task:1, Layer:18, project_norm:0.4586015388112455, threshold for regime 1:0.23378388583660126
Task:1, layer:19, space shape:(1440, 907)
Task:1, Layer:19, project_norm:0.6786720697335972, threshold for regime 1:0.3460300862789154
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:2, layer:0, space shape:(27, 4)
Task:2, Layer:0, project_norm:0.05745528189348383, threshold for regime 1:0.02972419373691082
Task:2, layer:1, space shape:(180, 39)
Task:2, Layer:1, project_norm:0.06977604294011397, threshold for regime 1:0.03634798526763916
Task:2, layer:2, space shape:(180, 73)
Task:2, Layer:2, project_norm:0.056374079882068356, threshold for regime 1:0.02934250421822071
Task:2, layer:3, space shape:(180, 64)
Task:2, Layer:3, project_norm:0.0672813415819535, threshold for regime 1:0.03471941873431206
Task:2, layer:4, space shape:(180, 88)
Task:2, Layer:4, project_norm:0.06614904786260721, threshold for regime 1:0.03386090695858002
Task:2, layer:5, space shape:(180, 71)
Task:2, Layer:5, project_norm:0.07470338902772466, threshold for regime 1:0.03823773190379143
Task:2, layer:6, space shape:(360, 220)
Task:2, Layer:6, project_norm:0.10217772767910865, threshold for regime 1:0.05190260335803032
Task:2, layer:7, space shape:(20, 15)
Task:2, Layer:7, project_norm:0.05049051202577551, threshold for regime 1:0.026497961953282356
Task:2, layer:8, space shape:(360, 219)
Task:2, Layer:8, project_norm:0.10759854235983629, threshold for regime 1:0.05449707806110382
Task:2, layer:9, space shape:(360, 219)
Task:2, Layer:9, project_norm:0.09736518185521721, threshold for regime 1:0.04935052618384361
Task:2, layer:10, space shape:(360, 205)
Task:2, Layer:10, project_norm:0.12217038840736599, threshold for regime 1:0.06226292625069618
Task:2, layer:11, space shape:(720, 506)
Task:2, Layer:11, project_norm:0.17626171141272998, threshold for regime 1:0.08976687490940094
Task:2, layer:12, space shape:(40, 30)
Task:2, Layer:12, project_norm:0.09083689027240566, threshold for regime 1:0.04638056829571724
Task:2, layer:13, space shape:(720, 504)
Task:2, Layer:13, project_norm:0.15802832649885598, threshold for regime 1:0.08032026886940002
Task:2, layer:14, space shape:(720, 526)
Task:2, Layer:14, project_norm:0.17810405723387365, threshold for regime 1:0.09079702198505402
Task:2, layer:15, space shape:(720, 469)
Task:2, Layer:15, project_norm:0.26795969681884474, threshold for regime 1:0.13646405935287476
Task:2, layer:16, space shape:(1440, 1000)
Task:2, Layer:16, project_norm:0.4018507097740971, threshold for regime 1:0.20385970175266266
Task:2, layer:17, space shape:(80, 62)
Task:2, Layer:17, project_norm:0.18340962447286352, threshold for regime 1:0.09406691044569016
Task:2, layer:18, space shape:(1440, 1110)
Task:2, Layer:18, project_norm:0.4619863084591348, threshold for regime 1:0.23378388583660126
Task:2, layer:19, space shape:(1440, 1081)
Task:2, Layer:19, project_norm:0.6833141293989374, threshold for regime 1:0.3460300862789154
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Layer:0, selected task ID:[2 1]
Layer:1, selected task ID:[2 1]
Layer:2, selected task ID:[0 1]
Layer:3, selected task ID:[2 1]
Layer:4, selected task ID:[0 1]
Layer:5, selected task ID:[2 1]
Layer:6, selected task ID:[2 1]
Layer:7, selected task ID:[2 1]
Layer:8, selected task ID:[2 1]
Layer:9, selected task ID:[0 1]
Layer:10, selected task ID:[2 1]
Layer:11, selected task ID:[2 1]
Layer:12, selected task ID:[2 1]
Layer:13, selected task ID:[2 1]
Layer:14, selected task ID:[2 1]
Layer:15, selected task ID:[1 2]
Layer:16, selected task ID:[1 2]
Layer:17, selected task ID:[2 1]
Layer:18, selected task ID:[1 2]
Layer:19, selected task ID:[1 2]
space1 is not None!
space2 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.018, acc= 99.7% | time=266059.4ms |
 Valid: loss=0.031, acc= 99.1% |
Epoch   2 | Train: loss=0.016, acc= 99.8% | time=263269.5ms |
 Valid: loss=0.035, acc= 99.0% |
Epoch   3 | Train: loss=0.007, acc= 99.9% | time=266049.8ms |
 Valid: loss=0.025, acc= 99.3% |
Epoch   4 | Train: loss=0.006, acc= 99.9% | time=252128.8ms |
 Valid: loss=0.026, acc= 99.1% |
Epoch   5 | Train: loss=0.004, acc= 99.9% | time=266357.4ms |
 Valid: loss=0.023, acc= 99.2% |
Epoch   6 | Train: loss=0.003, acc=100.0% | time=260107.8ms |
 Valid: loss=0.021, acc= 99.2% |
Epoch   7 | Train: loss=0.002, acc=100.0% | time=258394.4ms |
 Valid: loss=0.019, acc= 99.2% |
Epoch   8 | Train: loss=0.002, acc=100.0% | time=262190.1ms |
 Valid: loss=0.023, acc= 99.2% |
Epoch   9 | Train: loss=0.002, acc=100.0% | time=260633.8ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  10 | Train: loss=0.002, acc=100.0% | time=210088.5ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  11 | Train: loss=0.001, acc=100.0% | time=201418.5ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  12 | Train: loss=0.001, acc=100.0% | time=205315.8ms |
 Valid: loss=0.020, acc= 99.4% |
 lr=3.3e-02
Epoch  13 | Train: loss=0.001, acc=100.0% | time=200460.4ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  14 | Train: loss=0.001, acc=100.0% | time=203132.3ms |
 Valid: loss=0.019, acc= 99.3% |
Epoch  15 | Train: loss=0.000, acc=100.0% | time=192150.7ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  16 | Train: loss=0.000, acc=100.0% | time=196270.0ms |
 Valid: loss=0.021, acc= 99.2% |
Epoch  17 | Train: loss=0.000, acc=100.0% | time=197826.5ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  18 | Train: loss=0.000, acc=100.0% | time=207190.8ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  19 | Train: loss=0.000, acc=100.0% | time=204384.9ms |
 Valid: loss=0.021, acc= 99.3% |
 lr=1.1e-02
Epoch  20 | Train: loss=0.000, acc=100.0% | time=190348.7ms |
 Valid: loss=0.020, acc= 99.4% |
Epoch  21 | Train: loss=0.000, acc=100.0% | time=188309.5ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  22 | Train: loss=0.000, acc=100.0% | time=201924.7ms |
 Valid: loss=0.021, acc= 99.2% |
Epoch  23 | Train: loss=0.000, acc=100.0% | time=201081.0ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  24 | Train: loss=0.000, acc=100.0% | time=194237.3ms |
 Valid: loss=0.020, acc= 99.4% |
 lr=3.7e-03
Epoch  25 | Train: loss=0.000, acc=100.0% | time=202453.3ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  26 | Train: loss=0.000, acc=100.0% | time=198073.7ms |
 Valid: loss=0.020, acc= 99.3% |
Epoch  27 | Train: loss=0.000, acc=100.0% | time=197127.2ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  28 | Train: loss=0.000, acc=100.0% | time=196187.8ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  29 | Train: loss=0.000, acc=100.0% | time=196241.3ms |
 Valid: loss=0.020, acc= 99.3% |
 lr=1.2e-03
Epoch  30 | Train: loss=0.000, acc=100.0% | time=202941.0ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  31 | Train: loss=0.000, acc=100.0% | time=207417.8ms |
 Valid: loss=0.021, acc= 99.4% |
Epoch  32 | Train: loss=0.000, acc=100.0% | time=203540.6ms |
 Valid: loss=0.021, acc= 99.3% |
Epoch  33 | Train: loss=0.000, acc=100.0% | time=193750.7ms |
 Valid: loss=0.022, acc= 99.3% |
Epoch  34 | Train: loss=0.000, acc=100.0% | time=193518.2ms |
 Valid: loss=0.021, acc= 99.3% |
 lr=4.1e-04
Test: loss=0.014 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.013 , acc= 99.6%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.013 , acc= 99.6%
Average acc= 99.5%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 5)
threshold for selecting:13800.343192892033
total ranking r = 5
the number of space for current task:5
the new increased space:0, the threshold for new space:5
Ui shape:(27, 5)
activation shape:(180, 10240)
space shape:(180, 49)
threshold for selecting:51969.555760125506
total ranking r = 50
the number of space for current task:50
the new increased space:2, the threshold for new space:49
Ui shape:(180, 50)
activation shape:(180, 10240)
space shape:(180, 87)
threshold for selecting:21257.041752694327
total ranking r = 83
the number of space for current task:83
the new increased space:1, the threshold for new space:87
Ui shape:(180, 83)
activation shape:(180, 10240)
space shape:(180, 74)
threshold for selecting:94724.02429727225
total ranking r = 72
the number of space for current task:72
the new increased space:0, the threshold for new space:74
Ui shape:(180, 72)
activation shape:(180, 10240)
space shape:(180, 101)
threshold for selecting:14586.6775739309
total ranking r = 96
the number of space for current task:96
the new increased space:1, the threshold for new space:101
Ui shape:(180, 96)
activation shape:(180, 2560)
space shape:(180, 82)
threshold for selecting:38578.624829607106
total ranking r = 79
the number of space for current task:79
the new increased space:2, the threshold for new space:82
Ui shape:(180, 79)
activation shape:(360, 2560)
space shape:(360, 246)
threshold for selecting:10903.584493970135
total ranking r = 219
the number of space for current task:219
the new increased space:5, the threshold for new space:246
Ui shape:(360, 219)
activation shape:(20, 2560)
space shape:(20, 15)
threshold for selecting:4987.215204769161
total ranking r = 15
the number of space for current task:15
the new increased space:0, the threshold for new space:15
Ui shape:(20, 15)
activation shape:(360, 2560)
space shape:(360, 246)
threshold for selecting:33557.922596891425
total ranking r = 217
the number of space for current task:217
the new increased space:3, the threshold for new space:246
Ui shape:(360, 217)
activation shape:(360, 12800)
space shape:(360, 246)
threshold for selecting:49294.776971146246
total ranking r = 224
the number of space for current task:224
the new increased space:2, the threshold for new space:246
Ui shape:(360, 224)
activation shape:(360, 3200)
space shape:(360, 235)
threshold for selecting:66764.15330493104
total ranking r = 207
the number of space for current task:207
the new increased space:3, the threshold for new space:235
Ui shape:(360, 207)
activation shape:(720, 3200)
space shape:(720, 555)
threshold for selecting:25270.046922208487
total ranking r = 488
the number of space for current task:488
the new increased space:10, the threshold for new space:555
Ui shape:(720, 488)
activation shape:(40, 3200)
space shape:(40, 32)
threshold for selecting:8052.622241529244
total ranking r = 30
the number of space for current task:30
the new increased space:0, the threshold for new space:32
Ui shape:(40, 30)
activation shape:(720, 6400)
space shape:(720, 554)
threshold for selecting:136290.19564683244
total ranking r = 489
the number of space for current task:489
the new increased space:5, the threshold for new space:554
Ui shape:(720, 489)
activation shape:(720, 6400)
space shape:(720, 572)
threshold for selecting:40312.48356595797
total ranking r = 506
the number of space for current task:506
the new increased space:3, the threshold for new space:572
Ui shape:(720, 506)
activation shape:(720, 1600)
space shape:(720, 497)
threshold for selecting:70463.62282243132
total ranking r = 439
the number of space for current task:439
the new increased space:22, the threshold for new space:497
Ui shape:(720, 439)
activation shape:(1440, 1600)
space shape:(1440, 1015)
threshold for selecting:32332.345600077595
total ranking r = 966
the number of space for current task:966
the new increased space:105, the threshold for new space:1015
Ui shape:(1440, 966)
activation shape:(80, 1600)
space shape:(80, 67)
threshold for selecting:6537.981577950427
total ranking r = 61
the number of space for current task:61
the new increased space:0, the threshold for new space:67
Ui shape:(80, 61)
activation shape:(1440, 1600)
space shape:(1440, 1110)
threshold for selecting:27134.032351774997
total ranking r = 1084
the number of space for current task:1084
the new increased space:93, the threshold for new space:1110
Ui shape:(1440, 1084)
activation shape:(1440, 1600)
space shape:(1440, 1085)
threshold for selecting:24703.58397094403
total ranking r = 1045
the number of space for current task:1045
the new increased space:96, the threshold for new space:1085
Ui shape:(1440, 1045)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.609 , acc= 82.2%
Test: loss=0.609 , acc= 81.9%
Test: loss=0.601 , acc= 82.2%
Test: loss=0.607 , acc= 82.2%
Test: loss=0.605 , acc= 82.3%
current testing task:mnist
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
current testing task:svhn
Test: loss=0.198 , acc= 94.3%
Test: loss=0.198 , acc= 94.3%
Test: loss=0.198 , acc= 94.4%
Test: loss=0.198 , acc= 94.3%
Test: loss=0.198 , acc= 94.3%
current testing task:fashion-mnist
Test: loss=0.013 , acc= 99.5%
Test: loss=0.014 , acc= 99.6%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.013 , acc= 99.5%
Accuracies =
 82.5%   0.0%   0.0%   0.0%   0.0%
 82.6%  99.5%   0.0%   0.0%   0.0%
 82.2%  99.5%  94.3%   0.0%   0.0%
 82.2%  99.5%  94.3%  99.5%   0.0%
****************************************************************************************************
Task  4 (notmnist)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.1
----------------------------------------
reinit the scale for each task
Layer 1 - Projection Matrix shape: torch.Size([27, 27])
Layer 2 - Projection Matrix shape: torch.Size([180, 180])
Layer 3 - Projection Matrix shape: torch.Size([180, 180])
Layer 4 - Projection Matrix shape: torch.Size([180, 180])
Layer 5 - Projection Matrix shape: torch.Size([180, 180])
Layer 6 - Projection Matrix shape: torch.Size([180, 180])
Layer 7 - Projection Matrix shape: torch.Size([360, 360])
Layer 8 - Projection Matrix shape: torch.Size([20, 20])
Layer 9 - Projection Matrix shape: torch.Size([360, 360])
Layer 10 - Projection Matrix shape: torch.Size([360, 360])
Layer 11 - Projection Matrix shape: torch.Size([360, 360])
Layer 12 - Projection Matrix shape: torch.Size([720, 720])
Layer 13 - Projection Matrix shape: torch.Size([40, 40])
Layer 14 - Projection Matrix shape: torch.Size([720, 720])
Layer 15 - Projection Matrix shape: torch.Size([720, 720])
Layer 16 - Projection Matrix shape: torch.Size([720, 720])
Layer 17 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 18 - Projection Matrix shape: torch.Size([80, 80])
Layer 19 - Projection Matrix shape: torch.Size([1440, 1440])
Layer 20 - Projection Matrix shape: torch.Size([1440, 1440])
excute gradient projection condition
Task:0, layer:0, space shape:(27, 4)
Task:0, Layer:0, project_norm:0.07902693552995467, threshold for regime 1:0.040354397147893906
Task:0, layer:1, space shape:(180, 39)
Task:0, Layer:1, project_norm:0.07770969281770058, threshold for regime 1:0.03971272334456444
Task:0, layer:2, space shape:(180, 73)
Task:0, Layer:2, project_norm:0.061578932736497026, threshold for regime 1:0.0314020998775959
Task:0, layer:3, space shape:(180, 61)
Task:0, Layer:3, project_norm:0.0535755376761304, threshold for regime 1:0.027390237897634506
Task:0, layer:4, space shape:(180, 89)
Task:0, Layer:4, project_norm:0.05584648113106617, threshold for regime 1:0.028364289551973343
Task:0, layer:5, space shape:(180, 66)
Task:0, Layer:5, project_norm:0.07362050796712735, threshold for regime 1:0.03768620267510414
Task:0, layer:6, space shape:(360, 192)
Task:0, Layer:6, project_norm:0.09274354732496926, threshold for regime 1:0.04748938977718353
Task:0, layer:7, space shape:(20, 13)
Task:0, Layer:7, project_norm:0.05060014839982241, threshold for regime 1:0.026649486273527145
Task:0, layer:8, space shape:(360, 196)
Task:0, Layer:8, project_norm:0.09684832024854016, threshold for regime 1:0.04920404404401779
Task:0, layer:9, space shape:(360, 220)
Task:0, Layer:9, project_norm:0.10143752141725418, threshold for regime 1:0.051229655742645264
Task:0, layer:10, space shape:(360, 191)
Task:0, Layer:10, project_norm:0.140370697391301, threshold for regime 1:0.07127516716718674
Task:0, layer:11, space shape:(720, 422)
Task:0, Layer:11, project_norm:0.19590275777530208, threshold for regime 1:0.1005069836974144
Task:0, layer:12, space shape:(40, 29)
Task:0, Layer:12, project_norm:0.08981285823474348, threshold for regime 1:0.04602023959159851
Task:0, layer:13, space shape:(720, 453)
Task:0, Layer:13, project_norm:0.18659875318093433, threshold for regime 1:0.09494172781705856
Task:0, layer:14, space shape:(720, 471)
Task:0, Layer:14, project_norm:0.2177730070529072, threshold for regime 1:0.11127335578203201
Task:0, layer:15, space shape:(720, 340)
Task:0, Layer:15, project_norm:0.28241440984116234, threshold for regime 1:0.1472756564617157
Task:0, layer:16, space shape:(1440, 613)
Task:0, Layer:16, project_norm:0.4256791356186973, threshold for regime 1:0.22977334260940552
Task:0, layer:17, space shape:(80, 58)
Task:0, Layer:17, project_norm:0.22778669823176784, threshold for regime 1:0.11710350960493088
Task:0, layer:18, space shape:(1440, 691)
Task:0, Layer:18, project_norm:0.4493485941117386, threshold for regime 1:0.24460263550281525
Task:0, layer:19, space shape:(1440, 671)
Task:0, Layer:19, project_norm:0.6507535910691449, threshold for regime 1:0.3554086685180664
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:1, layer:0, space shape:(27, 5)
Task:1, Layer:0, project_norm:0.07979816996499733, threshold for regime 1:0.040354397147893906
Task:1, layer:1, space shape:(180, 47)
Task:1, Layer:1, project_norm:0.07824510343710145, threshold for regime 1:0.03971272334456444
Task:1, layer:2, space shape:(180, 82)
Task:1, Layer:2, project_norm:0.0618241985241501, threshold for regime 1:0.0314020998775959
Task:1, layer:3, space shape:(180, 70)
Task:1, Layer:3, project_norm:0.053904768827987115, threshold for regime 1:0.027390237897634506
Task:1, layer:4, space shape:(180, 96)
Task:1, Layer:4, project_norm:0.05599132674458552, threshold for regime 1:0.028364289551973343
Task:1, layer:5, space shape:(180, 77)
Task:1, Layer:5, project_norm:0.07423004099620041, threshold for regime 1:0.03768620267510414
Task:1, layer:6, space shape:(360, 211)
Task:1, Layer:6, project_norm:0.09314467370950531, threshold for regime 1:0.04748938977718353
Task:1, layer:7, space shape:(20, 15)
Task:1, Layer:7, project_norm:0.05155116638975748, threshold for regime 1:0.026649486273527145
Task:1, layer:8, space shape:(360, 211)
Task:1, Layer:8, project_norm:0.09710503427838323, threshold for regime 1:0.04920404404401779
Task:1, layer:9, space shape:(360, 222)
Task:1, Layer:9, project_norm:0.10142790400673844, threshold for regime 1:0.051229655742645264
Task:1, layer:10, space shape:(360, 203)
Task:1, Layer:10, project_norm:0.14062966983201752, threshold for regime 1:0.07127516716718674
Task:1, layer:11, space shape:(720, 471)
Task:1, Layer:11, project_norm:0.1970245216975577, threshold for regime 1:0.1005069836974144
Task:1, layer:12, space shape:(40, 30)
Task:1, Layer:12, project_norm:0.0896785588505586, threshold for regime 1:0.04602023959159851
Task:1, layer:13, space shape:(720, 480)
Task:1, Layer:13, project_norm:0.18699068751487113, threshold for regime 1:0.09494172781705856
Task:1, layer:14, space shape:(720, 496)
Task:1, Layer:14, project_norm:0.21821123278904622, threshold for regime 1:0.11127335578203201
Task:1, layer:15, space shape:(720, 405)
Task:1, Layer:15, project_norm:0.2853949440156935, threshold for regime 1:0.1472756564617157
Task:1, layer:16, space shape:(1440, 826)
Task:1, Layer:16, project_norm:0.43778088781496227, threshold for regime 1:0.22977334260940552
Task:1, layer:17, space shape:(80, 60)
Task:1, Layer:17, project_norm:0.2284365103193107, threshold for regime 1:0.11710350960493088
Task:1, layer:18, space shape:(1440, 934)
Task:1, Layer:18, project_norm:0.4664172425044136, threshold for regime 1:0.24460263550281525
Task:1, layer:19, space shape:(1440, 907)
Task:1, Layer:19, project_norm:0.6758078966856376, threshold for regime 1:0.3554086685180664
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:2, layer:0, space shape:(27, 4)
Task:2, Layer:0, project_norm:0.07902693552995467, threshold for regime 1:0.040354397147893906
Task:2, layer:1, space shape:(180, 39)
Task:2, Layer:1, project_norm:0.0775223734267314, threshold for regime 1:0.03971272334456444
Task:2, layer:2, space shape:(180, 73)
Task:2, Layer:2, project_norm:0.06163883911400948, threshold for regime 1:0.0314020998775959
Task:2, layer:3, space shape:(180, 64)
Task:2, Layer:3, project_norm:0.05369803690375608, threshold for regime 1:0.027390237897634506
Task:2, layer:4, space shape:(180, 88)
Task:2, Layer:4, project_norm:0.05581586685728028, threshold for regime 1:0.028364289551973343
Task:2, layer:5, space shape:(180, 71)
Task:2, Layer:5, project_norm:0.07386542572715964, threshold for regime 1:0.03768620267510414
Task:2, layer:6, space shape:(360, 220)
Task:2, Layer:6, project_norm:0.09348775743728087, threshold for regime 1:0.04748938977718353
Task:2, layer:7, space shape:(20, 15)
Task:2, Layer:7, project_norm:0.051340606645706485, threshold for regime 1:0.026649486273527145
Task:2, layer:8, space shape:(360, 219)
Task:2, Layer:8, project_norm:0.09728130789646745, threshold for regime 1:0.04920404404401779
Task:2, layer:9, space shape:(360, 219)
Task:2, Layer:9, project_norm:0.10141935283247469, threshold for regime 1:0.051229655742645264
Task:2, layer:10, space shape:(360, 205)
Task:2, Layer:10, project_norm:0.14072278710640374, threshold for regime 1:0.07127516716718674
Task:2, layer:11, space shape:(720, 506)
Task:2, Layer:11, project_norm:0.1978155881341609, threshold for regime 1:0.1005069836974144
Task:2, layer:12, space shape:(40, 30)
Task:2, Layer:12, project_norm:0.0900033174204352, threshold for regime 1:0.04602023959159851
Task:2, layer:13, space shape:(720, 504)
Task:2, Layer:13, project_norm:0.1874873280357269, threshold for regime 1:0.09494172781705856
Task:2, layer:14, space shape:(720, 526)
Task:2, Layer:14, project_norm:0.21918193053871424, threshold for regime 1:0.11127335578203201
Task:2, layer:15, space shape:(720, 469)
Task:2, Layer:15, project_norm:0.28813755150379694, threshold for regime 1:0.1472756564617157
Task:2, layer:16, space shape:(1440, 1000)
Task:2, Layer:16, project_norm:0.4462570094414008, threshold for regime 1:0.22977334260940552
Task:2, layer:17, space shape:(80, 62)
Task:2, Layer:17, project_norm:0.22916019109385846, threshold for regime 1:0.11710350960493088
Task:2, layer:18, space shape:(1440, 1110)
Task:2, Layer:18, project_norm:0.47644216307066, threshold for regime 1:0.24460263550281525
Task:2, layer:19, space shape:(1440, 1081)
Task:2, Layer:19, project_norm:0.6914690909958205, threshold for regime 1:0.3554086685180664
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Task:3, layer:0, space shape:(27, 5)
Task:3, Layer:0, project_norm:0.07979760498655973, threshold for regime 1:0.040354397147893906
Task:3, layer:1, space shape:(180, 50)
Task:3, Layer:1, project_norm:0.07843988647104723, threshold for regime 1:0.03971272334456444
Task:3, layer:2, space shape:(180, 83)
Task:3, Layer:2, project_norm:0.06186521515728542, threshold for regime 1:0.0314020998775959
Task:3, layer:3, space shape:(180, 72)
Task:3, Layer:3, project_norm:0.05395233451495327, threshold for regime 1:0.027390237897634506
Task:3, layer:4, space shape:(180, 96)
Task:3, Layer:4, project_norm:0.05596548628824738, threshold for regime 1:0.028364289551973343
Task:3, layer:5, space shape:(180, 79)
Task:3, Layer:5, project_norm:0.07427532758162136, threshold for regime 1:0.03768620267510414
Task:3, layer:6, space shape:(360, 219)
Task:3, Layer:6, project_norm:0.09330124666761602, threshold for regime 1:0.04748938977718353
Task:3, layer:7, space shape:(20, 15)
Task:3, Layer:7, project_norm:0.051569556351053425, threshold for regime 1:0.026649486273527145
Task:3, layer:8, space shape:(360, 217)
Task:3, Layer:8, project_norm:0.09721714584933092, threshold for regime 1:0.04920404404401779
Task:3, layer:9, space shape:(360, 224)
Task:3, Layer:9, project_norm:0.10145281302098844, threshold for regime 1:0.051229655742645264
Task:3, layer:10, space shape:(360, 207)
Task:3, Layer:10, project_norm:0.14068883133421473, threshold for regime 1:0.07127516716718674
Task:3, layer:11, space shape:(720, 488)
Task:3, Layer:11, project_norm:0.19732707233380223, threshold for regime 1:0.1005069836974144
Task:3, layer:12, space shape:(40, 30)
Task:3, Layer:12, project_norm:0.08967358100428333, threshold for regime 1:0.04602023959159851
Task:3, layer:13, space shape:(720, 489)
Task:3, Layer:13, project_norm:0.18710282164143124, threshold for regime 1:0.09494172781705856
Task:3, layer:14, space shape:(720, 506)
Task:3, Layer:14, project_norm:0.21856494440891122, threshold for regime 1:0.11127335578203201
Task:3, layer:15, space shape:(720, 439)
Task:3, Layer:15, project_norm:0.28672246562616804, threshold for regime 1:0.1472756564617157
Task:3, layer:16, space shape:(1440, 966)
Task:3, Layer:16, project_norm:0.4437917929937174, threshold for regime 1:0.22977334260940552
Task:3, layer:17, space shape:(80, 61)
Task:3, Layer:17, project_norm:0.22881570601914628, threshold for regime 1:0.11710350960493088
Task:3, layer:18, space shape:(1440, 1084)
Task:3, Layer:18, project_norm:0.47418789341851797, threshold for regime 1:0.24460263550281525
Task:3, layer:19, space shape:(1440, 1045)
Task:3, Layer:19, project_norm:0.6863454584843304, threshold for regime 1:0.3554086685180664
Layer:0, Regime:2
Layer:1, Regime:2
Layer:2, Regime:2
Layer:3, Regime:2
Layer:4, Regime:2
Layer:5, Regime:2
Layer:6, Regime:2
Layer:7, Regime:2
Layer:8, Regime:2
Layer:9, Regime:2
Layer:10, Regime:2
Layer:11, Regime:2
Layer:12, Regime:2
Layer:13, Regime:2
Layer:14, Regime:2
Layer:15, Regime:2
Layer:16, Regime:2
Layer:17, Regime:2
Layer:18, Regime:2
Layer:19, Regime:2
Layer:0, selected task ID:[3 1]
Layer:1, selected task ID:[1 3]
Layer:2, selected task ID:[1 3]
Layer:3, selected task ID:[1 3]
Layer:4, selected task ID:[3 1]
Layer:5, selected task ID:[1 3]
Layer:6, selected task ID:[3 2]
Layer:7, selected task ID:[1 3]
Layer:8, selected task ID:[3 2]
Layer:9, selected task ID:[0 3]
Layer:10, selected task ID:[3 2]
Layer:11, selected task ID:[3 2]
Layer:12, selected task ID:[0 2]
Layer:13, selected task ID:[3 2]
Layer:14, selected task ID:[3 2]
Layer:15, selected task ID:[3 2]
Layer:16, selected task ID:[3 2]
Layer:17, selected task ID:[3 2]
Layer:18, selected task ID:[3 2]
Layer:19, selected task ID:[3 2]
space1 is not None!
space2 is not None!
----------------------------------------
Epoch   1 | Train: loss=0.172, acc= 95.0% | time=61730.3ms |
 Valid: loss=0.205, acc= 93.3% |
Epoch   2 | Train: loss=0.281, acc= 88.7% | time=56596.1ms |
 Valid: loss=0.345, acc= 86.5% |
Epoch   3 | Train: loss=0.260, acc= 88.9% | time=58123.6ms |
 Valid: loss=0.318, acc= 86.6% |
Epoch   4 | Train: loss=0.131, acc= 96.1% | time=56266.6ms |
 Valid: loss=0.194, acc= 94.2% |
Epoch   5 | Train: loss=0.093, acc= 97.1% | time=56833.6ms |
 Valid: loss=0.178, acc= 93.1% |
Epoch   6 | Train: loss=0.053, acc= 98.7% | time=58326.2ms |
 Valid: loss=0.141, acc= 96.0% |
Epoch   7 | Train: loss=0.026, acc= 99.6% | time=55550.0ms |
 Valid: loss=0.115, acc= 96.7% |
Epoch   8 | Train: loss=0.214, acc= 93.5% | time=56089.2ms |
 Valid: loss=0.295, acc= 91.3% |
Epoch   9 | Train: loss=0.015, acc= 99.8% | time=56502.9ms |
 Valid: loss=0.115, acc= 96.2% |
Epoch  10 | Train: loss=0.047, acc= 98.7% | time=55443.7ms |
 Valid: loss=0.174, acc= 95.1% |
Epoch  11 | Train: loss=0.034, acc= 98.9% | time=54875.5ms |
 Valid: loss=0.143, acc= 96.1% |
Epoch  12 | Train: loss=0.009, acc= 99.9% | time=56005.6ms |
 Valid: loss=0.131, acc= 95.7% |
Epoch  13 | Train: loss=0.008, acc= 99.9% | time=53229.3ms |
 Valid: loss=0.148, acc= 96.3% |
Epoch  14 | Train: loss=0.017, acc= 99.5% | time=53461.4ms |
 Valid: loss=0.159, acc= 95.5% |
 lr=3.3e-02
Epoch  15 | Train: loss=0.005, acc= 99.9% | time=55676.9ms |
 Valid: loss=0.127, acc= 96.3% |
Epoch  16 | Train: loss=0.005, acc= 99.9% | time=55500.5ms |
 Valid: loss=0.128, acc= 96.3% |
Epoch  17 | Train: loss=0.004, acc= 99.9% | time=59546.4ms |
 Valid: loss=0.129, acc= 96.4% |
Epoch  18 | Train: loss=0.004, acc= 99.9% | time=55315.6ms |
 Valid: loss=0.128, acc= 96.6% |
Epoch  19 | Train: loss=0.004, acc= 99.9% | time=57840.8ms |
 Valid: loss=0.128, acc= 96.2% |
 lr=1.1e-02
Epoch  20 | Train: loss=0.004, acc= 99.9% | time=54072.2ms |
 Valid: loss=0.129, acc= 96.6% |
Epoch  21 | Train: loss=0.004, acc= 99.9% | time=58549.1ms |
 Valid: loss=0.130, acc= 96.6% |
Epoch  22 | Train: loss=0.004, acc= 99.9% | time=54650.2ms |
 Valid: loss=0.125, acc= 96.6% |
Epoch  23 | Train: loss=0.004, acc= 99.9% | time=55161.0ms |
 Valid: loss=0.128, acc= 96.7% |
Epoch  24 | Train: loss=0.004, acc= 99.9% | time=57892.3ms |
 Valid: loss=0.133, acc= 96.4% |
 lr=3.7e-03
Epoch  25 | Train: loss=0.004, acc= 99.9% | time=59942.1ms |
 Valid: loss=0.132, acc= 96.6% |
Epoch  26 | Train: loss=0.004, acc= 99.9% | time=58664.1ms |
 Valid: loss=0.133, acc= 96.3% |
Epoch  27 | Train: loss=0.004, acc= 99.9% | time=60917.5ms |
 Valid: loss=0.133, acc= 96.4% |
Epoch  28 | Train: loss=0.004, acc= 99.9% | time=58171.9ms |
 Valid: loss=0.129, acc= 96.4% |
Epoch  29 | Train: loss=0.003, acc= 99.9% | time=54876.6ms |
 Valid: loss=0.134, acc= 96.6% |
 lr=1.2e-03
Epoch  30 | Train: loss=0.003, acc= 99.9% | time=56223.0ms |
 Valid: loss=0.127, acc= 96.8% |
Epoch  31 | Train: loss=0.003, acc= 99.9% | time=57757.4ms |
 Valid: loss=0.129, acc= 96.6% |
Epoch  32 | Train: loss=0.003, acc= 99.9% | time=56112.1ms |
 Valid: loss=0.131, acc= 96.6% |
Epoch  33 | Train: loss=0.003, acc= 99.9% | time=54310.7ms |
 Valid: loss=0.129, acc= 96.4% |
Epoch  34 | Train: loss=0.003, acc= 99.9% | time=54075.1ms |
 Valid: loss=0.130, acc= 96.6% |
 lr=4.1e-04
Test: loss=0.137 , acc= 95.9%
Test: loss=0.137 , acc= 95.7%
Test: loss=0.136 , acc= 96.2%
Test: loss=0.136 , acc= 95.7%
Test: loss=0.135 , acc= 95.8%
Test: loss=0.136 , acc= 96.0%
Test: loss=0.136 , acc= 95.9%
Test: loss=0.135 , acc= 95.9%
Test: loss=0.137 , acc= 96.0%
Test: loss=0.134 , acc= 95.8%
Average acc= 95.9%
Threshold:[0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96 0.96
 0.96 0.96 0.96 0.96 0.96 0.96]
activation shape:(27, 10240)
space shape:(27, 5)
threshold for selecting:6952.3863497928505
total ranking r = 3
the number of space for current task:3
the new increased space:0, the threshold for new space:5
Ui shape:(27, 3)
activation shape:(180, 10240)
space shape:(180, 51)
threshold for selecting:33275.4815602152
total ranking r = 40
the number of space for current task:40
the new increased space:0, the threshold for new space:51
Ui shape:(180, 40)
activation shape:(180, 10240)
space shape:(180, 88)
threshold for selecting:19939.23054719483
total ranking r = 73
the number of space for current task:73
the new increased space:2, the threshold for new space:88
Ui shape:(180, 73)
activation shape:(180, 10240)
space shape:(180, 74)
threshold for selecting:85618.64474689368
total ranking r = 62
the number of space for current task:62
the new increased space:1, the threshold for new space:74
Ui shape:(180, 62)
activation shape:(180, 10240)
space shape:(180, 102)
threshold for selecting:16677.885896695694
total ranking r = 86
the number of space for current task:86
the new increased space:2, the threshold for new space:102
Ui shape:(180, 86)
activation shape:(180, 2560)
space shape:(180, 84)
threshold for selecting:32211.33224105118
total ranking r = 68
the number of space for current task:68
the new increased space:2, the threshold for new space:84
Ui shape:(180, 68)
activation shape:(360, 2560)
space shape:(360, 251)
threshold for selecting:10005.505520926588
total ranking r = 209
the number of space for current task:209
the new increased space:5, the threshold for new space:251
Ui shape:(360, 209)
activation shape:(20, 2560)
space shape:(20, 15)
threshold for selecting:5046.0906729974195
total ranking r = 15
the number of space for current task:15
the new increased space:0, the threshold for new space:15
Ui shape:(20, 15)
activation shape:(360, 2560)
space shape:(360, 249)
threshold for selecting:32318.333108730232
total ranking r = 212
the number of space for current task:212
the new increased space:6, the threshold for new space:249
Ui shape:(360, 212)
activation shape:(360, 12800)
space shape:(360, 248)
threshold for selecting:45450.21571555106
total ranking r = 211
the number of space for current task:211
the new increased space:6, the threshold for new space:248
Ui shape:(360, 211)
activation shape:(360, 3200)
space shape:(360, 238)
threshold for selecting:60972.001817465214
total ranking r = 194
the number of space for current task:194
the new increased space:7, the threshold for new space:238
Ui shape:(360, 194)
activation shape:(720, 3200)
space shape:(720, 565)
threshold for selecting:22563.53853357503
total ranking r = 500
the number of space for current task:500
the new increased space:24, the threshold for new space:565
Ui shape:(720, 500)
activation shape:(40, 3200)
space shape:(40, 32)
threshold for selecting:8306.207777607746
total ranking r = 29
the number of space for current task:29
the new increased space:0, the threshold for new space:32
Ui shape:(40, 29)
activation shape:(720, 6400)
space shape:(720, 559)
threshold for selecting:134424.12517438026
total ranking r = 492
the number of space for current task:492
the new increased space:22, the threshold for new space:559
Ui shape:(720, 492)
activation shape:(720, 6400)
space shape:(720, 575)
threshold for selecting:44465.8418162597
total ranking r = 522
the number of space for current task:522
the new increased space:21, the threshold for new space:575
Ui shape:(720, 522)
activation shape:(720, 1600)
space shape:(720, 519)
threshold for selecting:76002.17658917198
total ranking r = 485
the number of space for current task:485
the new increased space:37, the threshold for new space:519
Ui shape:(720, 485)
activation shape:(1440, 1600)
space shape:(1440, 1120)
threshold for selecting:31998.342114596155
total ranking r = 1098
the number of space for current task:1098
the new increased space:89, the threshold for new space:1120
Ui shape:(1440, 1098)
activation shape:(80, 1600)
space shape:(80, 67)
threshold for selecting:7502.877285133525
total ranking r = 62
the number of space for current task:62
the new increased space:1, the threshold for new space:67
Ui shape:(80, 62)
activation shape:(1440, 1600)
space shape:(1440, 1203)
threshold for selecting:34144.46813411056
total ranking r = 1184
the number of space for current task:1184
the new increased space:69, the threshold for new space:1203
Ui shape:(1440, 1184)
activation shape:(1440, 1600)
space shape:(1440, 1181)
threshold for selecting:25901.573248153996
total ranking r = 1164
the number of space for current task:1164
the new increased space:79, the threshold for new space:1181
Ui shape:(1440, 1164)
----------------------------------------
Gradient Constraints Summary
----------------------------------------
----------------------------------------
current testing task:cifar10
Test: loss=0.604 , acc= 82.0%
Test: loss=0.606 , acc= 82.2%
Test: loss=0.603 , acc= 82.3%
Test: loss=0.604 , acc= 82.2%
Test: loss=0.602 , acc= 82.2%
current testing task:mnist
Test: loss=0.015 , acc= 99.4%
Test: loss=0.015 , acc= 99.5%
Test: loss=0.015 , acc= 99.4%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.014 , acc= 99.5%
current testing task:svhn
Test: loss=0.198 , acc= 94.4%
Test: loss=0.198 , acc= 94.3%
Test: loss=0.198 , acc= 94.4%
Test: loss=0.198 , acc= 94.3%
Test: loss=0.199 , acc= 94.3%
current testing task:fashion-mnist
Test: loss=0.013 , acc= 99.5%
Test: loss=0.014 , acc= 99.6%
Test: loss=0.014 , acc= 99.6%
Test: loss=0.014 , acc= 99.5%
Test: loss=0.013 , acc= 99.5%
current testing task:notmnist
Test: loss=0.137 , acc= 96.0%
Test: loss=0.137 , acc= 96.0%
Test: loss=0.136 , acc= 96.0%
Test: loss=0.137 , acc= 95.7%
Test: loss=0.137 , acc= 95.9%
Accuracies =
 82.5%   0.0%   0.0%   0.0%   0.0%
 82.6%  99.5%   0.0%   0.0%   0.0%
 82.2%  99.5%  94.3%   0.0%   0.0%
 82.2%  99.5%  94.3%  99.5%   0.0%
 82.2%  99.5%  94.3%  99.5%  95.9%
--------------------------------------------------
Task Order : [0 1 2 3 4]
Final Avg Accuracy: 94.30%
Backward transfer: -0.06%
[Elapsed time = 27494558.9 ms]
--------------------------------------------------
Accuracy: [94.25323176652925, 94.14215802723068, 94.29653727478538]
Backward transfer: [-0.07637799631222819, -0.1213017824216358, -0.06446650276583199]
Final Avg Accuracy: 94.23%, std: 0.07
Final Avg Backward transfer: -0.09%, std: 0.02
